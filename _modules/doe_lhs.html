
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>doe_lhs &#8212; Squid 0.0.1 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Squid 0.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for doe_lhs</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The doe_lhs module contains code for generating random samples via the latin</span>
<span class="sd">hypercube sampling method.  The below code was developed by scilab and </span>
<span class="sd">Abraham Lee.</span>

<span class="sd">-----------</span>

<span class="sd">This code was originally published by the following individuals for use with</span>
<span class="sd">Scilab:</span>

<span class="sd">	- Copyright (C) 2012 - 2013 - Michael Baudin</span>
<span class="sd">	- Copyright (C) 2012 - Maria Christopoulou</span>
<span class="sd">	- Copyright (C) 2010 - 2011 - INRIA - Michael Baudin</span>
<span class="sd">	- Copyright (C) 2009 - Yann Collette</span>
<span class="sd">	- Copyright (C) 2009 - CEA - Jean-Marc Martinez</span>
<span class="sd">	</span>
<span class="sd">	website: forge.scilab.org/index.php/p/scidoe/sourcetree/master/macros</span>

<span class="sd">Much thanks goes to these individuals. It has been converted to Python by </span>
<span class="sd">Abraham Lee.</span>

<span class="sd">----------</span>

<span class="sd">- :func:`lhs`</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">factorial</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lhs&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="lhs"><a class="viewcode-back" href="../codebase.html#doe_lhs.lhs">[docs]</a><span class="k">def</span> <span class="nf">lhs</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generate a latin-hypercube design</span>
<span class="sd">	</span>
<span class="sd">	**Parameters**</span>

<span class="sd">		n: *int*</span>
<span class="sd">			The number of factors to generate samples for</span>
<span class="sd">		samples: *int, optional*</span>
<span class="sd">			The number of samples to generate for each factor (Default: n)</span>
<span class="sd">		criterion: *str, optional*</span>
<span class="sd">			Allowable values are &quot;center&quot; or &quot;c&quot;, &quot;maximin&quot; or &quot;m&quot;, </span>
<span class="sd">			&quot;centermaximin&quot; or &quot;cm&quot;, and &quot;correlation&quot; or &quot;corr&quot;. If no value </span>
<span class="sd">			given, the design is simply randomized.</span>
<span class="sd">		iterations: *int, optional*</span>
<span class="sd">			The number of iterations in the maximin and correlations algorithms</span>
<span class="sd">			(Default: 5).</span>
<span class="sd">	</span>
<span class="sd">	**Returns**</span>

<span class="sd">		H: *2d-array*</span>
<span class="sd">			An n-by-samples design matrix that has been normalized so factor values</span>
<span class="sd">			are uniformly spaced between zero and one.</span>
<span class="sd">	</span>
<span class="sd">	**Example**</span>

<span class="sd">		A 3-factor design (defaults to 3 samples)::</span>
<span class="sd">		</span>
<span class="sd">			&gt;&gt;&gt; lhs(3)</span>
<span class="sd">			array([[ 0.40069325,  0.08118402,  0.69763298],</span>
<span class="sd">				   [ 0.19524568,  0.41383587,  0.29947106],</span>
<span class="sd">				   [ 0.85341601,  0.75460699,  0.360024  ]])</span>
<span class="sd">		   </span>
<span class="sd">		A 4-factor design with 6 samples::</span>
<span class="sd">		</span>
<span class="sd">			&gt;&gt;&gt; lhs(4, samples=6)</span>
<span class="sd">			array([[ 0.27226812,  0.02811327,  0.62792445,  0.91988196],</span>
<span class="sd">				   [ 0.76945538,  0.43501682,  0.01107457,  0.09583358],</span>
<span class="sd">				   [ 0.45702981,  0.76073773,  0.90245401,  0.18773015],</span>
<span class="sd">				   [ 0.99342115,  0.85814198,  0.16996665,  0.65069309],</span>
<span class="sd">				   [ 0.63092013,  0.22148567,  0.33616859,  0.36332478],</span>
<span class="sd">				   [ 0.05276917,  0.5819198 ,  0.67194243,  0.78703262]])</span>
<span class="sd">		   </span>
<span class="sd">		A 2-factor design with 5 centered samples::</span>
<span class="sd">		</span>
<span class="sd">			&gt;&gt;&gt; lhs(2, samples=5, criterion=&#39;center&#39;)</span>
<span class="sd">			array([[ 0.3,  0.5],</span>
<span class="sd">				   [ 0.7,  0.9],</span>
<span class="sd">				   [ 0.1,  0.3],</span>
<span class="sd">				   [ 0.9,  0.1],</span>
<span class="sd">				   [ 0.5,  0.7]])</span>
<span class="sd">		   </span>
<span class="sd">		A 3-factor design with 4 samples where the minimum distance between</span>
<span class="sd">		all samples has been maximized::</span>
<span class="sd">		</span>
<span class="sd">			&gt;&gt;&gt; lhs(3, samples=4, criterion=&#39;maximin&#39;)</span>
<span class="sd">			array([[ 0.02642564,  0.55576963,  0.50261649],</span>
<span class="sd">				   [ 0.51606589,  0.88933259,  0.34040838],</span>
<span class="sd">				   [ 0.98431735,  0.0380364 ,  0.01621717],</span>
<span class="sd">				   [ 0.40414671,  0.33339132,  0.84845707]])</span>
<span class="sd">		   </span>
<span class="sd">		A 4-factor design with 5 samples where the samples are as uncorrelated</span>
<span class="sd">		as possible (within 10 iterations)::</span>
<span class="sd">		</span>
<span class="sd">			&gt;&gt;&gt; lhs(4, samples=5, criterion=&#39;correlate&#39;, iterations=10)</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">H</span> <span class="o">=</span> <span class="kc">None</span>
	
	<span class="k">if</span> <span class="n">samples</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">samples</span> <span class="o">=</span> <span class="n">n</span>
	
	<span class="k">if</span> <span class="n">criterion</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
		<span class="k">assert</span> <span class="n">criterion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;maximin&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> 
			<span class="s1">&#39;centermaximin&#39;</span><span class="p">,</span> <span class="s1">&#39;cm&#39;</span><span class="p">,</span> <span class="s1">&#39;correlation&#39;</span><span class="p">,</span> 
			<span class="s1">&#39;corr&#39;</span><span class="p">),</span> <span class="s1">&#39;Invalid value for &quot;criterion&quot;: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">criterion</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">H</span> <span class="o">=</span> <span class="n">_lhsclassic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">samples</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">criterion</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">criterion</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
	
	<span class="k">if</span> <span class="n">iterations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">iterations</span> <span class="o">=</span> <span class="mi">5</span>
		
	<span class="k">if</span> <span class="n">H</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">criterion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">):</span>
			<span class="n">H</span> <span class="o">=</span> <span class="n">_lhscentered</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">samples</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">criterion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;maximin&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">):</span>
			<span class="n">H</span> <span class="o">=</span> <span class="n">_lhsmaximin</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="s1">&#39;maximin&#39;</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">criterion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;centermaximin&#39;</span><span class="p">,</span> <span class="s1">&#39;cm&#39;</span><span class="p">):</span>
			<span class="n">H</span> <span class="o">=</span> <span class="n">_lhsmaximin</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="s1">&#39;centermaximin&#39;</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">criterion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;correlate&#39;</span><span class="p">,</span> <span class="s1">&#39;corr&#39;</span><span class="p">):</span>
			<span class="n">H</span> <span class="o">=</span> <span class="n">_lhscorrelate</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="n">iterations</span><span class="p">)</span>
	
	<span class="k">return</span> <span class="n">H</span></div>

<span class="c1">################################################################################</span>

<span class="k">def</span> <span class="nf">_lhsclassic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">samples</span><span class="p">):</span>
	<span class="c1"># Generate the intervals</span>
	<span class="n">cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">samples</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>    
	
	<span class="c1"># Fill points uniformly in each interval</span>
	<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
	<span class="n">a</span> <span class="o">=</span> <span class="n">cut</span><span class="p">[:</span><span class="n">samples</span><span class="p">]</span>
	<span class="n">b</span> <span class="o">=</span> <span class="n">cut</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">samples</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
	<span class="n">rdpoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
		<span class="n">rdpoints</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span>
	
	<span class="c1"># Make the random pairings</span>
	<span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">rdpoints</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
		<span class="n">order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">samples</span><span class="p">))</span>
		<span class="n">H</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">rdpoints</span><span class="p">[</span><span class="n">order</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
	
	<span class="k">return</span> <span class="n">H</span>
	
<span class="c1">################################################################################</span>

<span class="k">def</span> <span class="nf">_lhscentered</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">samples</span><span class="p">):</span>
	<span class="c1"># Generate the intervals</span>
	<span class="n">cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">samples</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>    
	
	<span class="c1"># Fill points uniformly in each interval</span>
	<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
	<span class="n">a</span> <span class="o">=</span> <span class="n">cut</span><span class="p">[:</span><span class="n">samples</span><span class="p">]</span>
	<span class="n">b</span> <span class="o">=</span> <span class="n">cut</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">samples</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
	<span class="n">_center</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
	
	<span class="c1"># Make the random pairings</span>
	<span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
		<span class="n">H</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">_center</span><span class="p">)</span>
	
	<span class="k">return</span> <span class="n">H</span>
	
<span class="c1">################################################################################</span>

<span class="k">def</span> <span class="nf">_lhsmaximin</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="n">lhstype</span><span class="p">):</span>
	<span class="n">maxdist</span> <span class="o">=</span> <span class="mi">0</span>
	
	<span class="c1"># Maximize the minimum distance between points</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">lhstype</span><span class="o">==</span><span class="s1">&#39;maximin&#39;</span><span class="p">:</span>
			<span class="n">Hcandidate</span> <span class="o">=</span> <span class="n">_lhsclassic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">samples</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">Hcandidate</span> <span class="o">=</span> <span class="n">_lhscentered</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">samples</span><span class="p">)</span>
		
		<span class="n">d</span> <span class="o">=</span> <span class="n">_pdist</span><span class="p">(</span><span class="n">Hcandidate</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">maxdist</span><span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
			<span class="n">maxdist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
			<span class="n">H</span> <span class="o">=</span> <span class="n">Hcandidate</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
	
	<span class="k">return</span> <span class="n">H</span>

<span class="c1">################################################################################</span>

<span class="k">def</span> <span class="nf">_lhscorrelate</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="n">iterations</span><span class="p">):</span>
	<span class="n">mincorr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
	
	<span class="c1"># Minimize the components correlation coefficients</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
		<span class="c1"># Generate a random LHS</span>
		<span class="n">Hcandidate</span> <span class="o">=</span> <span class="n">_lhsclassic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">samples</span><span class="p">)</span>
		<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">Hcandidate</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">R</span><span class="o">!=</span><span class="mi">1</span><span class="p">]))</span><span class="o">&lt;</span><span class="n">mincorr</span><span class="p">:</span>
			<span class="n">mincorr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">R</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
			<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;new candidate solution found with max,abs corrcoef = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mincorr</span><span class="p">))</span>
			<span class="n">H</span> <span class="o">=</span> <span class="n">Hcandidate</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
	
	<span class="k">return</span> <span class="n">H</span>
	
<span class="c1">################################################################################</span>

<span class="k">def</span> <span class="nf">_pdist</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculate the pair-wise point distances of a matrix</span>
<span class="sd">	</span>
<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	x : 2d-array</span>
<span class="sd">		An m-by-n array of scalars, where there are m points in n dimensions.</span>
<span class="sd">	</span>
<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	d : array</span>
<span class="sd">		A 1-by-b array of scalars, where b = m*(m - 1)/2. This array contains</span>
<span class="sd">		all the pair-wise point distances, arranged in the order (1, 0), </span>
<span class="sd">		(2, 0), ..., (m-1, 0), (2, 1), ..., (m-1, 1), ..., (m-1, m-2).</span>
<span class="sd">	</span>
<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	::</span>
<span class="sd">	</span>
<span class="sd">		&gt;&gt;&gt; x = np.array([[0.1629447, 0.8616334],</span>
<span class="sd">		...               [0.5811584, 0.3826752],</span>
<span class="sd">		...               [0.2270954, 0.4442068],</span>
<span class="sd">		...               [0.7670017, 0.7264718],</span>
<span class="sd">		...               [0.8253975, 0.1937736]])</span>
<span class="sd">		&gt;&gt;&gt; _pdist(x)</span>
<span class="sd">		array([ 0.6358488,  0.4223272,  0.6189940,  0.9406808,  0.3593699,</span>
<span class="sd">				0.3908118,  0.3087661,  0.6092392,  0.6486001,  0.5358894])</span>
<span class="sd">			  </span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
	<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Input array must be 2d-dimensional&#39;</span>
	
	<span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span>
	<span class="k">if</span> <span class="n">m</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">:</span>
		<span class="k">return</span> <span class="p">[]</span>
	
	<span class="n">d</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
			<span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">sum</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
	
	<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../squid.html">Squid</a></li>
<li class="toctree-l1"><a class="reference internal" href="../codebase.html">Codebase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Squid 0.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Henry Herbol.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>