
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>tersoff &#8212; Squid 2.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Squid 2.0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for tersoff</h1><div class="highlight"><pre>
<span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">The Tersoff object.  This stores the indices and TERSOFF parameters.</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">product</span>
<span class="kn">from</span> <span class="nn">squid.utils.cast</span> <span class="k">import</span> <span class="n">is_numeric</span>
<span class="kn">import</span> <span class="nn">squid.forcefields.smrff</span> <span class="k">as</span> <span class="nn">smrff_utils</span>
<span class="kn">from</span> <span class="nn">squid.forcefields.helper</span> <span class="k">import</span> <span class="n">check_restriction</span>

<span class="n">BOUND_EPS</span> <span class="o">=</span> <span class="mf">1E-6</span>
<span class="c1"># These are the identifiers in the parameter file that we seek out</span>
<span class="c1"># NOTE! THEY ARE CASE SENSITIVE!</span>
<span class="n">TERSOFF_PFILE_ID</span> <span class="o">=</span> <span class="s2">&quot;TERSOFF&quot;</span>
<span class="n">END_ID</span> <span class="o">=</span> <span class="s2">&quot;END&quot;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The Tersoff class contains:</span>
<span class="sd">- :func:`__init__`</span>
<span class="sd">- :func:`__repr__`</span>
<span class="sd">- :func:`__eq__`</span>
<span class="sd">- :func:`__hash__`</span>
<span class="sd">- :func:`_printer`</span>
<span class="sd">- :func:`print_lower`</span>
<span class="sd">- :func:`print_upper`</span>
<span class="sd">- :func:`unpack`</span>
<span class="sd">- :func:`pack`</span>
<span class="sd">- :func:`validate`</span>
<span class="sd">- :func:`turn_off`</span>
<span class="sd">- :func:`turn_off_3body`</span>
<span class="sd">- :func:`assign_line`</span>
<span class="sd">- :func:`fix`</span>
<span class="sd">- :classmethod:`load_smrff`</span>
<span class="sd">------------</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="Tersoff"><a class="viewcode-back" href="../forcefields.html#tersoff.Tersoff">[docs]</a><span class="k">class</span> <span class="nc">Tersoff</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Initialize the Tersoff object.  The potential form can be found on the</span>
<span class="sd">    LAMMPs webpage (http://lammps.sandia.gov/doc/pair_tersoff.html).  Either</span>
<span class="sd">    specify all the parameters, or pass a string to line, but not both.  If</span>
<span class="sd">    both are specified, an error will be thrown.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">        indices: *list or tuple, str or int*</span>
<span class="sd">            The indices of the atom types in this three-body interaction.</span>

<span class="sd">        m: *int*</span>
<span class="sd">            m is an exponential term in the zeta component of the Tersoff</span>
<span class="sd">            potential.  It is either 1 or 3.</span>

<span class="sd">        gamma: *float*</span>
<span class="sd">            gamma is a prefactor to g(theta) in the Tersoff potential,</span>
<span class="sd">            and is between 0 (completely off) and 1 (completely on).</span>

<span class="sd">        lambda3: *float*</span>
<span class="sd">            lambda3 is the exponential coefficient of the three-body</span>
<span class="sd">            tersoff interaction.</span>

<span class="sd">        c: *float*</span>
<span class="sd">            c describes the numerator part of the three-body interaction</span>
<span class="sd">            (found withing the g(theta) term).</span>

<span class="sd">        d: *float*</span>
<span class="sd">            d describes the denominator part of the three-body interaction</span>
<span class="sd">            (found withing the g(theta) term).</span>

<span class="sd">        costheta0: *float*</span>
<span class="sd">            costheta0 gives an equilibrium angle of sorts for the</span>
<span class="sd">            three-body interaction.  As such, it is restricted between -1</span>
<span class="sd">            and 1.</span>

<span class="sd">        n: *float*</span>
<span class="sd">            n is a power that the three-body interaction is taken to (or</span>
<span class="sd">            to some function of n).</span>

<span class="sd">        beta: *float*</span>
<span class="sd">            beta is some scaling to the three-body interactions, found in</span>
<span class="sd">            the b_ij term of the Tersoff potential.</span>

<span class="sd">        lambda2: *float*</span>
<span class="sd">            lambda2 is the exponential coefficient of the two-body</span>
<span class="sd">            attraction term in the tersoff interaction.</span>

<span class="sd">        B: *float*</span>
<span class="sd">            B is the pre-factor to the two-body attraction term in the</span>
<span class="sd">            tersoff interaction.</span>

<span class="sd">        R: *float*</span>
<span class="sd">            R is a component of the tersoff potential&#39;s cutoff distance.</span>

<span class="sd">        D: *float*</span>
<span class="sd">            D is a component of the tersoff potential&#39;s cutoff distance.</span>

<span class="sd">        lambda1: *float*</span>
<span class="sd">            lambda1 is the exponential coefficient of the two-body</span>
<span class="sd">            repulsion term in the tersoff interaction.</span>

<span class="sd">        A: *float*</span>
<span class="sd">            A is the pre-factor to the two-body repulsion term in the</span>
<span class="sd">            tersoff interaction.</span>

<span class="sd">        line: *str*</span>
<span class="sd">            A line from a parameter file to be parsed.</span>

<span class="sd">        form: *str*</span>
<span class="sd">            Whether to use the original form (m=3, gamma=1) or the</span>
<span class="sd">            Albe et al form (m=1, beta=1).  Must be original or albe.</span>

<span class="sd">    **Returns**</span>

<span class="sd">        tersoff: :class:`Tersoff`</span>
<span class="sd">            A Tersoff object.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lambda3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">d</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">costheta0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lambda2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">B</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lambda1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">form</span><span class="o">=</span><span class="s2">&quot;original&quot;</span><span class="p">):</span>

        <span class="n">form</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">form</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="s2">&quot;albe&quot;</span><span class="p">],</span>\
            <span class="s2">&quot;Error - Form must be either original or albe&quot;</span>

        <span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="n">indices</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">lambda3</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">costheta0</span><span class="p">,</span>
             <span class="n">n</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">lambda2</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">lambda1</span><span class="p">,</span> <span class="n">A</span><span class="p">]</span>

        <span class="c1"># How many parameters exist in this potential</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N_params</span> <span class="o">=</span> <span class="mi">14</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sym_2body_tag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_gamma</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_beta</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">P</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">form</span> <span class="o">==</span> <span class="s2">&quot;original&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gamma_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">beta_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">N_params</span> <span class="o">=</span> <span class="mi">12</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">skip_m</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">skip_gamma</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">form</span> <span class="o">==</span> <span class="s2">&quot;albe&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">beta_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gamma_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">N_params</span> <span class="o">=</span> <span class="mi">12</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">skip_m</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">skip_beta</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assign_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">line</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">P</span><span class="p">]):</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">),</span>\
                <span class="s2">&quot;In Tersoff, initialized indices are not list/tuple!&quot;</span>

            <span class="k">if</span> <span class="n">form</span> <span class="o">==</span> <span class="s2">&quot;original&quot;</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Error - In original form, m must be 3.&quot;</span>
                <span class="k">assert</span> <span class="n">gamma</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Error - In original form, gamma must be 1.&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gamma_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">beta_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">N_params</span> <span class="o">=</span> <span class="mi">12</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">skip_m</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">skip_gamma</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">form</span> <span class="o">==</span> <span class="s2">&quot;albe&quot;</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
                    <span class="s2">&quot;Error - In Albe et al. form, m must be 1.&quot;</span>
                <span class="k">assert</span> <span class="n">beta</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
                    <span class="s2">&quot;Error - In Albe et al. form, beta must be 1.&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">beta_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gamma_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">N_params</span> <span class="o">=</span> <span class="mi">12</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">skip_m</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">skip_beta</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">m</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda3</span> <span class="o">=</span> <span class="n">lambda3</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">d</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">costheta0</span> <span class="o">=</span> <span class="n">costheta0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">beta</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span> <span class="o">=</span> <span class="n">lambda2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">B</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">R</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">D</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span> <span class="o">=</span> <span class="n">lambda1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">A</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Either specify all Tersoff parameters, or the </span><span class="se">\</span>
<span class="s2">line to be parsed, but not both.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_default_bounds</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This prints out a representation of this tersoff object, in the format</span>
<span class="sd">        that is output to the smrff parameter file.</span>

<span class="sd">        **Returns**</span>

<span class="sd">            tersoff: *str*</span>
<span class="sd">                A string representation of Tersoff parameters.  It is in the</span>
<span class="sd">                following order:</span>
<span class="sd">                    indices m gamma lambda3 c d costheta0</span>
<span class="sd">                            n beta  lambda2 B R     D     lambda1   A</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_printer</span><span class="p">(</span><span class="n">with_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;*&quot;</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                       <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;indices&quot;</span><span class="p">):</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;*&quot;</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                       <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span> <span class="o">==</span> <span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span> <span class="n">indices</span><span class="p">)])</span>
<span class="c1">#        return (all([x == y for x, y in zip(self.indices, indices)]) or</span>
<span class="c1">#                all([x == y for x, y in zip(self.indices, indices[::-1])]))</span>

    <span class="k">def</span> <span class="nf">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># return hash(tuple(self.unpack(with_indices=True) + self.unpack(bounds=0) + self.unpack(bounds=1)))</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_printer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This prints out a representation of this tersoff object,</span>
<span class="sd">        in the format that is output to the smrff parameter file.</span>

<span class="sd">        **Parameters**</span>

<span class="sd">            with_indices: *bool, optional*</span>
<span class="sd">                Whether to also include the indices in the output.</span>

<span class="sd">            bounds: *int, optional*</span>
<span class="sd">                Whether to output the lower bounds (0), or upper bounds (1).</span>
<span class="sd">                If None, then the parameters themselves are output instead</span>
<span class="sd">                (default).</span>

<span class="sd">        **Returns**</span>

<span class="sd">            tersoff: *str*</span>
<span class="sd">                A string representation of Tersoff parameters.  It is in the</span>
<span class="sd">                following order:</span>
<span class="sd">                    indices m gamma lambda3 c d costheta0</span>
<span class="sd">                            n beta  lambda2 B R     D     lambda1   A</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
        <span class="c1"># Store these values to set after we get the full array</span>
        <span class="n">held_m</span><span class="p">,</span> <span class="n">held_beta</span><span class="p">,</span> <span class="n">held_gamma</span> <span class="o">=</span>\
            <span class="bp">self</span><span class="o">.</span><span class="n">skip_m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_beta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_gamma</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_beta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_gamma</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span>

        <span class="n">first_row</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span>
            <span class="n">with_indices</span><span class="o">=</span><span class="n">with_indices</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">for_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">])</span>
        <span class="n">second_row</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span>
            <span class="n">with_indices</span><span class="o">=</span><span class="n">with_indices</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">for_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">7</span><span class="p">:])</span>

        <span class="c1"># Reset held values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_beta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_gamma</span> <span class="o">=</span>\
            <span class="n">held_m</span><span class="p">,</span> <span class="n">held_beta</span><span class="p">,</span> <span class="n">held_gamma</span>

        <span class="k">return</span> <span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">))</span> <span class="o">+</span>
                <span class="s2">&quot;      </span><span class="si">%d</span><span class="s2">   </span><span class="si">%.4f</span><span class="s2">   </span><span class="si">%.4f</span><span class="s2">   </span><span class="si">%.4f</span><span class="s2">   </span><span class="si">%.4f</span><span class="s2">   </span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">first_row</span> <span class="o">+</span>
                <span class="s2">&quot;</span><span class="se">\n\t\t</span><span class="s2"> </span><span class="si">%.4f</span><span class="s2">   </span><span class="si">%.4f</span><span class="s2">   </span><span class="si">%.4f</span><span class="s2">   </span><span class="si">%.4f</span><span class="s2">   </span><span class="si">%.4f</span><span class="s2">   </span><span class="si">%.4f</span><span class="s2">   </span><span class="si">%.4f</span><span class="s2">   </span><span class="si">%.4f</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">second_row</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">dump_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;pair_coeff * * tersoff &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_printer</span><span class="p">(</span><span class="n">with_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<div class="viewcode-block" id="Tersoff.print_lower"><a class="viewcode-back" href="../forcefields.html#tersoff.Tersoff.print_lower">[docs]</a>    <span class="k">def</span> <span class="nf">print_lower</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This prints out a representation of this tersoff object&#39;s upper bound,</span>
<span class="sd">        in the format that is output to the smrff parameter file.</span>

<span class="sd">        **Returns**</span>

<span class="sd">            tersoff: *str*</span>
<span class="sd">                A string representation of Tersoff parameters.  It is in the</span>
<span class="sd">                following order:</span>
<span class="sd">                    indices m gamma lambda3 c d costheta0</span>
<span class="sd">                            n beta  lambda2 B R     D     lambda1   A</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_printer</span><span class="p">(</span><span class="n">with_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="Tersoff.print_upper"><a class="viewcode-back" href="../forcefields.html#tersoff.Tersoff.print_upper">[docs]</a>    <span class="k">def</span> <span class="nf">print_upper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This prints out a representation of this tersoff object&#39;s upper bound,</span>
<span class="sd">        in the format that is output to the smrff parameter file.</span>

<span class="sd">        **Returns**</span>

<span class="sd">            tersoff: *str*</span>
<span class="sd">                A string representation of Tersoff parameters.  It is in the</span>
<span class="sd">                following order:</span>
<span class="sd">                    indices m gamma lambda3 c d costheta0</span>
<span class="sd">                            n beta  lambda2 B R     D     lambda1   A</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_printer</span><span class="p">(</span><span class="n">with_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Tersoff.set_default_bounds"><a class="viewcode-back" href="../forcefields.html#tersoff.Tersoff.set_default_bounds">[docs]</a>    <span class="k">def</span> <span class="nf">set_default_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Assign default bounds.  Further, if this is the case of A-B-B vs A-B-C</span>
<span class="sd">        we can simplify the bounds as only in the case of A-B-B are two body</span>
<span class="sd">        parameters n, Beta, lambda2, lambda1, and A read in.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lambda3_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">150000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">costheta0_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0002</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">D_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda2_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">B_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">200.0</span><span class="p">,</span> <span class="mf">300000.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda1_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">A_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">200.0</span><span class="p">,</span> <span class="mf">300000.0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda2_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">B_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda1_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">A_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">beta_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;This should never happen!&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Tersoff.unpack"><a class="viewcode-back" href="../forcefields.html#tersoff.Tersoff.unpack">[docs]</a>    <span class="k">def</span> <span class="nf">unpack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">with_bounds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">for_output</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function unpacks the tersoff object into a list.</span>

<span class="sd">        **Parameters**</span>

<span class="sd">            with_indices: *bool, optional*</span>
<span class="sd">                Whether to also include the indices in the list.</span>

<span class="sd">            bounds: *int, optional*</span>
<span class="sd">                Whether to output the lower bounds (0), or upper bounds (1).</span>
<span class="sd">                If None, then the parameters themselves are output</span>
<span class="sd">                instead (default).</span>

<span class="sd">            with_bounds: *bool, optional*</span>
<span class="sd">                Whether to output the bounds or not.</span>

<span class="sd">            for_output: *bool, optional*</span>
<span class="sd">                Whether this is for output (in which case we disregard</span>
<span class="sd">                2-body sym flag)</span>

<span class="sd">        **Returns**</span>

<span class="sd">            tersoff: *list, str/float*</span>
<span class="sd">                A list, holding the string of the indices, m, gamma, lambda3,</span>
<span class="sd">                c, d, costheta0, n, beta, lambda2, B, R, D, lambda1, A.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

        <span class="n">pkg</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">tag_for_2body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sym_2body_tag</span>
        <span class="k">if</span> <span class="n">for_output</span><span class="p">:</span>
            <span class="n">tag_for_2body</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pkg</span><span class="o">.</span><span class="n">append</span><span class="p">([</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="k">if</span> <span class="n">with_indices</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_bounds</span><span class="p">[</span><span class="n">bounds</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_m</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gamma_bounds</span><span class="p">[</span><span class="n">bounds</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_gamma</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lambda3_bounds</span><span class="p">[</span><span class="n">bounds</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c_bounds</span><span class="p">[</span><span class="n">bounds</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_bounds</span><span class="p">[</span><span class="n">bounds</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">costheta0_bounds</span><span class="p">[</span><span class="n">bounds</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n_bounds</span><span class="p">[</span><span class="n">bounds</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tag_for_2body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">beta_bounds</span><span class="p">[</span><span class="n">bounds</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span>
                    <span class="n">tag_for_2body</span><span class="p">,</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_beta</span><span class="p">])</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lambda2_bounds</span><span class="p">[</span><span class="n">bounds</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tag_for_2body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B_bounds</span><span class="p">[</span><span class="n">bounds</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tag_for_2body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">R_bounds</span><span class="p">[</span><span class="n">bounds</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">D_bounds</span><span class="p">[</span><span class="n">bounds</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lambda1_bounds</span><span class="p">[</span><span class="n">bounds</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tag_for_2body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">A_bounds</span><span class="p">[</span><span class="n">bounds</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tag_for_2body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">])</span>
            <span class="n">pkg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pkg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pkg</span><span class="o">.</span><span class="n">append</span><span class="p">([</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="k">if</span> <span class="n">with_indices</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_m</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_gamma</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lambda3</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">costheta0</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tag_for_2body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span>
                    <span class="n">tag_for_2body</span><span class="p">,</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_beta</span><span class="p">])</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tag_for_2body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tag_for_2body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tag_for_2body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tag_for_2body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">])</span>
            <span class="n">pkg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pkg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">with_bounds</span><span class="p">:</span>
            <span class="c1"># Get all lower and upper bounds added to pkg</span>
            <span class="c1"># After this, pkg = [params, lower, upper]</span>
            <span class="n">bnds</span> <span class="o">=</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m_bounds</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_m</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gamma_bounds</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_gamma</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lambda3_bounds</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c_bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_bounds</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">costheta0_bounds</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n_bounds</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tag_for_2body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">beta_bounds</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span>
                    <span class="n">tag_for_2body</span><span class="p">,</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_beta</span><span class="p">])</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lambda2_bounds</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tag_for_2body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B_bounds</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tag_for_2body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">R_bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">D_bounds</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lambda1_bounds</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tag_for_2body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">A_bounds</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tag_for_2body</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="p">]</span>
            <span class="n">bnds</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bnds</span> <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">bnd</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">bnds</span><span class="p">)):</span>
                <span class="n">pkg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">*</span><span class="n">bnd</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">pkg</span>

        <span class="k">return</span> <span class="n">pkg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Tersoff.pack"><a class="viewcode-back" href="../forcefields.html#tersoff.Tersoff.pack">[docs]</a>    <span class="k">def</span> <span class="nf">pack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function packs the tersoff object from a list.</span>

<span class="sd">        **Parameters**</span>

<span class="sd">            params: *list*</span>
<span class="sd">                A list holding the indices, m, gamma, lambda3, c, d,</span>
<span class="sd">                costheta0, n, beta, lambda2, B, R, D, lambda1, A.</span>

<span class="sd">        **Returns**</span>

<span class="sd">            None</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>\
            <span class="s2">&quot;In Tersoff, tried packing </span><span class="si">%d</span><span class="s2"> parameters. </span><span class="se">\</span>
<span class="s2">Should be either 8, 9, 14, or 15!&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

        <span class="c1"># In the case of the first parameter being the indices, we offset the</span>
        <span class="c1"># indexing later on.</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_numeric</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_m</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span> <span class="o">+</span> <span class="n">offset</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_gamma</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">offset</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lambda3</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">3</span> <span class="o">+</span> <span class="n">offset</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">4</span> <span class="o">+</span> <span class="n">offset</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">5</span> <span class="o">+</span> <span class="n">offset</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">costheta0</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">6</span> <span class="o">+</span> <span class="n">offset</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sym_2body_tag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">7</span> <span class="o">+</span> <span class="n">offset</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_beta</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">8</span> <span class="o">+</span> <span class="n">offset</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">offset</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">9</span> <span class="o">+</span> <span class="n">offset</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">10</span> <span class="o">+</span> <span class="n">offset</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">11</span> <span class="o">+</span> <span class="n">offset</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sym_2body_tag</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">12</span> <span class="o">+</span> <span class="n">offset</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sym_2body_tag</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sym_2body_tag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">13</span> <span class="o">+</span> <span class="n">offset</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">14</span> <span class="o">+</span> <span class="n">offset</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span></div>

<div class="viewcode-block" id="Tersoff.validate"><a class="viewcode-back" href="../forcefields.html#tersoff.Tersoff.validate">[docs]</a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function will validate data integrity.  In this case, we simply</span>
<span class="sd">        ensure data types are appropriate.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>\
            <span class="s2">&quot;In Tersoff </span><span class="si">%s</span><span class="s2">, m = </span><span class="si">%.2f</span><span class="s2"> must be either 1 or 3!&quot;</span>\
            <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span>\
            <span class="s2">&quot;In Tersoff </span><span class="si">%s</span><span class="s2">, gamma = </span><span class="si">%.2f</span><span class="s2"> must be [0, 1] inclusive!&quot;</span>\
            <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lambda3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lambda3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">costheta0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">costheta0</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">costheta0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">,</span>\
            <span class="s2">&quot;In Tersoff </span><span class="si">%s</span><span class="s2">, costheta0 = </span><span class="si">%.2f</span><span class="s2"> must be [-1, 1] inclusive!&quot;</span>\
            <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">costheta0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>\
            <span class="s2">&quot;In Tersoff </span><span class="si">%s</span><span class="s2">, R = </span><span class="si">%.2f</span><span class="s2"> and D = </span><span class="si">%.2f</span><span class="s2">; however, they should be </span><span class="se">\</span>
<span class="s2">positive such that R &gt;= D!&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">,</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">costheta0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span><span class="p">,</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">]</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">m_bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma_bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda3_bounds</span><span class="p">,</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">c_bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">costheta0_bounds</span><span class="p">,</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">n_bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda2_bounds</span><span class="p">,</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">B_bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R_bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">D_bounds</span><span class="p">,</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">lambda1_bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A_bounds</span><span class="p">]</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">,</span> <span class="s2">&quot;lambda3&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;costheta0&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="s2">&quot;lambda2&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;lambda1&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">bound</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">param</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">bound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">BOUND_EPS</span><span class="p">)</span> <span class="ow">and</span> <span class="n">param</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">bound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">BOUND_EPS</span><span class="p">),</span> <span class="s2">&quot;In Tersoff </span><span class="si">%s</span><span class="s2">, parameter </span><span class="si">%s</span><span class="s2"> = </span><span class="si">%.2f</span><span class="s2"> is outside of it&#39;s range = [</span><span class="si">%.2f</span><span class="s2">, </span><span class="si">%.2f</span><span class="s2">]!&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">),</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">bound</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bound</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>

    <span class="k">def</span> <span class="nf">_turn_off</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">leave_two_body_on</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Two possibilities exist when turning off 3-body only.  First is to</span>
<span class="sd">        set beta to 0, and n to 1.  This would set b_ij = 1, effectively</span>
<span class="sd">        simplifying parameters such that we get</span>
<span class="sd">            Ae^{-lambda1r} - Be^{-lambda2r}.</span>
<span class="sd">        The other is to set gamma to 1, c to 0, and lambda3 to 0.  This would</span>
<span class="sd">        have the effect of leaving beta and n active; however, wouldn&#39;t really</span>
<span class="sd">        make much difference as we could simply redefine:</span>
<span class="sd">            B&#39; = B * (1 + beta^n)^{-1/(2n)}</span>
<span class="sd">        Thus, we will go with the simpler version of setting beta=0.  This</span>
<span class="sd">        has the added benefit of reducing parameters.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># If this is not a two-body one, then switch to False</span>
        <span class="k">if</span> <span class="n">leave_two_body_on</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
            <span class="n">leave_two_body_on</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Make a small cutoff so the only time tersoff is on is if something</span>
        <span class="c1"># weird happens and atoms are essentially overlapping.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">leave_two_body_on</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">2E-3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">1E-3</span><span class="p">)</span>

        <span class="c1"># Set two-body interaction to insanely large repulsion.  Note, setting</span>
        <span class="c1"># B to 0 also removes the three-body interactions.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">leave_two_body_on</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">100000.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="c1"># Set all other parameters to 1 so we know this is off</span>
        <span class="n">others</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;gamma&quot;</span><span class="p">,</span> <span class="s2">&quot;lambda3&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;costheta0&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">others</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">leave_two_body_on</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="s2">&quot;lambda1&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="s2">&quot;lambda2&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<div class="viewcode-block" id="Tersoff.turn_off"><a class="viewcode-back" href="../forcefields.html#tersoff.Tersoff.turn_off">[docs]</a>    <span class="k">def</span> <span class="nf">turn_off</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function essentially turns off the Tersoff potential.  This is</span>
<span class="sd">        accomplished by:</span>

<span class="sd">            1. Setting a small cutoff distance.</span>
<span class="sd">            2. Assigning an impossibly large repulsion energy (A is large)</span>
<span class="sd">            3. Removing attractive potential (B is 0)</span>
<span class="sd">            4. Setting beta to 0 (this removes the three-body interaction)</span>
<span class="sd">            5. Setting all benign (unused) parameters to 1</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_turn_off</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Tersoff.turn_off_3body"><a class="viewcode-back" href="../forcefields.html#tersoff.Tersoff.turn_off_3body">[docs]</a>    <span class="k">def</span> <span class="nf">turn_off_3body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function essentially turns off the 3-body component of the</span>
<span class="sd">        Tersoff potential.  This is accomplished by:</span>

<span class="sd">            1. Setting beta to 0 (this removes the three-body interaction)</span>
<span class="sd">            2. Setting all benign (unused) parameters to 1</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_turn_off</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="Tersoff.parse_line"><a class="viewcode-back" href="../forcefields.html#tersoff.Tersoff.parse_line">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parse_line</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse line inputs and assign to this object.</span>

<span class="sd">        **Parameters**</span>

<span class="sd">            line: *str*</span>
<span class="sd">                A string that holds a three-body tersoff parameter set.</span>

<span class="sd">        **Returns**</span>

<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        <span class="n">lambda3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
        <span class="n">c</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
        <span class="n">costheta0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
        <span class="n">lambda2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span>
        <span class="n">B</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>
        <span class="n">R</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">13</span><span class="p">])</span>
        <span class="n">D</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">14</span><span class="p">])</span>
        <span class="n">lambda1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">15</span><span class="p">])</span>
        <span class="n">A</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">16</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">indices</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">lambda3</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">costheta0</span><span class="p">,</span>\
            <span class="n">n</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">lambda2</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">lambda1</span><span class="p">,</span> <span class="n">A</span></div>

    <span class="k">def</span> <span class="nf">assign_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">costheta0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

<div class="viewcode-block" id="Tersoff.fix"><a class="viewcode-back" href="../forcefields.html#tersoff.Tersoff.fix">[docs]</a>    <span class="k">def</span> <span class="nf">fix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This will fix these parameters by assigning bounds to the</span>
<span class="sd">        values themselves.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">params</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">),</span>\
                    <span class="s2">&quot;Error - Neither a list or tuple was passed when fixing </span><span class="se">\</span>
<span class="s2">all tersoff params (passed </span><span class="si">%s</span><span class="s2">).&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">14</span><span class="p">,</span>\
                    <span class="s2">&quot;Error - Needed 14 values in fix tersoff, but </span><span class="si">%s</span><span class="s2"> was </span><span class="se">\</span>
<span class="s2">passed instead.&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">,</span>\
                    <span class="bp">self</span><span class="o">.</span><span class="n">costheta0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span><span class="p">,</span>\
                    <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gamma_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda3_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lambda3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">costheta0_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">costheta0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">costheta0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">beta_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda2_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">B_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">R_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">D_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda1_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">A_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">params</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
                        <span class="s2">&quot;Error - Tried fixing m in Tersoff with </span><span class="si">%s</span><span class="s2">.&quot;</span>\
                        <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">params</span> <span class="o">==</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
                        <span class="s2">&quot;Error - Tried fixing gamma in Tersoff with </span><span class="si">%s</span><span class="s2">.&quot;</span>\
                        <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gamma_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">params</span> <span class="o">==</span> <span class="s2">&quot;lambda3&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
                        <span class="s2">&quot;Error - Tried fixing lambda3 in Tersoff with </span><span class="si">%s</span><span class="s2">.&quot;</span>\
                        <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lambda3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda3_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lambda3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda3</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">params</span> <span class="o">==</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
                        <span class="s2">&quot;Error - Tried fixing c in Tersoff with </span><span class="si">%s</span><span class="s2">.&quot;</span>\
                        <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">params</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
                        <span class="s2">&quot;Error - Tried fixing d in Tersoff with </span><span class="si">%s</span><span class="s2">.&quot;</span>\
                        <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">params</span> <span class="o">==</span> <span class="s2">&quot;costheta0&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
                        <span class="s2">&quot;Error - Tried fixing costheta0 in Tersoff with </span><span class="si">%s</span><span class="s2">.&quot;</span>\
                        <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">costheta0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">costheta0_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">costheta0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">costheta0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">params</span> <span class="o">==</span> <span class="s2">&quot;n&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
                        <span class="s2">&quot;Error - Tried fixing n in Tersoff with </span><span class="si">%s</span><span class="s2">.&quot;</span>\
                        <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">params</span> <span class="o">==</span> <span class="s2">&quot;beta&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
                        <span class="s2">&quot;Error - Tried fixing beta in Tersoff with </span><span class="si">%s</span><span class="s2">.&quot;</span>\
                        <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">beta_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">params</span> <span class="o">==</span> <span class="s2">&quot;lambda2&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
                        <span class="s2">&quot;Error - Tried fixing lambda2 in Tersoff with </span><span class="si">%s</span><span class="s2">.&quot;</span>\
                        <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda2_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">params</span> <span class="o">==</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
                        <span class="s2">&quot;Error - Tried fixing B in Tersoff with </span><span class="si">%s</span><span class="s2">.&quot;</span>\
                        <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">B_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">params</span> <span class="o">==</span> <span class="s2">&quot;R&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
                        <span class="s2">&quot;Error - Tried fixing R in Tersoff with </span><span class="si">%s</span><span class="s2">.&quot;</span>\
                        <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">R_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">params</span> <span class="o">==</span> <span class="s2">&quot;D&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
                        <span class="s2">&quot;Error - Tried fixing D in Tersoff with </span><span class="si">%s</span><span class="s2">.&quot;</span>\
                        <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">D_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">params</span> <span class="o">==</span> <span class="s2">&quot;lambda1&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
                        <span class="s2">&quot;Error - Tried fixing lambda1 in Tersoff with </span><span class="si">%s</span><span class="s2">.&quot;</span>\
                        <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lambda1_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">params</span> <span class="o">==</span> <span class="s2">&quot;A&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>\
                        <span class="s2">&quot;Error - Tried fixing A in Tersoff with </span><span class="si">%s</span><span class="s2">.&quot;</span>\
                        <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">A_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;In Tersoff, tried fixing </span><span class="si">%s</span><span class="s2"> parameter (does not exist)!&quot;</span>
                <span class="o">%</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="Tersoff.load_smrff"><a class="viewcode-back" href="../forcefields.html#tersoff.Tersoff.load_smrff">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">load_smrff</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">parsed_file</span><span class="p">,</span> <span class="n">pfile_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">restrict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Given a parameter file, inport the coulomb parameters if possible.</span>

<span class="sd">        **Parameters**</span>
<span class="sd">            parsed_file: *str*</span>
<span class="sd">                A parsed smrff parameter file input string (no comments or</span>
<span class="sd">                trailing white spaces)</span>
<span class="sd">            pfile_name: *str*</span>
<span class="sd">                The name of a parameter file to be parsed.  If specified,</span>
<span class="sd">                then parsed_file is ignored (you may simply pass None as</span>
<span class="sd">                parsed_file).</span>

<span class="sd">        **Returns**</span>

<span class="sd">            tersoff_objs: *list, Tersoff*, or *None*</span>
<span class="sd">                Returns a list of Tersoff objects if possible, else None.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Ensure correct pfile format, and that we even need to parse it.</span>
        <span class="k">if</span> <span class="n">pfile_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parsed_file</span> <span class="o">=</span> <span class="n">smrff_utils</span><span class="o">.</span><span class="n">parse_pfile</span><span class="p">(</span><span class="n">pfile_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">TERSOFF_PFILE_ID</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parsed_file</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">parsed_file</span> <span class="o">=</span> <span class="n">parsed_file</span><span class="p">[</span><span class="n">parsed_file</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">TERSOFF_PFILE_ID</span><span class="p">):]</span>
        <span class="n">parsed_file</span> <span class="o">=</span> <span class="n">parsed_file</span><span class="p">[:</span><span class="n">parsed_file</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">END_ID</span><span class="p">)]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Because Tersoff may be split into two lines, we need additional</span>
        <span class="c1"># parsing.  Each line should have 17 things in it:</span>
        <span class="c1">#    3 indices, 14 tersoff parameters</span>
        <span class="n">parsed_file</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parsed_file</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed_file</span><span class="p">)</span> <span class="o">%</span> <span class="mi">17</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>\
            <span class="s2">&quot;Error - there appears to be an issue in how the Tersoff </span><span class="se">\</span>
<span class="s2">parameters are defined.&quot;</span>

        <span class="n">parsed_file</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parsed_file</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">17</span><span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">17</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parsed_file</span><span class="p">)</span> <span class="o">/</span> <span class="mi">17</span><span class="p">))]</span>
        <span class="n">parsed_file</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">parse_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">parsed_file</span><span class="p">]</span>

        <span class="c1"># indices, m, gamma, lambda3, c, d, costheta0, n,</span>
        <span class="c1"># beta, lambda2, B, R, D, lambda1, A</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="bp">cls</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span> <span class="n">lambda3</span><span class="o">=</span><span class="n">lambda3</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span>
                <span class="n">costheta0</span><span class="o">=</span><span class="n">costheta0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> <span class="n">lambda2</span><span class="o">=</span><span class="n">lambda2</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="n">B</span><span class="p">,</span>
                <span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">,</span> <span class="n">lambda1</span><span class="o">=</span><span class="n">lambda1</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="n">A</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">indices</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">lambda3</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">costheta0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span>
            <span class="n">beta</span><span class="p">,</span> <span class="n">lambda2</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">lambda1</span><span class="p">,</span> <span class="n">A</span> <span class="ow">in</span> <span class="n">parsed_file</span>
            <span class="k">if</span> <span class="n">check_restriction</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">restrict</span><span class="p">)</span>
        <span class="p">]</span></div>

<div class="viewcode-block" id="Tersoff.generate"><a class="viewcode-back" href="../forcefields.html#tersoff.Tersoff.generate">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">atom_types</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="s2">&quot;original&quot;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Randomly generate parameters for tersoff.</span>

<span class="sd">        **Parameters**</span>

<span class="sd">            atom_types: *list, str*</span>
<span class="sd">                A list of all the atom types to have parameters generated for.</span>
<span class="sd">            form: *str*</span>
<span class="sd">                Whether to use the original form (m=3, gamma=1) or the</span>
<span class="sd">                Albe et al form (m=1, beta=1).  Must be original or albe.</span>

<span class="sd">        **Returns**</span>

<span class="sd">            ters_objs: *list, Tersoff*</span>
<span class="sd">                Returns a list of Tersoff objects.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">from</span> <span class="nn">helper</span> <span class="k">import</span> <span class="n">random_in_range</span>

        <span class="n">form</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">form</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="s2">&quot;albe&quot;</span><span class="p">],</span>\
            <span class="s2">&quot;Error - form must be either original or albe.&quot;</span>

        <span class="n">Tersoff_Objs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">indices</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">atom_types</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">3</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">form</span> <span class="o">==</span> <span class="s2">&quot;original&quot;</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="mi">3</span>
                <span class="n">gamma</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">beta</span> <span class="o">=</span> <span class="n">random_in_range</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">form</span> <span class="o">==</span> <span class="s2">&quot;albe&quot;</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">gamma</span> <span class="o">=</span> <span class="n">random_in_range</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>

            <span class="n">lambda3</span> <span class="o">=</span> <span class="n">random_in_range</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">random_in_range</span><span class="p">((</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">150000.0</span><span class="p">))</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">random_in_range</span><span class="p">((</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">))</span>
            <span class="n">costheta0</span> <span class="o">=</span> <span class="n">random_in_range</span><span class="p">((</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">random_in_range</span><span class="p">((</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>
            <span class="n">lambda2</span> <span class="o">=</span> <span class="n">random_in_range</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">))</span>
            <span class="c1"># We expect A &gt;&gt; B, so we randomly generate B to being smaller.</span>
            <span class="c1"># However, we do have a B_bounds that goes up to 300,000.0</span>
            <span class="n">B</span> <span class="o">=</span> <span class="n">random_in_range</span><span class="p">((</span><span class="mf">200.0</span><span class="p">,</span> <span class="mf">50000.0</span><span class="p">))</span>
            <span class="n">R</span> <span class="o">=</span> <span class="n">random_in_range</span><span class="p">((</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">))</span>
            <span class="n">D</span> <span class="o">=</span> <span class="n">random_in_range</span><span class="p">((</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
            <span class="n">lambda1</span> <span class="o">=</span> <span class="n">random_in_range</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">))</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">random_in_range</span><span class="p">((</span><span class="mf">200.0</span><span class="p">,</span> <span class="mf">300000.0</span><span class="p">))</span>

            <span class="n">Tersoff_Objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="bp">cls</span><span class="p">(</span>
                    <span class="n">indices</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">lambda3</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span>
                    <span class="n">costheta0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">lambda2</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span>
                    <span class="n">D</span><span class="p">,</span> <span class="n">lambda1</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">Tersoff_Objs</span></div>

<div class="viewcode-block" id="Tersoff.update_2body"><a class="viewcode-back" href="../forcefields.html#tersoff.Tersoff.update_2body">[docs]</a>    <span class="k">def</span> <span class="nf">update_2body</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Given a tersoff parameter object, update the current one with</span>
<span class="sd">        the 2-body parameters (n, beta, lambda1, lambda2, A, B).</span>

<span class="sd">        **Parameters**</span>

<span class="sd">            other: *:class:`Tersoff`*</span>
<span class="sd">                A Tersoff parameter object to get 2-body parameters from.</span>

<span class="sd">        **Returns**</span>

<span class="sd">            None</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">beta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">lambda1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">lambda2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">A</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">B</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n_bounds</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">n_bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta_bounds</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">beta_bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lambda1_bounds</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">lambda1_bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lambda2_bounds</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">lambda2_bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A_bounds</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">A_bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B_bounds</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">B_bounds</span></div></div>


<div class="viewcode-block" id="verify_tersoff_2body_symmetry"><a class="viewcode-back" href="../forcefields.html#tersoff.verify_tersoff_2body_symmetry">[docs]</a><span class="k">def</span> <span class="nf">verify_tersoff_2body_symmetry</span><span class="p">(</span><span class="n">tersoff_params</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Given a list of tersoff parameters, verify that they are such that</span>
<span class="sd">    the two-body parameters are symmetric.  What this means is that when</span>
<span class="sd">    we consider A-B B and B-A A, the two body parameters must be the same.</span>
<span class="sd">    This is necessary as LAMMPs will randomly isolate the two body</span>
<span class="sd">    interaction (A-B or B-A) and use the corresponding parameters.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">        tersoff_params: *list,* :class:`Tersoff`</span>
<span class="sd">            A list of Tersoff objects.</span>

<span class="sd">    **Returns**</span>

<span class="sd">        None</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ters_A</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tersoff_params</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">ters_B</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tersoff_params</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">j</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span>
                <span class="n">ters_A</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">ters_B</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">ters_A</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">ters_B</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">ters_A</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">ters_A</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="n">ters_B</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">ters_B</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">2</span><span class="p">]]):</span>
                <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span>
                    <span class="n">ters_A</span><span class="o">.</span><span class="n">n</span> <span class="o">==</span> <span class="n">ters_B</span><span class="o">.</span><span class="n">n</span><span class="p">,</span>
                    <span class="n">ters_A</span><span class="o">.</span><span class="n">beta</span> <span class="o">==</span> <span class="n">ters_B</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span>
                    <span class="n">ters_A</span><span class="o">.</span><span class="n">lambda1</span> <span class="o">==</span> <span class="n">ters_B</span><span class="o">.</span><span class="n">lambda1</span><span class="p">,</span>
                    <span class="n">ters_A</span><span class="o">.</span><span class="n">lambda2</span> <span class="o">==</span> <span class="n">ters_B</span><span class="o">.</span><span class="n">lambda2</span><span class="p">,</span>
                    <span class="n">ters_A</span><span class="o">.</span><span class="n">A</span> <span class="o">==</span> <span class="n">ters_B</span><span class="o">.</span><span class="n">A</span><span class="p">,</span>
                    <span class="n">ters_A</span><span class="o">.</span><span class="n">B</span> <span class="o">==</span> <span class="n">ters_B</span><span class="o">.</span><span class="n">B</span>
                <span class="p">]),</span> <span class="s2">&quot;Error: 2-body symmetry requirements failed for </span><span class="si">%s</span><span class="s2">&quot;</span>\
                    <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">ters_A</span><span class="o">.</span><span class="n">indices</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span></div>


<span class="k">def</span> <span class="nf">_unique_grab_2body</span><span class="p">(</span><span class="n">tersoff_params</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Given a list of tersoff parameters, we return a consistent, unique list of</span>
<span class="sd">    two bodies.  This is used such that we can consistently remove the inverse</span>
<span class="sd">    list.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">        tersoff_params: *list,* :class:`Tersoff`</span>
<span class="sd">            A list of Tersoff objects.</span>

<span class="sd">    **Returns**</span>

<span class="sd">        two_bodies: *list, tuple, str*</span>
<span class="sd">            A list of tuples holding the unique indices for</span>
<span class="sd">            2-body interactions.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Get a sorted list of all atom types to ensure reproducability</span>
    <span class="n">all_atom_types</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span>
        <span class="n">a</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tersoff_params</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">indices</span><span class="p">])))</span>

    <span class="c1"># Get a list of two-body interactions without symmetry</span>
    <span class="n">two_body</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_atom_types</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_atom_types</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span> <span class="ow">or</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="ow">in</span> <span class="n">two_body</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">two_body</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

    <span class="k">del</span> <span class="n">all_atom_types</span>

    <span class="k">return</span> <span class="n">two_body</span>


<div class="viewcode-block" id="sorted_force_2body_symmetry"><a class="viewcode-back" href="../forcefields.html#tersoff.sorted_force_2body_symmetry">[docs]</a><span class="k">def</span> <span class="nf">sorted_force_2body_symmetry</span><span class="p">(</span><span class="n">tersoff_params</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    In the case of randomly generating parameters, we may want to randomly</span>
<span class="sd">    force the 2body symmetry condition.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">        tersoff_params: *list,* :class:`Tersoff`</span>
<span class="sd">            A list of Tersoff objects.</span>

<span class="sd">    **Returns**</span>

<span class="sd">        corrected_tersoff_params: *list,* :class:`Tersoff`</span>
<span class="sd">            A list of Tersoff objects with the 2body symmetry</span>
<span class="sd">            condition ensured.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">two_body</span> <span class="o">=</span> <span class="n">_unique_grab_2body</span><span class="p">(</span><span class="n">tersoff_params</span><span class="p">)</span>

    <span class="c1"># Find all (b, a) and assign to values of (a, b)</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">two_body</span><span class="p">:</span>
        <span class="n">index1</span> <span class="o">=</span> <span class="n">tersoff_params</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="n">index2</span> <span class="o">=</span> <span class="n">tersoff_params</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
        <span class="n">tersoff_params</span><span class="p">[</span><span class="n">index2</span><span class="p">]</span><span class="o">.</span><span class="n">update_2body</span><span class="p">(</span><span class="n">tersoff_params</span><span class="p">[</span><span class="n">index1</span><span class="p">])</span></div>


<div class="viewcode-block" id="tag_tersoff_for_duplicate_2bodies"><a class="viewcode-back" href="../forcefields.html#tersoff.tag_tersoff_for_duplicate_2bodies">[docs]</a><span class="k">def</span> <span class="nf">tag_tersoff_for_duplicate_2bodies</span><span class="p">(</span><span class="n">tersoff_params</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function will mimic the sorted_force_2body_symmetry</span>
<span class="sd">    and tag the duplicates that would be set by</span>
<span class="sd">    sorted_force_2body_symmetry.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">        tersoff_params: *list,* :class:`Tersoff`</span>
<span class="sd">            A list of Tersoff objects.</span>

<span class="sd">    **Returns**</span>

<span class="sd">        tagged_tersoff_params: *list,* :class:`Tersoff`</span>
<span class="sd">            A list of the unique Tersoff objects.</span>

<span class="sd">    **Returns**</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">two_body</span> <span class="o">=</span> <span class="n">_unique_grab_2body</span><span class="p">(</span><span class="n">tersoff_params</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">two_body</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">tersoff_params</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
        <span class="n">tersoff_params</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">sym_2body_tag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Essentially, we no longer recognize the other params here.</span>
        <span class="n">tersoff_params</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">N_params</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="c1"># Handle any other removals too</span>
        <span class="n">tersoff_params</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">N_params</span> <span class="o">-=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tersoff_params</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">skip_m</span><span class="p">)</span>
        <span class="n">tersoff_params</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">N_params</span> <span class="o">-=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tersoff_params</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">skip_gamma</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">run_unit_tests</span><span class="p">():</span>
    <span class="c1"># Ensure we do not allow a blank Coul</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">Tersoff</span><span class="p">(</span>
            <span class="n">indices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lambda3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">d</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">costheta0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lambda2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">B</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lambda1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Tersoff initialization failed!&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="c1"># Ensure we do not allow a blank Tersoff (which should be None on all</span>
    <span class="c1"># by default)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">Tersoff</span><span class="p">()</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Tersoff initialization failed!&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="c1"># Ensure strings have not changed</span>
    <span class="c1"># In this case, because we do not have a 2-body interaction (x-y-y in indices),</span>
    <span class="c1"># many parameters take on a default.  Ensure this is true!</span>
    <span class="n">ct1</span> <span class="o">=</span> <span class="n">Tersoff</span><span class="p">(</span>
        <span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">],</span> <span class="n">m</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">lambda3</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">80000.0</span><span class="p">,</span>
        <span class="n">d</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">costheta0</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">lambda2</span><span class="o">=</span><span class="mf">4.9</span><span class="p">,</span>
        <span class="n">B</span><span class="o">=</span><span class="mf">12000.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">lambda1</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mf">60000.0</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>
    <span class="n">ct1_s_a</span> <span class="o">=</span> <span class="s2">&quot;1 1 2      3   1.0000   1.2000   80000.0000   20.0000   0.2000&quot;</span>
    <span class="n">ct1_s_b</span> <span class="o">=</span> <span class="s2">&quot;1.0000   1.0000   1.0000   1.0000   3.0000   0.5000   1.0000   1.0000&quot;</span>
    <span class="n">chk_s_a</span><span class="p">,</span> <span class="n">chk_s_b</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ct1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">ct1_s_a</span> <span class="o">==</span> <span class="n">chk_s_a</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="s2">&quot;Error - String formatting has changed&quot;</span>
    <span class="k">assert</span> <span class="n">ct1_s_b</span> <span class="o">==</span> <span class="n">chk_s_b</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="s2">&quot;Error - String formatting has changed&quot;</span>

    <span class="n">ct1</span> <span class="o">=</span> <span class="n">Tersoff</span><span class="p">(</span>
        <span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">],</span> <span class="n">m</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">lambda3</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">80000.0</span><span class="p">,</span>
        <span class="n">d</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">costheta0</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">lambda2</span><span class="o">=</span><span class="mf">4.9</span><span class="p">,</span>
        <span class="n">B</span><span class="o">=</span><span class="mf">12000.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">lambda1</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mf">60000.0</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>
    <span class="n">ct1_s_a</span> <span class="o">=</span> <span class="s2">&quot;1 1 1      3   1.0000   1.2000   80000.0000   20.0000   0.2000&quot;</span>
    <span class="n">ct1_s_b</span> <span class="o">=</span> <span class="s2">&quot;0.5000   0.8000   4.9000   12000.0000   3.0000   0.5000   1.1000   60000.0000&quot;</span>
    <span class="n">chk_s_a</span><span class="p">,</span> <span class="n">chk_s_b</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ct1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">ct1_s_a</span> <span class="o">==</span> <span class="n">chk_s_a</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="s2">&quot;Error - String formatting has changed&quot;</span>
    <span class="k">assert</span> <span class="n">ct1_s_b</span> <span class="o">==</span> <span class="n">chk_s_b</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="s2">&quot;Error - String formatting has changed&quot;</span>

    <span class="n">ct2</span> <span class="o">=</span> <span class="n">Tersoff</span><span class="p">(</span>
        <span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">],</span> <span class="n">m</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">lambda3</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">10000.0</span><span class="p">,</span>
        <span class="n">d</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">costheta0</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">0.92</span><span class="p">,</span> <span class="n">lambda2</span><span class="o">=</span><span class="mf">4.9</span><span class="p">,</span>
        <span class="n">B</span><span class="o">=</span><span class="mf">3000.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">lambda1</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mf">100000.0</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>
    <span class="n">ct2_s_a</span> <span class="o">=</span> <span class="s2">&quot;1 1 1      3   1.0000   1.2000   10000.0000   20.0000   -0.2000&quot;</span>
    <span class="n">ct2_s_b</span> <span class="o">=</span> <span class="s2">&quot;0.9000   0.9200   4.9000   3000.0000   3.0000   0.5000   1.1000   100000.0000&quot;</span>
    <span class="n">chk_s_a</span><span class="p">,</span> <span class="n">chk_s_b</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ct2</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">ct2_s_a</span> <span class="o">==</span> <span class="n">chk_s_a</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="s2">&quot;Error - String formatting has changed&quot;</span>
    <span class="k">assert</span> <span class="n">ct2_s_b</span> <span class="o">==</span> <span class="n">chk_s_b</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="s2">&quot;Error - String formatting has changed&quot;</span>

    <span class="n">ct2_hold</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">ct2</span><span class="p">)</span>
    <span class="n">ct2</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">ct2</span><span class="o">.</span><span class="n">unpack</span><span class="p">())</span>
    <span class="k">assert</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ct2_hold</span><span class="p">))</span> <span class="o">==</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ct2</span><span class="p">)),</span>\
        <span class="s2">&quot;Error - Packing and Unpacking has failed&quot;</span>

    <span class="c1"># Comparison is done only by index.  Thus, these should still equate!</span>
    <span class="n">ct2</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="mf">1000.0</span>
    <span class="k">assert</span> <span class="n">ct2_hold</span> <span class="o">==</span> <span class="n">ct2</span><span class="p">,</span> <span class="s2">&quot;Error - Unable to compare atoms in Tersoff&quot;</span>
    <span class="c1"># And these should not equate</span>
    <span class="n">ct2</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;32113&quot;</span><span class="p">,</span> <span class="s2">&quot;sldjkf&quot;</span><span class="p">,</span> <span class="s2">&quot;sldjkf&quot;</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">ct2_hold</span> <span class="o">!=</span> <span class="n">ct2</span><span class="p">,</span> <span class="s2">&quot;Error - Unable to compare atoms in Tersoff&quot;</span>

    <span class="c1"># Should unpack as follows</span>
    <span class="n">ct2</span><span class="o">.</span><span class="n">skip_m</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">ct2</span><span class="o">.</span><span class="n">skip_gamma</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">ct2</span><span class="o">.</span><span class="n">skip_beta</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">should_be</span> <span class="o">=</span> <span class="p">[</span><span class="n">ct2</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span> <span class="n">ct2</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="n">ct2</span><span class="o">.</span><span class="n">gamma</span><span class="p">,</span> <span class="n">ct2</span><span class="o">.</span><span class="n">lambda3</span><span class="p">,</span> <span class="n">ct2</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="n">ct2</span><span class="o">.</span><span class="n">d</span><span class="p">,</span>
                 <span class="n">ct2</span><span class="o">.</span><span class="n">costheta0</span><span class="p">,</span> <span class="n">ct2</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">ct2</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="n">ct2</span><span class="o">.</span><span class="n">lambda2</span><span class="p">,</span> <span class="n">ct2</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">ct2</span><span class="o">.</span><span class="n">R</span><span class="p">,</span>
                 <span class="n">ct2</span><span class="o">.</span><span class="n">D</span><span class="p">,</span> <span class="n">ct2</span><span class="o">.</span><span class="n">lambda1</span><span class="p">,</span> <span class="n">ct2</span><span class="o">.</span><span class="n">A</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span> <span class="o">==</span> <span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ct2</span><span class="o">.</span><span class="n">unpack</span><span class="p">(),</span> <span class="n">should_be</span><span class="p">)]),</span>\
        <span class="s2">&quot;Error - Unpack is not correct!&quot;</span>

    <span class="c1"># Test parsing of a line</span>
    <span class="n">ct3</span> <span class="o">=</span> <span class="n">Tersoff</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;1 1 1      3   1.0000   1.2000   10000.0000   20.0000   -0.2000</span>
<span class="s1">        0.9000   0.9200   4.9000   3000.0000   3.0000   0.5000   1.1000   100000.0000&#39;&#39;&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">ct3</span><span class="o">.</span><span class="n">indices</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">],</span>\
        <span class="s2">&quot;Error - Unable to parse indices from line.&quot;</span>
    <span class="k">assert</span> <span class="n">ct3</span><span class="o">.</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Error - Unable to parse m from line.&quot;</span>
    <span class="k">assert</span> <span class="n">ct3</span><span class="o">.</span><span class="n">gamma</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Error - Unable to parse gamma from line.&quot;</span>
    <span class="k">assert</span> <span class="n">ct3</span><span class="o">.</span><span class="n">lambda3</span> <span class="o">==</span> <span class="mf">1.2</span><span class="p">,</span> <span class="s2">&quot;Error - Unable to parse lambda3 from line.&quot;</span>
    <span class="k">assert</span> <span class="n">ct3</span><span class="o">.</span><span class="n">c</span> <span class="o">==</span> <span class="mi">10000</span><span class="p">,</span> <span class="s2">&quot;Error - Unable to parse c from line.&quot;</span>
    <span class="k">assert</span> <span class="n">ct3</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;Error - Unable to parse d from line.&quot;</span>
    <span class="k">assert</span> <span class="n">ct3</span><span class="o">.</span><span class="n">costheta0</span> <span class="o">==</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span>\
        <span class="s2">&quot;Error - Unable to parse costheta0 from line.&quot;</span>
    <span class="k">assert</span> <span class="n">ct3</span><span class="o">.</span><span class="n">n</span> <span class="o">==</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s2">&quot;Error - Unable to parse n from line.&quot;</span>
    <span class="k">assert</span> <span class="n">ct3</span><span class="o">.</span><span class="n">beta</span> <span class="o">==</span> <span class="mf">0.92</span><span class="p">,</span> <span class="s2">&quot;Error - Unable to parse beta from line.&quot;</span>
    <span class="k">assert</span> <span class="n">ct3</span><span class="o">.</span><span class="n">lambda2</span> <span class="o">==</span> <span class="mf">4.9</span><span class="p">,</span> <span class="s2">&quot;Error - Unable to parse lambda2 from line.&quot;</span>
    <span class="k">assert</span> <span class="n">ct3</span><span class="o">.</span><span class="n">B</span> <span class="o">==</span> <span class="mf">3000.0</span><span class="p">,</span> <span class="s2">&quot;Error - Unable to parse B from line.&quot;</span>
    <span class="k">assert</span> <span class="n">ct3</span><span class="o">.</span><span class="n">R</span> <span class="o">==</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s2">&quot;Error - Unable to parse R from line.&quot;</span>
    <span class="k">assert</span> <span class="n">ct3</span><span class="o">.</span><span class="n">D</span> <span class="o">==</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;Error - Unable to parse D from line.&quot;</span>
    <span class="k">assert</span> <span class="n">ct3</span><span class="o">.</span><span class="n">lambda1</span> <span class="o">==</span> <span class="mf">1.1</span><span class="p">,</span> <span class="s2">&quot;Error - Unable to parse lambda1 from line.&quot;</span>
    <span class="k">assert</span> <span class="n">ct3</span><span class="o">.</span><span class="n">A</span> <span class="o">==</span> <span class="mi">100000</span><span class="p">,</span> <span class="s2">&quot;Error - Unable to parse A from line.&quot;</span>

    <span class="c1"># Test packing and unpacking more robustly</span>
    <span class="c1"># By default, if we have original, we do not need to unpack m and gamma!</span>
    <span class="n">ct1</span> <span class="o">=</span> <span class="n">Tersoff</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;1 1 1      3   1.0000   1.2000   10000.0000   20.0000   -0.2000</span>
<span class="s1">        0.9000   0.9200   4.9000   3000.0000   3.0000   0.5000   1.1000   100000.0000&#39;&#39;&#39;</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">ct1</span><span class="o">.</span><span class="n">unpack</span><span class="p">()</span>
    <span class="n">values_stored</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">],</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">10000.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">,</span>
        <span class="mf">4.9</span><span class="p">,</span> <span class="mf">3000.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">100000.0</span>
    <span class="p">]</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">v1</span> <span class="o">==</span> <span class="n">v2</span> <span class="k">for</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">values_stored</span><span class="p">)]),</span>\
        <span class="s2">&quot;Error - Unable to unpack original correctly.&quot;</span>

    <span class="c1"># Should be able to pack with indices, skipping m and beta</span>
    <span class="c1"># (as it is original tersoff)</span>
    <span class="n">new_values_1</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">],</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">10000.1</span><span class="p">,</span> <span class="mf">20.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">,</span>
        <span class="mf">4.8</span><span class="p">,</span> <span class="mf">3000.1</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">100001.0</span>
    <span class="p">]</span>
    <span class="n">ct1</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">new_values_1</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">ct1</span><span class="o">.</span><span class="n">unpack</span><span class="p">()</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">v1</span> <span class="o">==</span> <span class="n">v2</span> <span class="k">for</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">new_values_1</span><span class="p">)]),</span>\
        <span class="s2">&quot;Error - Unable to pack original correctly with indices.&quot;</span>

    <span class="c1"># Should be able to pack without indices, skipping m and beta</span>
    <span class="c1"># (as it is original tersoff)</span>
    <span class="n">new_values_1</span> <span class="o">=</span> <span class="p">[</span>
        <span class="mf">1.2</span><span class="p">,</span> <span class="mf">10000.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">,</span>
        <span class="mf">4.9</span><span class="p">,</span> <span class="mf">3000.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">100000.0</span>
    <span class="p">]</span>
    <span class="n">ct1</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">new_values_1</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">ct1</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">with_indices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">v1</span> <span class="o">==</span> <span class="n">v2</span> <span class="k">for</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">new_values_1</span><span class="p">)]),</span>\
        <span class="s2">&quot;Error - Unable to pack original correctly without indices.&quot;</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">run_unit_tests</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../squid.html">Squid</a></li>
<li class="toctree-l1"><a class="reference internal" href="../updating.html">UPDATING TO v2.0.0</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Squid 2.0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Henry Herbol.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>