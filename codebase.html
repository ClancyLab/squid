
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Codebase &#8212; Squid 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="Squid" href="squid.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="squid.html" title="Squid"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Squid 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="codebase">
<h1>Codebase<a class="headerlink" href="#codebase" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-aneb">
<span id="aneb"></span><h2>aneb<a class="headerlink" href="#module-aneb" title="Permalink to this headline">¶</a></h2>
<p>The Auto ANEB module simplifies the submission of Auto Nudged Elastic Band simulations.</p>
<p>NOTE! This module is still in a very rough beta.  It has been hacked together from the
NEB module and is being tested.  Do not use this expecting a miracle.</p>
<p>The following code has been tested out to some moderate success for now:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">new_opt_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;step_size&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                  <span class="s1">&#39;step_size_adjustment&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                  <span class="s1">&#39;max_step&#39;</span><span class="p">:</span> <span class="mf">0.04</span><span class="p">,</span>
                  <span class="s1">&#39;maxiter&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                  <span class="s1">&#39;linesearch&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                  <span class="s1">&#39;accelerate&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
                  <span class="s1">&#39;N_reset_hess&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                  <span class="s1">&#39;max_steps_remembered&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                  <span class="s1">&#39;fit_rigid&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                  <span class="s1">&#39;g_rms&#39;</span><span class="p">:</span> <span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;eV/Ang&quot;</span><span class="p">,</span> <span class="s2">&quot;Ha/Ang&quot;</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">),</span>
                  <span class="s1">&#39;g_max&#39;</span><span class="p">:</span> <span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;eV/Ang&quot;</span><span class="p">,</span> <span class="s2">&quot;Ha/Ang&quot;</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">)}</span>

<span class="n">new_auto_opt_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;step_size&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                       <span class="s1">&#39;step_size_adjustment&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                       <span class="s1">&#39;max_step&#39;</span><span class="p">:</span> <span class="mf">0.04</span><span class="p">,</span>
                       <span class="s1">&#39;maxiter&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                       <span class="s1">&#39;linesearch&#39;</span><span class="p">:</span> <span class="s1">&#39;backtrack&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;accelerate&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                       <span class="s1">&#39;reset_step_size&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                       <span class="s1">&#39;fit_rigid&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                       <span class="s1">&#39;g_rms&#39;</span><span class="p">:</span> <span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;eV/Ang&quot;</span><span class="p">,</span> <span class="s2">&quot;Ha/Ang&quot;</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span>
                       <span class="s1">&#39;g_max&#39;</span><span class="p">:</span> <span class="n">units</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;eV/Ang&quot;</span><span class="p">,</span> <span class="s2">&quot;Ha/Ang&quot;</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">)}</span>


<span class="n">nebs</span> <span class="o">=</span> <span class="n">aneb</span><span class="o">.</span><span class="n">ANEB</span><span class="p">(</span><span class="s2">&quot;debug_auto&quot;</span><span class="p">,</span> <span class="n">frames</span><span class="p">,</span> <span class="s2">&quot;!HF-3c&quot;</span><span class="p">,</span> <span class="n">fit_rigid</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                 <span class="n">opt</span><span class="o">=</span><span class="s1">&#39;LBFGS&#39;</span><span class="p">,</span>
                 <span class="n">new_opt_params</span><span class="o">=</span><span class="n">new_opt_params</span><span class="p">,</span>
                 <span class="n">new_auto_opt_params</span><span class="o">=</span><span class="n">new_auto_opt_params</span><span class="p">,</span>
                 <span class="n">ci_N</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                 <span class="n">ANEB_Nsim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                 <span class="n">ANEB_Nmax</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><a class="reference internal" href="#aneb.g09_start_job" title="aneb.g09_start_job"><code class="xref py py-func docutils literal notranslate"><span class="pre">g09_start_job()</span></code></a></li>
<li><a class="reference internal" href="#aneb.g09_results" title="aneb.g09_results"><code class="xref py py-func docutils literal notranslate"><span class="pre">g09_results()</span></code></a></li>
<li><a class="reference internal" href="#aneb.orca_start_job" title="aneb.orca_start_job"><code class="xref py py-func docutils literal notranslate"><span class="pre">orca_start_job()</span></code></a></li>
<li><a class="reference internal" href="#aneb.orca_results" title="aneb.orca_results"><code class="xref py py-func docutils literal notranslate"><span class="pre">orca_results()</span></code></a></li>
<li><a class="reference internal" href="#aneb.ANEB" title="aneb.ANEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANEB</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="class">
<dt id="aneb.ANEB">
<em class="property">class </em><code class="descclassname">aneb.</code><code class="descname">ANEB</code><span class="sig-paren">(</span><em>name</em>, <em>states</em>, <em>theory</em>, <em>extra_section=''</em>, <em>initial_guess=None</em>, <em>spring_atoms=None</em>, <em>procs=1</em>, <em>queue=None</em>, <em>mem=2000</em>, <em>priority=None</em>, <em>disp=0</em>, <em>k=0.00367453</em>, <em>charge=0</em>, <em>fit_rigid=True</em>, <em>DFT='orca'</em>, <em>opt='LBFGS'</em>, <em>start_job=None</em>, <em>get_results=None</em>, <em>new_opt_params={}</em>, <em>new_auto_opt_params={}</em>, <em>callback=None</em>, <em>ci_ANEB=False</em>, <em>ci_N=5</em>, <em>ANEB_Nsim=5</em>, <em>ANEB_Nmax=15</em>, <em>add_by_energy=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aneb.html#ANEB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aneb.ANEB" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for determining the minimum energy pathway of a reaction using
DFT. Note, this method was written for atomic orbital DFT codes; however,
is potentially generalizable to other programs.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>The name of the ANEB simulation to be run.</dd>
<dt>states: <em>list, list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of frames, each frame being a list of atom structures.
These frames represent your reaction coordinate.</dd>
<dt>theory: <em>str</em></dt>
<dd>The route line for your DFT simulation.</dd>
<dt>extra_section: <em>str, optional</em></dt>
<dd>Additional parameters for your DFT simulation.</dd>
<dt>initial_guess: <em>list, str, optional</em></dt>
<dd>TODO - List of strings specifying a previously run ANEB simulation,
allowing restart capabilities.</dd>
<dt>spring_atoms: <em>list, int, optional</em></dt>
<dd>Specify which atoms will be represented by virutal springs in the
ANEB calculations. Default includes all.</dd>
<dt>procs: <em>int, optional</em></dt>
<dd>The number of processors for your simulation.</dd>
<dt>queue: <em>str, optional</em></dt>
<dd>Which queue you wish your simulation to run on (queueing system
dependent). When None, ANEB is run locally.</dd>
<dt>mem: <em>float, optional</em></dt>
<dd>Specify memory constraints (specific to your X_start_job method).</dd>
<dt>priority: <em>int, optional</em></dt>
<dd>Whether to submit a DFT simulation with some given priority or not.</dd>
<dt>disp: <em>int, optional</em></dt>
<dd>Specify for additional stdout information.</dd>
<dt>charge: <em>int</em></dt>
<dd>Charge of the system.</dd>
<dt>k: <em>float, optional</em></dt>
<dd>The spring constant for your ANEB simulation.</dd>
<dt>fit_rigid: <em>bool, optional</em></dt>
<dd>Whether you want to use procrustes to minimize motion between
adjacent frames (thus minimizing error due to excessive virtal
spring forces).</dd>
<dt>DFT: <em>str, optional</em></dt>
<dd>Specify if you wish to use the default X_start_job and X_results
functions where X is either g09 or orca.</dd>
<dt>opt: <em>str, optional</em></dt>
<dd>Select which optimization method you wish to use from the
following: LBFGS.</dd>
<dt>start_job: <em>func, optional</em></dt>
<dd>A function specifying how to submit your ANEB single point
calculations.  Needed if DFT is neither orca nor g09.</dd>
<dt>get_results: <em>func, optional</em></dt>
<dd>A function specifying how to read your ANEB single point
calculations.  Needed if DFT is neither orca nor g09.</dd>
<dt>new_opt_params: <em>dict, optional</em></dt>
<dd>Pass any additional parameters to the optimization algorithm.
Note, these parameters are for the final calculation after frames
have been added in.</dd>
<dt>new_auto_opt_params: <em>dict, optional</em></dt>
<dd>Pass any additional parameters to the optimization algorithm.
Note, these parameters are for the iterative calculations, as
frames are being added to the band.</dd>
<dt>callback: <em>func, optional</em></dt>
<dd>A function to be run after each each to calculate().</dd>
<dt>ci_ANEB: <em>bool, optional</em></dt>
<dd>Whether to use the climbing image variation of ANEB.</dd>
<dt>ci_N: <em>int, optional</em></dt>
<dd>How many iterations to wait in climbing image ANEB before selecting
which image to be used.</dd>
<dt>ANEB_Nsim: <em>int, optional</em></dt>
<dd>The number of frames for an auto ANEB calculation. If an even
number is chosen, the expansion happens around floor(ANEB_Nsim/2).</dd>
<dt>ANEB_Nmax: <em>int, optional</em></dt>
<dd>The maximum number of frames to build up to in the auto ANEB.</dd>
<dt>add_by_energy: <em>bool, optional</em></dt>
<dd>If the user wants to add frames by the largest dE instead of dR
(motion per frame), then set this flag to True.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>This <a class="reference internal" href="#aneb.ANEB" title="aneb.ANEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANEB</span></code></a> object.</div></blockquote>
<p><strong>References</strong></p>
<blockquote>
<div><ul class="simple">
<li>Henkelman, G.; Jonsson, H. The Journal of Chemical Physics 2000,
113, 9978-9985.</li>
<li>Jonsson, H.; Mills, G.; Jacobson, K. W. In Classical and Quantum
Dynamics in Condensed Phase Simulations;</li>
<li>Berne, B. J., Ciccotti, G., Coker, D. F., Eds.; World Scientific,
1998; Chapter 16, pp 385-404.</li>
<li>Armijo, L. Pacific Journal of Mathematics 1966, 16.</li>
<li>Sheppard, D.; Terrell, R.; Henkelman, G. The Journal of Chemical
Physics 2008, 128.</li>
<li>Henkelman, G.; Uberuaga, B. P.; Jonsson, H. Journal of Chemical
Physics 2000, 113.</li>
<li>Atomic Simulation Environment - <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/">https://wiki.fysik.dtu.dk/ase/</a></li>
<li>Kolsbjerg, E. L.; Groves, M. N.; Hammer, B. The Journal of 
Chemical Physics 2016, 145.</li>
</ul>
</div></blockquote>
<dl class="method">
<dt id="aneb.ANEB.align_coordinates">
<code class="descname">align_coordinates</code><span class="sig-paren">(</span><em>r</em>, <em>B=None</em>, <em>H=None</em>, <em>return_matrix=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aneb.html#ANEB.align_coordinates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aneb.ANEB.align_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a rotation matrix A that will remove rigid rotation from the
new coordinates r.  Further, if another vector needs rotating by the
same matrix A, it should be passed in B and will be rotated.  If
a matrix also needs rotating, it can be passed as H and also be
rotated.</p>
<p><em>Parameters</em></p>
<blockquote>
<div><dl class="docutils">
<dt>r: <em>list, float</em></dt>
<dd>1D array of atomic coordinates to be rotated by procrustes
matrix A.</dd>
<dt>B: <em>list, list, float, optional</em></dt>
<dd>A list of vectors that may also be rotated by the same matrix
as <em>r</em>.</dd>
<dt>H: <em>list, list, float, optional</em></dt>
<dd><dl class="first last docutils">
<dt>A matrix that should also be rotated via:</dt>
<dd>H = R * H * R.T</dd>
</dl>
</dd>
<dt>return_matrix: <em>bool, optional</em></dt>
<dd>Whether to also return the rotation matrix used or not.</dd>
</dl>
</div></blockquote>
<p><em>Returns</em></p>
<blockquote>
<div><dl class="docutils">
<dt>rotations: <em>dict</em></dt>
<dd>A dictionary holding ‘A’, the rotation matrix, ‘r’, the
rotated new coordinates, ‘B’, a list of all other vectors that
were rotated, and ‘H’, a rotated matrix.</dd>
</dl>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="aneb.g09_results">
<code class="descclassname">aneb.</code><code class="descname">g09_results</code><span class="sig-paren">(</span><em>ANEB</em>, <em>step_to_use</em>, <em>i</em>, <em>state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aneb.html#g09_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aneb.g09_results" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for reading in the output of Gaussian09 single point calculations
for ANEB calculations. This will both (a) assign forces to the atoms stored
in state and (b) return the energy and atoms.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>ANEB: <a class="reference internal" href="#aneb.ANEB" title="aneb.ANEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANEB</span></code></a></dt>
<dd>An ANEB container holding the main ANEB simulation</dd>
<dt>step_to_use: <em>int</em></dt>
<dd>Which iteration in the ANEB sequence the output to be read in is on.</dd>
<dt>i: <em>int</em></dt>
<dd>The index corresponding to which image on the frame is to be
simulated.</dd>
<dt>state: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms describing the image on the frame associated with
index <em>i</em>.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>new_energy: <em>float</em></dt>
<dd>The energy of the system in Hartree (Ha).</dd>
<dt>new_atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms with the forces attached in units of Hartree per
Angstrom (Ha/Ang).</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="aneb.g09_start_job">
<code class="descclassname">aneb.</code><code class="descname">g09_start_job</code><span class="sig-paren">(</span><em>ANEB</em>, <em>i</em>, <em>state</em>, <em>charge</em>, <em>procs</em>, <em>queue</em>, <em>initial_guess</em>, <em>extra_section</em>, <em>mem</em>, <em>priority</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aneb.html#g09_start_job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aneb.g09_start_job" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for submitting a single point calculation using Gaussian09 for
ANEB calculations.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>ANEB: <a class="reference internal" href="#aneb.ANEB" title="aneb.ANEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANEB</span></code></a></dt>
<dd>An ANEB container holding the main ANEB simulation</dd>
<dt>i: <em>int</em></dt>
<dd>The index corresponding to which image on the frame is to be
simulated.</dd>
<dt>state: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms describing the image on the frame associated
with index <em>i</em>.</dd>
<dt>charge: <em>int</em></dt>
<dd>Charge of the system.</dd>
<dt>procs: <em>int</em></dt>
<dd>The number of processors to use during calculations.</dd>
<dt>queue: <em>str</em></dt>
<dd>Which queue to submit the simulation to (this is queueing system
dependent).</dd>
<dt>initial_guess: <em>str</em></dt>
<dd>The name of a previous simulation for which we can read in a
hessian.</dd>
<dt>extra_section: <em>str</em></dt>
<dd>Extra settings for this DFT method.</dd>
<dt>mem: <em>int</em></dt>
<dd>How many Mega Words (MW) you wish to have as dynamic memory.</dd>
<dt>priority: <em>int</em></dt>
<dd>Whether to submit the job with a given priority (NBS). Not setup for
this function yet.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>g09_job: <a class="reference internal" href="#jobs.Job" title="jobs.Job"><code class="xref py py-class docutils literal notranslate"><span class="pre">jobs.Job</span></code></a></dt>
<dd>A job container holding the g09 simulation.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="aneb.orca_results">
<code class="descclassname">aneb.</code><code class="descname">orca_results</code><span class="sig-paren">(</span><em>ANEB</em>, <em>step_to_use</em>, <em>i</em>, <em>state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aneb.html#orca_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aneb.orca_results" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for reading in the output of Orca single point calculations for
ANEB calculations. This will both (a) assign forces to the atoms stored
in state and (b) return the energy and atoms.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>ANEB: <a class="reference internal" href="#aneb.ANEB" title="aneb.ANEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANEB</span></code></a></dt>
<dd>An ANEB container holding the main ANEB simulation</dd>
<dt>step_to_use: <em>int</em></dt>
<dd>Which iteration in the ANEB sequence the output to be read in is on.</dd>
<dt>i: <em>int</em></dt>
<dd>The index corresponding to which image on the frame is to be
simulated.</dd>
<dt>state: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms describing the image on the frame associated with
index <em>i</em>.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>new_energy: <em>float</em></dt>
<dd>The energy of the system in Hartree (Ha).</dd>
<dt>new_atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms with the forces attached in units of Hartree per
Angstrom (Ha/Ang).</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="aneb.orca_start_job">
<code class="descclassname">aneb.</code><code class="descname">orca_start_job</code><span class="sig-paren">(</span><em>ANEB</em>, <em>i</em>, <em>state</em>, <em>charge</em>, <em>procs</em>, <em>queue</em>, <em>initial_guess</em>, <em>extra_section</em>, <em>mem</em>, <em>priority</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aneb.html#orca_start_job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aneb.orca_start_job" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for submitting a single point calculation using Orca for ANEB
calculations.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>ANEB: <a class="reference internal" href="#aneb.ANEB" title="aneb.ANEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANEB</span></code></a></dt>
<dd>An ANEB container holding the main ANEB simulation</dd>
<dt>i: <em>int</em></dt>
<dd>The index corresponding to which image on the frame is to be
simulated.</dd>
<dt>state: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms describing the image on the frame associated with
index <em>i</em>.</dd>
<dt>charge: <em>int</em></dt>
<dd>Charge of the system.</dd>
<dt>procs: <em>int</em></dt>
<dd>The number of processors to use during calculations.</dd>
<dt>queue: <em>str</em></dt>
<dd>Which queue to submit the simulation to (this is queueing system
dependent).</dd>
<dt>initial_guess: <em>str</em></dt>
<dd>The name of a previous simulation for which we can read in a
hessian.</dd>
<dt>extra_section: <em>str</em></dt>
<dd>Extra settings for this DFT method.</dd>
<dt>mem: <em>int</em></dt>
<dd>How many MegaBytes (MB) of memory you have available per core.</dd>
<dt>priority: <em>int</em></dt>
<dd>Whether to submit to NBS with a given priority</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>orca_job: <a class="reference internal" href="#jobs.Job" title="jobs.Job"><code class="xref py py-class docutils literal notranslate"><span class="pre">jobs.Job</span></code></a></dt>
<dd>A job container holding the orca simulation.</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-constants">
<span id="constants"></span><h2>constants<a class="headerlink" href="#module-constants" title="Permalink to this headline">¶</a></h2>
<p>Constants useful for calculations</p>
<dl class="docutils">
<dt>ENERGY: <em>dict</em></dt>
<dd>Various units of energy in terms of Joules.
Includes: ‘Ha’, ‘eV’, ‘J’, ‘kcal’, ‘kcal/mol’, ‘kJ/mol’, ‘kT_300’, ‘Ry’</dd>
<dt>PRESSURE: <em>dict</em></dt>
<dd>Various units of pressure in terms of atmospheres.
Includes: ‘atm’, ‘bar’, ‘Pa’, ‘GPa’</dd>
<dt>DISTANCE: <em>dict</em></dt>
<dd>Various units of idstance in terms of Angstroms.
Includes: ‘Bohr’, ‘Ang’, ‘Angstrom’</dd>
<dt>K_b: <em>float</em></dt>
<dd>Boltzmann’s Constant in Joules</dd>
<dt>h: <em>float</em></dt>
<dd>Plank’s Constant in J*s</dd>
<dt>hbar: <em>float</em></dt>
<dd>Reduced Plank’s Constant in J*s</dd>
<dt>amu: <em>float</em></dt>
<dd>Atomic mass unit in Kg</dd>
<dt>c: <em>float</em></dt>
<dd>Speed of light in m/s</dd>
<dt>Na: <em>float</em></dt>
<dd>Avogadro’s Number in mol^-1</dd>
<dt>pi = PI = Pi: <em>float</em></dt>
<dd>The constant pi (3.141592…).</dd>
<dt>PERIODIC_TABLE: <em>list, dict</em></dt>
<dd><p class="first">A list of dictionaries holding information pertaining to each element.
Note, PERIODIC_TABLE[0] is a list of entries for each element’s dictionary.
This dictionary has not been fully verified, but gives appropriate values
for rough calculations as needed (although weight should be correct for
all elements). Contains the following:</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>atomic_num: <em>int</em></dt>
<dd>The element’s atomic number (equivalent to the index
in <cite>PERIODIC_TABLE</cite>).</dd>
<dt>weight: <em>float</em></dt>
<dd>The weight of the element in Atomic Mass Units.</dd>
<dt>name: <em>str</em></dt>
<dd>The name of the element (such as Hydrogen).</dd>
<dt>sym: <em>str</em></dt>
<dd>The symbolic name of the element (such as ‘H’ for Hydrogen).</dd>
<dt>mp: <em>float</em></dt>
<dd>The melting point of the element in Celsius.</dd>
<dt>bp: <em>float</em></dt>
<dd>The boiling point of the element in Celsius.</dd>
<dt>density: <em>float</em></dt>
<dd>The density of the element in g/cm^3.</dd>
<dt>group: <em>int</em></dt>
<dd>Which column of the periodic table the element resides in.</dd>
<dt>econfig: <em>list, str</em></dt>
<dd>The electronic configuration of the element
(such as [‘[Ne]’, ‘3s2’, ‘3p5’] for Chlorine).</dd>
<dt>ionization: <em>float</em></dt>
<dd>The ionization energy in eV for the element.</dd>
<dt>vdw_r: <em>float</em></dt>
<dd>The van der waals radius of the element.</dd>
</dl>
</div></blockquote>
</dd>
<dt>COLOUR = COLOR: <em>dict</em></dt>
<dd><p class="first">A list of escape sequences for terminal output colouring on linux.
Contains the following:</p>
<blockquote class="last">
<div>“BLUE”, “GREEN”, “YELLOW”, “RED”, “BOLD”, “UNDERLINE”, and “ENDC”.</div></blockquote>
</dd>
</dl>
</div>
<hr class="docutils" />
<div class="section" id="module-debyer">
<span id="debyer"></span><h2>debyer<a class="headerlink" href="#module-debyer" title="Permalink to this headline">¶</a></h2>
<p>Python hooks for the debyer code.
Link: <a class="reference external" href="https://debyer.readthedocs.io/en/latest/">https://debyer.readthedocs.io/en/latest/</a></p>
<ul class="simple">
<li><a class="reference internal" href="#debyer.get_pdf" title="debyer.get_pdf"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_pdf()</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="function">
<dt id="debyer.get_pdf">
<code class="descclassname">debyer.</code><code class="descname">get_pdf</code><span class="sig-paren">(</span><em>frames</em>, <em>start=0.0</em>, <em>stop=5.0</em>, <em>step=0.1</em>, <em>cutoff=10.0</em>, <em>rho=1.0</em>, <em>quanta=0.001</em>, <em>output=None</em>, <em>persist=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/debyer.html#get_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#debyer.get_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the pair distribution function of a list of atoms using the Debyer code.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>str or list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>An xyz file name (with or without the .xyz extension) or an input frame to calculate the pdf for.</dd>
<dt>start: <em>float, optional</em></dt>
<dd>The starting radial distance in Angstroms for the calculated pattern.</dd>
<dt>stop: <em>float, optional</em></dt>
<dd>The ending radial distance in Angstroms for the calculated pattern.</dd>
<dt>step: <em>float, optional</em></dt>
<dd>Step in Angstroms for the calculated pattern.</dd>
<dt>cutoff: <em>float, optional</em></dt>
<dd>Cutoff distance in Angstroms for Interatomic Distance (ID) calculations.</dd>
<dt>rho: <em>float, optional</em></dt>
<dd>Numeric density of the system.</dd>
<dt>quanta: <em>float, optional</em></dt>
<dd>Interatomic Distance (ID) discritization quanta.</dd>
<dt>output: <em>str, optional</em></dt>
<dd>Output file name with NO extension given</dd>
<dt>persist: <em>bool, optional</em></dt>
<dd>Whether to persist made .g and .xyz files (True), or remove them (False)</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>pdf: <em>list, tuple, float</em></dt>
<dd>A list of tuples holding the pdf data (distance in Angstroms and Intensity).</dd>
</dl>
</div></blockquote>
<p><strong>References</strong></p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://debyer.readthedocs.io/en/latest/">https://debyer.readthedocs.io/en/latest/</a></li>
</ul>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-doe_lhs">
<span id="doe-lhs"></span><h2>doe_lhs<a class="headerlink" href="#module-doe_lhs" title="Permalink to this headline">¶</a></h2>
<p>The doe_lhs module contains code for generating random samples via the latin
hypercube sampling method.  The below code was developed by scilab and 
Abraham Lee.</p>
<hr class="docutils" />
<p>This code was originally published by the following individuals for use with
Scilab:</p>
<blockquote>
<div><ul class="simple">
<li>Copyright (C) 2012 - 2013 - Michael Baudin</li>
<li>Copyright (C) 2012 - Maria Christopoulou</li>
<li>Copyright (C) 2010 - 2011 - INRIA - Michael Baudin</li>
<li>Copyright (C) 2009 - Yann Collette</li>
<li>Copyright (C) 2009 - CEA - Jean-Marc Martinez</li>
</ul>
<p>website: forge.scilab.org/index.php/p/scidoe/sourcetree/master/macros</p>
</div></blockquote>
<p>Much thanks goes to these individuals. It has been converted to Python by 
Abraham Lee.</p>
<hr class="docutils" />
<ul class="simple">
<li><a class="reference internal" href="#doe_lhs.lhs" title="doe_lhs.lhs"><code class="xref py py-func docutils literal notranslate"><span class="pre">lhs()</span></code></a></li>
</ul>
<dl class="function">
<dt id="doe_lhs.lhs">
<code class="descclassname">doe_lhs.</code><code class="descname">lhs</code><span class="sig-paren">(</span><em>n</em>, <em>samples=None</em>, <em>criterion=None</em>, <em>iterations=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/doe_lhs.html#lhs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#doe_lhs.lhs" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a latin-hypercube design</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>n: <em>int</em></dt>
<dd>The number of factors to generate samples for</dd>
<dt>samples: <em>int, optional</em></dt>
<dd>The number of samples to generate for each factor (Default: n)</dd>
<dt>criterion: <em>str, optional</em></dt>
<dd>Allowable values are “center” or “c”, “maximin” or “m”, 
“centermaximin” or “cm”, and “correlation” or “corr”. If no value 
given, the design is simply randomized.</dd>
<dt>iterations: <em>int, optional</em></dt>
<dd>The number of iterations in the maximin and correlations algorithms
(Default: 5).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>H: <em>2d-array</em></dt>
<dd>An n-by-samples design matrix that has been normalized so factor values
are uniformly spaced between zero and one.</dd>
</dl>
</div></blockquote>
<p><strong>Example</strong></p>
<blockquote>
<div><p>A 3-factor design (defaults to 3 samples):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lhs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">array([[ 0.40069325,  0.08118402,  0.69763298],</span>
<span class="go">           [ 0.19524568,  0.41383587,  0.29947106],</span>
<span class="go">           [ 0.85341601,  0.75460699,  0.360024  ]])</span>
</pre></div>
</div>
<p>A 4-factor design with 6 samples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lhs</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="go">array([[ 0.27226812,  0.02811327,  0.62792445,  0.91988196],</span>
<span class="go">           [ 0.76945538,  0.43501682,  0.01107457,  0.09583358],</span>
<span class="go">           [ 0.45702981,  0.76073773,  0.90245401,  0.18773015],</span>
<span class="go">           [ 0.99342115,  0.85814198,  0.16996665,  0.65069309],</span>
<span class="go">           [ 0.63092013,  0.22148567,  0.33616859,  0.36332478],</span>
<span class="go">           [ 0.05276917,  0.5819198 ,  0.67194243,  0.78703262]])</span>
</pre></div>
</div>
<p>A 2-factor design with 5 centered samples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lhs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="go">array([[ 0.3,  0.5],</span>
<span class="go">           [ 0.7,  0.9],</span>
<span class="go">           [ 0.1,  0.3],</span>
<span class="go">           [ 0.9,  0.1],</span>
<span class="go">           [ 0.5,  0.7]])</span>
</pre></div>
</div>
<p>A 3-factor design with 4 samples where the minimum distance between
all samples has been maximized:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lhs</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;maximin&#39;</span><span class="p">)</span>
<span class="go">array([[ 0.02642564,  0.55576963,  0.50261649],</span>
<span class="go">           [ 0.51606589,  0.88933259,  0.34040838],</span>
<span class="go">           [ 0.98431735,  0.0380364 ,  0.01621717],</span>
<span class="go">           [ 0.40414671,  0.33339132,  0.84845707]])</span>
</pre></div>
</div>
<p>A 4-factor design with 5 samples where the samples are as uncorrelated
as possible (within 10 iterations):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lhs</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;correlate&#39;</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-files">
<span id="files"></span><h2>files<a class="headerlink" href="#module-files" title="Permalink to this headline">¶</a></h2>
<p>The files module contains various functions aiding in file input and output.</p>
<ul class="simple">
<li><a class="reference internal" href="#files.read_cml" title="files.read_cml"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_cml()</span></code></a></li>
<li><a class="reference internal" href="#files.write_cml" title="files.write_cml"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_cml()</span></code></a></li>
<li><a class="reference internal" href="#files.read_xyz" title="files.read_xyz"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_xyz()</span></code></a></li>
<li><a class="reference internal" href="#files.write_xyz" title="files.write_xyz"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_xyz()</span></code></a></li>
<li><a class="reference internal" href="#files.read_lammpstrj" title="files.read_lammpstrj"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_lammpstrj()</span></code></a></li>
<li><code class="xref py py-func docutils literal notranslate"><span class="pre">write_lammpstrj()</span></code></li>
<li><a class="reference internal" href="#files.read_lammps_data" title="files.read_lammps_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_lammps_data()</span></code></a></li>
<li><a class="reference internal" href="#files.write_lammps_data" title="files.write_lammps_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_lammps_data()</span></code></a></li>
<li><a class="reference internal" href="#files.last_modified" title="files.last_modified"><code class="xref py py-func docutils literal notranslate"><span class="pre">last_modified()</span></code></a></li>
<li><a class="reference internal" href="#files.which" title="files.which"><code class="xref py py-func docutils literal notranslate"><span class="pre">which()</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="function">
<dt id="files.last_modified">
<code class="descclassname">files.</code><code class="descname">last_modified</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/files.html#last_modified"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#files.last_modified" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine when a file was last modified in seconds.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>Name of the file.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>time: <em>datetime.datetime</em></dt>
<dd>The last time this file was modified in the standard python
datetime format.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="files.read_cml">
<code class="descclassname">files.</code><code class="descname">read_cml</code><span class="sig-paren">(</span><em>name, new_method=False, extra_opls_parameters={}, parameter_files=[('OPLS', '/mnt/c/Users/hherb/Documents/subsystem/squid/forcefield_parameters/oplsaa.prm')], parameter_file='/mnt/c/Users/hherb/Documents/subsystem/squid/forcefield_parameters/oplsaa.prm', extra_parameters={}, test_charges=False, allow_errors=True, pair_style='lj/cut', default_angles=None, return_molecules=False, test_consistency=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/files.html#read_cml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#files.read_cml" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in a file written in the Chemical Markup Language (CML) format.
It should be mentioned that when reading a file with multiple molecules,
if you do not specify return_molecules=True, then everything will be
combined into one list.</p>
<dl class="docutils">
<dt>Note - When using the new_method, the following keywords are ignored:</dt>
<dd>test_charges, allow_errors, pair_style, default_angles,
and test_consistency.</dd>
</dl>
<p>Further, a parameter object as well as the molecule objects are returned.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>File name.</dd>
<dt>new_method: <em>bool, optional</em></dt>
<dd>A boolean on whether to use the new method of parameter handling,
or the old one.  Note, the old one will be deprecated and no
longer maintained, and over time removed, so we recommend getting
used to this method instead.</dd>
<dt>parameter_files: <em>list, tuple, str, str, optional</em></dt>
<dd>A list of tuples, holding two strings: the force field type
(either OPLS or SMRFF right now), and the path to the
parameter file.  If no path is specified, we will try to grab
the one assigned in sysconst.</dd>
<dt>parameter_file: <em>str, optional</em></dt>
<dd>Path to the forcefield parameter file.</dd>
<dt>extra_parameters: <em>dict, optional</em></dt>
<dd>Additional OPLS parameters to apply to the forcefield.</dd>
<dt>test_charges: <em>bool, optional</em></dt>
<dd>Bypass inconsistencies in molecular charge (False) or throw errors
when inconsistencies exist (True).</dd>
<dt>allow_errors: <em>bool, optional</em></dt>
<dd>Permit constructions of ill-conditioned molecules, such as empty
bonds (True), or throw errors (False).</dd>
<dt>pair_style: <em>str, optional</em></dt>
<dd>Pair style to be used in the forcefield.</dd>
<dt>default_angles: <em>dict, optional</em></dt>
<dd>A default forcefield angle type to be set if angle types are set
to None.</dd>
<dt>return_molecules: <em>bool, optional</em></dt>
<dd>Whether to have the return be formated as a
<a class="reference internal" href="#structures.Molecule" title="structures.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Molecule</span></code></a> object or not.</dd>
<dt>test_consistency: <em>bool, optional</em></dt>
<dd>Whether to validate the input cml file against OPLS.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms read in from the CML file.</dd>
<dt>bonds: <em>list,</em> <a class="reference internal" href="#structures.Bond" title="structures.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Bond</span></code></a></dt>
<dd>A list of bonds read in from the CML file.</dd>
<dt>angles: <em>list,</em> <a class="reference internal" href="#structures.Angle" title="structures.Angle"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Angle</span></code></a></dt>
<dd>A list of angles read in from the CML file.</dd>
<dt>dihedrals: <em>list,</em> <a class="reference internal" href="#structures.Dihedral" title="structures.Dihedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Dihedral</span></code></a></dt>
<dd>A list of dihedrals read in from the CML file.</dd>
</dl>
<p>or</p>
<dl class="docutils">
<dt>molecules: <em>list,</em> <a class="reference internal" href="#structures.Molecule" title="structures.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Molecule</span></code></a></dt>
<dd>A list of molecules in read in from the CML file.</dd>
</dl>
<p>or</p>
<dl class="docutils">
<dt>parameters: <code class="xref py py-class docutils literal notranslate"><span class="pre">ff_params.Parameters</span></code></dt>
<dd>A parameter object holding all relevent data.</dd>
<dt>molecules: <em>list,</em> <a class="reference internal" href="#structures.Molecule" title="structures.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Molecule</span></code></a></dt>
<dd>A list of molecules in read in from the CML file.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="files.read_lammps_data">
<code class="descclassname">files.</code><code class="descname">read_lammps_data</code><span class="sig-paren">(</span><em>name</em>, <em>read_atoms=True</em>, <em>read_bonds=True</em>, <em>read_angles=True</em>, <em>read_dihedrals=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/files.html#read_lammps_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#files.read_lammps_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for read_lammpstrj to read in larger files.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>Name of the .lammpstrj file to be read in. NOTE, this file MUST
have the extension .lammpstrj.</dd>
<dt>read_atoms: <em>bool, optional</em></dt>
<dd>Whether to read in the atomic information (True), or not (False).</dd>
<dt>read_bonds: <em>bool, optional</em></dt>
<dd>Whether to read in the bond information (True), or not (False).</dd>
<dt>read_angles: <em>bool, optional</em></dt>
<dd>Whether to read in the angle information (True), or not (False).</dd>
<dt>read_dihedrals: <em>bool, optional</em></dt>
<dd>Whether to read in the dihedral information (True), or not
(False).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms read in from the data file.</dd>
<dt>bonds: <em>list,</em> <a class="reference internal" href="#structures.Bond" title="structures.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Bond</span></code></a></dt>
<dd>A list of bonds read in from the data file.</dd>
<dt>angles: <em>list,</em> <a class="reference internal" href="#structures.Angle" title="structures.Angle"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Angle</span></code></a></dt>
<dd>A list of angles read in from the data file.</dd>
<dt>dihedrals: <em>list,</em> <a class="reference internal" href="#structures.Dihedral" title="structures.Dihedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Dihedral</span></code></a></dt>
<dd>A list of dihedrals read in from the data file.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="files.read_lammpstrj">
<code class="descclassname">files.</code><code class="descname">read_lammpstrj</code><span class="sig-paren">(</span><em>name</em>, <em>read_atoms=True</em>, <em>read_timesteps=True</em>, <em>read_num_atoms=True</em>, <em>read_box_bounds=True</em>, <em>verbose=True</em>, <em>last_frame=False</em>, <em>big_file=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/files.html#read_lammpstrj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#files.read_lammpstrj" title="Permalink to this definition">¶</a></dt>
<dd><p>Imports the atom style dump file from lammps.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>Name of the .lammpstrj file to be read in. NOTE, this file MUST
have the extension .lammpstrj.</dd>
<dt>read_atoms: <em>bool, optional</em></dt>
<dd>Whether to read in the atomic information (True), or not (False).</dd>
<dt>read_timesteps: <em>bool, optional</em></dt>
<dd>Whether to read in the timesteps (True), or not (False).</dd>
<dt>read_num_atoms: <em>bool, optional</em></dt>
<dd>Whether to read in the number of atoms (True), or not (False).</dd>
<dt>read_box_bounds: <em>bool, optional</em></dt>
<dd>Whether to read in the system box boundaries (True), or not
(False).</dd>
<dt>verbose: <em>bool, optional</em></dt>
<dd>Whether to output more to stdout (True), or not (False).</dd>
<dt>last_frame: <em>bool, optional</em></dt>
<dd>Whether to output only the last iteration of the simulation
(True), or all of it (False).</dd>
<dt>big_file: <em>bool, optional</em></dt>
<dd>Whether to read through the file line-by-line to allow for reading
of large files (True), or not (False). If True, this read
operation will be slower.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>data: <a class="reference internal" href="#results.sim_out" title="results.sim_out"><code class="xref py py-class docutils literal notranslate"><span class="pre">results.sim_out</span></code></a></dt>
<dd>Return a sim_out object containing simulation output information.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="files.read_mdl">
<code class="descclassname">files.</code><code class="descname">read_mdl</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/files.html#read_mdl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#files.read_mdl" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in a file written in the molden file format.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>File name with or without .mdl file extension.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list, list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms read in from the xyz file.  If there is only one
frame, then only a <em>list</em> of <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a> is returned.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="files.read_xyz">
<code class="descclassname">files.</code><code class="descname">read_xyz</code><span class="sig-paren">(</span><em>name, cols=['element', 'x', 'y', 'z'], cast_elem_to_sym=True, fast=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/files.html#read_xyz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#files.read_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in a file written in the XYZ file format.  This is an improved
version, accounting for xyz files of varying atom numbers.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>File name with or without .xyz file extension.</dd>
<dt>cols: <em>list, str, optional</em></dt>
<dd>The specific columns in this xyz file.  Note - we may not support
all possibilities, and order matters!</dd>
<dt>cast_elem_to_sym: <em>bool, optional</em></dt>
<dd>Whether to cast the element into the symbol (ex. 2 becomes He).</dd>
<dt>fast: <em>bool, optional</em></dt>
<dd><dl class="first docutils">
<dt>If specified, you are promising that this xyz file has the columns</dt>
<dd>element x y z</dd>
</dl>
<p class="last">Further, if speed truly matters and you do not want to foce cast
element into symbols, we recommend setting cast_elem_to_sym=False.</p>
</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list, list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms read in from the xyz file.  If there is only one
frame, then only a <em>list</em> of <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a> is returned.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="files.read_xyz_gen">
<code class="descclassname">files.</code><code class="descname">read_xyz_gen</code><span class="sig-paren">(</span><em>name, cols=['element', 'x', 'y', 'z'], cast_elem_to_sym=True, fast=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/files.html#read_xyz_gen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#files.read_xyz_gen" title="Permalink to this definition">¶</a></dt>
<dd><p>This will yield a frame from an xyz file.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>File name with or without .xyz file extension.</dd>
<dt>cols: <em>list, str, optional</em></dt>
<dd>The specific columns in this xyz file.  Note - we may not support
all possibilities, and order matters!</dd>
<dt>cast_elem_to_sym: <em>bool, optional</em></dt>
<dd>Whether to cast the element into the symbol (ex. 2 becomes He).</dd>
<dt>fast: <em>bool, optional</em></dt>
<dd><dl class="first docutils">
<dt>If specified, you are promising that this xyz file has the columns</dt>
<dd>element x y z</dd>
</dl>
<p class="last">Further, if speed truly matters and you do not want to foce cast
element into symbols, we recommend setting cast_elem_to_sym=False.</p>
</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>yield: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A frame from an xyz file.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="files.which">
<code class="descclassname">files.</code><code class="descname">which</code><span class="sig-paren">(</span><em>program</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/files.html#which"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#files.which" title="Permalink to this definition">¶</a></dt>
<dd><p>A function to return the full path of a system executable.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>program: <em>str</em></dt>
<dd>The name of the system executable to find.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>path: <em>str or None</em></dt>
<dd>The path to the system executable. If none exists, then None.</dd>
</dl>
</div></blockquote>
<p><strong>References</strong></p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="http://stackoverflow.com/a/377028">http://stackoverflow.com/a/377028</a></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="files.write_cml">
<code class="descclassname">files.</code><code class="descname">write_cml</code><span class="sig-paren">(</span><em>atoms_or_molecule_or_system</em>, <em>bonds=[]</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/files.html#write_cml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#files.write_cml" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data in (list, <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a>), or
<a class="reference internal" href="#structures.Molecule" title="structures.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Molecule</span></code></a>, or <a class="reference internal" href="#structures.System" title="structures.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.System</span></code></a> to a file
written in the Chemical Markup Language (CML) format. If a list of
<a class="reference internal" href="#structures.Molecule" title="structures.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Molecule</span></code></a> is passed, then a CML file is written in
which each molecule is its own section.  Note, this cannot be read into
Avogadro, and it is recommended that if you plan to use Avogadro to
combine these into one <a class="reference internal" href="#structures.System" title="structures.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.System</span></code></a>.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atoms_or_molecule_or_system: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a> <em>or</em> <a class="reference internal" href="#structures.Molecule" title="structures.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Molecule</span></code></a> <em>or</em> <a class="reference internal" href="#structures.System" title="structures.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.System</span></code></a></dt>
<dd>Atomic data to be written to a CML file.</dd>
<dt>bonds: <em>list,</em> <a class="reference internal" href="#structures.Bond" title="structures.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Bond</span></code></a> <em>, optional</em></dt>
<dd>A list of bonds within the system.  This is useful when the input
is a list of <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a> .</dd>
<dt>name: <em>str, optional</em></dt>
<dd>The name of the output file (either ending or not in .cml).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="files.write_lammps_data">
<code class="descclassname">files.</code><code class="descname">write_lammps_data</code><span class="sig-paren">(</span><em>system</em>, <em>name=None</em>, <em>params=None</em>, <em>pair_coeffs_included=False</em>, <em>hybrid_angle=False</em>, <em>hybrid_pair=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/files.html#write_lammps_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#files.write_lammps_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a lammps data file from the given system.</p>
<p>Set pair_coeffs_included to True to write pair_coeffs in data file.
Set hybrid_angle to True to detect different treatment of angles among
different atom types.
Set hybrid_pair to True to detect different treatment of pairing
interactions
among different atom types.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>system: <a class="reference internal" href="#structures.System" title="structures.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.System</span></code></a></dt>
<dd>Atomic system to be written to a lammps data file.</dd>
<dt>name: <em>str, optional</em></dt>
<dd>What to reassign the system name to.</dd>
<dt>new_method: <em>bool, optional</em></dt>
<dd>A boolean on whether to use the new method of parameter handling,
or the old one.  Note, the old one will be deprecated and no
longer maintained, and over time removed, so we recommend getting
used to this method instead.</dd>
<dt>pair_coeffs_included: <em>bool, optional</em></dt>
<dd>Whether to write pair coefficients into the data file (True),
or not (False).</dd>
<dt>hybrid_angle: <em>bool, optional</em></dt>
<dd>Whether to detect different treatments of angles amongst different
atom types (True), or not (False).</dd>
<dt>hybrid_pair: <em>bool, optional</em></dt>
<dd>Whether to detect different treatments of pairing interactions
amongst different atom types(True), or not (False).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="files.write_mdl">
<code class="descclassname">files.</code><code class="descname">write_mdl</code><span class="sig-paren">(</span><em>frames</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/files.html#write_mdl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#files.write_mdl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="files.write_xyz">
<code class="descclassname">files.</code><code class="descname">write_xyz</code><span class="sig-paren">(</span><em>frames_or_system</em>, <em>name_or_file=None</em>, <em>ID='Atoms'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/files.html#write_xyz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#files.write_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Write frames of atomic conformations to a file written in the XYZ file
format.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames_or_system: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a> <em>or</em> <a class="reference internal" href="#structures.System" title="structures.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.System</span></code></a></dt>
<dd>Atoms to be written to an xyz file.</dd>
<dt>name_or_file: <em>str or fptr, optional</em></dt>
<dd>Either a filename (with or without the .xyz extension) or an open
file buffer to write the xyz file.</dd>
<dt>ID: <em>str, optional</em></dt>
<dd>What is to be written on the xyz comment line.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-frc_opls">
<span id="frc-opls"></span><h2>frc_opls<a class="headerlink" href="#module-frc_opls" title="Permalink to this headline">¶</a></h2>
<p>The OPLS Forcefield module contains functionality for parsing the OPLS
forcefield and typing appropriately.  Note, you must first import
files before ever importing frc_opls.</p>
<ul class="simple">
<li><a class="reference internal" href="#frc_opls.read_opls_parameters" title="frc_opls.read_opls_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_opls_parameters()</span></code></a></li>
<li><a class="reference internal" href="#frc_opls.set_forcefield_parameters" title="frc_opls.set_forcefield_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_forcefield_parameters()</span></code></a></li>
<li><a class="reference internal" href="#frc_opls.check_net_charge" title="frc_opls.check_net_charge"><code class="xref py py-func docutils literal notranslate"><span class="pre">check_net_charge()</span></code></a></li>
<li><a class="reference internal" href="#frc_opls.check_consistency" title="frc_opls.check_consistency"><code class="xref py py-func docutils literal notranslate"><span class="pre">check_consistency()</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="function">
<dt id="frc_opls.check_consistency">
<code class="descclassname">frc_opls.</code><code class="descname">check_consistency</code><span class="sig-paren">(</span><em>atoms</em>, <em>bonds</em>, <em>angles</em>, <em>dihedrals</em>, <em>name=''</em>, <em>allow_errors=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frc_opls.html#check_consistency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frc_opls.check_consistency" title="Permalink to this definition">¶</a></dt>
<dd><p>Check to see if all possible force field parameters have been assigned.
Raises exception if missing an bond or angle. Missing dihedrals allowed
by default. Can turn off raising exceptions.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>List of atom objects to check if parameters were set accordingly.</dd>
<dt>bonds: <em>list,</em> <a class="reference internal" href="#structures.Bond" title="structures.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Bond</span></code></a> <em>, optional</em></dt>
<dd>List of bond objects to check if parameters were set accordingly.</dd>
<dt>angles: <em>list,</em> <a class="reference internal" href="#structures.Angle" title="structures.Angle"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Angle</span></code></a> <em>, optional</em></dt>
<dd>List of angle objects to check if parameters were set accordingly.</dd>
<dt>dihedrals: <em>list,</em> <a class="reference internal" href="#structures.Dihedral" title="structures.Dihedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Dihedral</span></code></a> <em>, optional</em></dt>
<dd>List of dihedral objects to check if parameters were set
accordingly.</dd>
<dt>name: <em>str, optional</em></dt>
<dd>Name of the molecule/system.</dd>
<dt>allow_errors: <em>bool, optional</em></dt>
<dd>Whether to allow incomplete parameterizations, or to throw errors.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="frc_opls.check_net_charge">
<code class="descclassname">frc_opls.</code><code class="descname">check_net_charge</code><span class="sig-paren">(</span><em>atoms</em>, <em>name=''</em>, <em>q_tol=0.01</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frc_opls.html#check_net_charge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frc_opls.check_net_charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Check what the net charge is of the given list of atoms.  An error is
raised if the net_charge is greater than <em>q_tol</em>.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><p>atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></p>
<p>name: <em>str, optional</em></p>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="frc_opls.read_opls_parameters">
<code class="descclassname">frc_opls.</code><code class="descname">read_opls_parameters</code><span class="sig-paren">(</span><em>parameter_file='/mnt/c/Users/hherb/Documents/subsystem/squid/forcefield_parameters/oplsaa.prm'</em>, <em>pair_style='lj/cut'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frc_opls.html#read_opls_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frc_opls.read_opls_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads an opls parameter file written in the Tinker file format.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>parameter_file: <em>str, optional</em></dt>
<dd>Relative or absolute path to an opls parameter file, written in
the Tinker file format.</dd>
<dt>pair_style: <em>str, optional</em></dt>
<dd>The pair style to be assigned.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atom_types: <em>list,</em> <a class="reference internal" href="#structures.Struct" title="structures.Struct"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Struct</span></code></a></dt>
<dd>A list of the forcefield types for atoms, stored as
<a class="reference internal" href="#structures.Struct" title="structures.Struct"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Struct</span></code></a>.</dd>
<dt>bond_types: <em>list,</em> <a class="reference internal" href="#structures.Struct" title="structures.Struct"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Struct</span></code></a></dt>
<dd>A list of the forcefield types for bonds, stored as
<a class="reference internal" href="#structures.Struct" title="structures.Struct"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Struct</span></code></a>.</dd>
<dt>angle_types: <em>list,</em> <a class="reference internal" href="#structures.Struct" title="structures.Struct"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Struct</span></code></a></dt>
<dd>A list of the forcefield types for angles, stored as
<a class="reference internal" href="#structures.Struct" title="structures.Struct"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Struct</span></code></a>.</dd>
<dt>dihedral_types: <em>list,</em> <a class="reference internal" href="#structures.Struct" title="structures.Struct"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Struct</span></code></a></dt>
<dd>A list of the forcefield types for dihedrals, stored as
<a class="reference internal" href="#structures.Struct" title="structures.Struct"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Struct</span></code></a>.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="frc_opls.set_forcefield_parameters">
<code class="descclassname">frc_opls.</code><code class="descname">set_forcefield_parameters</code><span class="sig-paren">(</span><em>atoms, bonds=[], angles=[], dihedrals=[], parameter_file=[('OPLS', '/mnt/c/Users/hherb/Documents/subsystem/squid/forcefield_parameters/oplsaa.prm')], name='unnamed', extra_parameters={}, test_consistency=True, test_charges=True, allow_errors=False, pair_style='lj/cut', allow_no_ffp=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/frc_opls.html#set_forcefield_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#frc_opls.set_forcefield_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads an opls parameter file written in the Tinker file format.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>List of atom objects to be parameterized.</dd>
<dt>bonds: <em>list,</em> <a class="reference internal" href="#structures.Bond" title="structures.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Bond</span></code></a> <em>, optional</em></dt>
<dd>List of bond objects to be parameterized.</dd>
<dt>angles: <em>list,</em> <a class="reference internal" href="#structures.Angle" title="structures.Angle"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Angle</span></code></a> <em>, optional</em></dt>
<dd>List of angle objects to be parameterized.</dd>
<dt>dihedrals: <em>list,</em> <a class="reference internal" href="#structures.Dihedral" title="structures.Dihedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Dihedral</span></code></a> <em>, optional</em></dt>
<dd>List of dihedral objects to be parameterized.</dd>
<dt>parameter_file: <em>list, tuple, str, optional</em></dt>
<dd>The name and path of the force field to be used.  Note, we
currently only accept “OPLS”.</dd>
<dt>name: <em>str, optional</em></dt>
<dd>Name of the molecule/system you are parameterizing.</dd>
<dt>extra_parameters: <em>dict, optional</em></dt>
<dd>Additional parameters not found in the forcefield.</dd>
<dt>test_consistency: <em>bool, optional</em></dt>
<dd>Whether to verify all parameters have been set.</dd>
<dt>test_charges: <em>bool, optional</em></dt>
<dd>Whether to verify the system is at a neutral state.</dd>
<dt>allow_errors: <em>bool, optional</em></dt>
<dd>Whether to allow incomplete parameterizations, or to throw errors.</dd>
<dt>pair_style: <em>str, optional</em></dt>
<dd>The pair style to be used.</dd>
<dt>allow_no_ffp: <em>bool, optional</em></dt>
<dd>Whether to allow for situations in which some atoms are not
included in this force field.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of all atoms with set parameters.</dd>
<dt>bonds: <em>list,</em> <a class="reference internal" href="#structures.Bond" title="structures.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Bond</span></code></a></dt>
<dd>A list of all bonds with set parameters.</dd>
<dt>angles: <em>list,</em> <a class="reference internal" href="#structures.Angle" title="structures.Angle"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Angle</span></code></a></dt>
<dd>A list of all angles with set parameters.</dd>
<dt>dihedrals: <em>list,</em> <a class="reference internal" href="#structures.Dihedral" title="structures.Dihedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Dihedral</span></code></a></dt>
<dd>A list of all dihedrals with set parameters.</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-g09">
<span id="g09"></span><h2>g09<a class="headerlink" href="#module-g09" title="Permalink to this headline">¶</a></h2>
<p>The g09 module contains python functions for interfacing with the Gaussian09
DFT software package. NOTE! Due to implementation restrictions this code will
only work on the ICSE cluster.  Primarily the g09 job submission command is
specific to the ICSE system.</p>
<ul class="simple">
<li><a class="reference internal" href="#g09.read" title="g09.read"><code class="xref py py-func docutils literal notranslate"><span class="pre">read()</span></code></a></li>
<li><a class="reference internal" href="#g09.job" title="g09.job"><code class="xref py py-func docutils literal notranslate"><span class="pre">job()</span></code></a></li>
<li><a class="reference internal" href="#g09.cubegen_analysis" title="g09.cubegen_analysis"><code class="xref py py-func docutils literal notranslate"><span class="pre">cubegen_analysis()</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="function">
<dt id="g09.cubegen_analysis">
<code class="descclassname">g09.</code><code class="descname">cubegen_analysis</code><span class="sig-paren">(</span><em>old_job</em>, <em>orbital=None</em>, <em>path='gaussian/'</em>, <em>chk_conv=True</em>, <em>skip_potential=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/g09.html#cubegen_analysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#g09.cubegen_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Post process a g09 job using cubegen and vmd to display molecular orbitals
and the potential surface.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>old_job: <em>str</em></dt>
<dd>Gaussian file name.  Only use the name, such as ‘water’ instead
of ‘water.chk’.  Note, do not pass a path as it is assumed you
are in the parent directory of the job to analyze.  If not, use
the path variable.</dd>
<dt>orbital: <em>str, optional</em></dt>
<dd>The orbital to analyze (0, 1, 2, 3, …). By default HOMO and
LUMO will be analyzed, thus this only is useful if you wish to
see other orbitals.</dd>
<dt>path: <em>str, optional</em></dt>
<dd>Path to where the gaussian job was run.  By default, this is a
gaussian subfolder.</dd>
<dt>chk_conv: <em>bool, optional</em></dt>
<dd>Check if the simulation converged before proceeding.  If you only
have a .chk file and you are certain it converged, this can be
set to False.</dd>
<dt>skip_potential: <em>bool, optional</em></dt>
<dd>If you only care about MO’s, skip the expensive potential
surface calculation.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="g09.job">
<code class="descclassname">g09.</code><code class="descname">job</code><span class="sig-paren">(</span><em>run_name, route, atoms=[], extra_section='', queue='short', procs=1, verbosity='N', charge_and_multiplicity='0,1', title='run by gaussian.py', blurb=None, eRec=True, force=False, previous=None, neb=[False, None, None, None], err=False, mem=25</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/g09.html#job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#g09.job" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper to submitting an Gaussian09 simulation.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>run_name: <em>str</em></dt>
<dd>Name of the simulation to be run.</dd>
<dt>route: <em>route</em></dt>
<dd>The DFT route line, containing the function, basis set, etc.</dd>
<dt>atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a> <em>,optional</em></dt>
<dd>A list of atoms for the simulation.</dd>
<dt>extra_section: <em>str, optional</em></dt>
<dd>Additional DFT simulation parameters.</dd>
<dt>queue: <em>str, optional</em></dt>
<dd>What queue to run the simulation on (queueing system dependent).</dd>
<dt>procs: <em>int, optional</em></dt>
<dd>How many processors to run the simulation on.</dd>
<dt>verbosity: <em>str, optional</em></dt>
<dd>Verbosity flag for Gaussian09 output.</dd>
<dt>charge_and_multiplicity: <em>str, optional</em></dt>
<dd>Charge and multiplicity of the system.</dd>
<dt>title: <em>str, optional</em></dt>
<dd>Comment line for Gaussian09 input file.</dd>
<dt>blurb: <em>str, deprecated</em></dt>
<dd>Do not use</dd>
<dt>eRec: <em>bool, deprecated</em></dt>
<dd>Do not use</dd>
<dt>force: <em>bool, optional</em></dt>
<dd>Whether to overwrite a simulation with the same name.</dd>
<dt>previous: <em>str, optional</em></dt>
<dd>Name of a previous simulation for which to try reading in
information using the MORead method.</dd>
<dt>neb: <em>list, bool, deprecated</em></dt>
<dd>Do not use</dd>
<dt>err: <em>bool, deprecated</em></dt>
<dd>Do not use</dd>
<dt>mem: <em>float, optional</em></dt>
<dd>Amount of memory per processor that is available (in MB).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>job: <em>subprocess.Popen or</em> <a class="reference internal" href="#jobs.Job" title="jobs.Job"><code class="xref py py-class docutils literal notranslate"><span class="pre">jobs.Job</span></code></a></dt>
<dd>If running locally, return the process handle, else return
the job container.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="g09.parse_route">
<code class="descclassname">g09.</code><code class="descname">parse_route</code><span class="sig-paren">(</span><em>route</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/g09.html#parse_route"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#g09.parse_route" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Function that parses the route into the following situations:</dt>
<dd>func/basis
key(a,b,c,…)
key(a)
key=a
key = a
key=(a,b,c,…)</dd>
</dl>
<p><em>Parameters</em></p>
<blockquote>
<div><dl class="docutils">
<dt>route: <em>str</em></dt>
<dd>The route of a g09 simulation</dd>
</dl>
</div></blockquote>
<p><em>Returns</em></p>
<blockquote>
<div><dl class="docutils">
<dt>parsed_list: <em>list, str</em></dt>
<dd>Split list of g09 route line.</dd>
<dt>extra: <em>str</em></dt>
<dd>What was not parsed is returned.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="g09.read">
<code class="descclassname">g09.</code><code class="descname">read</code><span class="sig-paren">(</span><em>input_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/g09.html#read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#g09.read" title="Permalink to this definition">¶</a></dt>
<dd><p>General read in of all possible data from an Gaussian09 output file (.log).</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>input_file: <em>str</em></dt>
<dd>Gaussian .log file to be parsed.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>data: <a class="reference internal" href="#results.DFT_out" title="results.DFT_out"><code class="xref py py-class docutils literal notranslate"><span class="pre">results.DFT_out</span></code></a></dt>
<dd>Generic DFT output object containing all parsed results.</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-geometry">
<span id="geometry"></span><h2>geometry<a class="headerlink" href="#module-geometry" title="Permalink to this headline">¶</a></h2>
<p>The geometry module contains various functions aiding in euclidian manipulation
of atomic coordinates.</p>
<ul class="simple">
<li><a class="reference internal" href="#geometry.align_centroid" title="geometry.align_centroid"><code class="xref py py-func docutils literal notranslate"><span class="pre">align_centroid()</span></code></a></li>
<li><a class="reference internal" href="#geometry.align_frames" title="geometry.align_frames"><code class="xref py py-func docutils literal notranslate"><span class="pre">align_frames()</span></code></a></li>
<li><a class="reference internal" href="#geometry.angle_size" title="geometry.angle_size"><code class="xref py py-func docutils literal notranslate"><span class="pre">angle_size()</span></code></a></li>
<li><a class="reference internal" href="#geometry.array_to_atom_list" title="geometry.array_to_atom_list"><code class="xref py py-func docutils literal notranslate"><span class="pre">array_to_atom_list()</span></code></a></li>
<li><a class="reference internal" href="#geometry.atom_list_to_array" title="geometry.atom_list_to_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">atom_list_to_array()</span></code></a></li>
<li><a class="reference internal" href="#geometry.center_frames" title="geometry.center_frames"><code class="xref py py-func docutils literal notranslate"><span class="pre">center_frames()</span></code></a></li>
<li><a class="reference internal" href="#geometry.dihedral_angle" title="geometry.dihedral_angle"><code class="xref py py-func docutils literal notranslate"><span class="pre">dihedral_angle()</span></code></a></li>
<li><a class="reference internal" href="#geometry.dist" title="geometry.dist"><code class="xref py py-func docutils literal notranslate"><span class="pre">dist()</span></code></a></li>
<li><a class="reference internal" href="#geometry.dist_squared" title="geometry.dist_squared"><code class="xref py py-func docutils literal notranslate"><span class="pre">dist_squared()</span></code></a></li>
<li><a class="reference internal" href="#geometry.get_bonds" title="geometry.get_bonds"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_bonds()</span></code></a></li>
<li><a class="reference internal" href="#geometry.get_angles_and_dihedrals" title="geometry.get_angles_and_dihedrals"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_angles_and_dihedrals()</span></code></a></li>
<li><a class="reference internal" href="#geometry.interpolate" title="geometry.interpolate"><code class="xref py py-func docutils literal notranslate"><span class="pre">interpolate()</span></code></a></li>
<li><a class="reference internal" href="#geometry.motion_per_frame" title="geometry.motion_per_frame"><code class="xref py py-func docutils literal notranslate"><span class="pre">motion_per_frame()</span></code></a></li>
<li><a class="reference internal" href="#geometry.mvee" title="geometry.mvee"><code class="xref py py-func docutils literal notranslate"><span class="pre">mvee()</span></code></a></li>
<li><a class="reference internal" href="#geometry.orthogonal_procrustes" title="geometry.orthogonal_procrustes"><code class="xref py py-func docutils literal notranslate"><span class="pre">orthogonal_procrustes()</span></code></a></li>
<li><a class="reference internal" href="#geometry.procrustes" title="geometry.procrustes"><code class="xref py py-func docutils literal notranslate"><span class="pre">procrustes()</span></code></a></li>
<li><a class="reference internal" href="#geometry.rand_rotation" title="geometry.rand_rotation"><code class="xref py py-func docutils literal notranslate"><span class="pre">rand_rotation()</span></code></a></li>
<li><a class="reference internal" href="#geometry.reduce_list" title="geometry.reduce_list"><code class="xref py py-func docutils literal notranslate"><span class="pre">reduce_list()</span></code></a></li>
<li><a class="reference internal" href="#geometry.reorder_atoms_in_frames" title="geometry.reorder_atoms_in_frames"><code class="xref py py-func docutils literal notranslate"><span class="pre">reorder_atoms_in_frames()</span></code></a></li>
<li><a class="reference internal" href="#geometry.rotate_frames" title="geometry.rotate_frames"><code class="xref py py-func docutils literal notranslate"><span class="pre">rotate_frames()</span></code></a></li>
<li><a class="reference internal" href="#geometry.rotate_xyz" title="geometry.rotate_xyz"><code class="xref py py-func docutils literal notranslate"><span class="pre">rotate_xyz()</span></code></a></li>
<li><a class="reference internal" href="#geometry.rotation_matrix" title="geometry.rotation_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">rotation_matrix()</span></code></a></li>
<li><a class="reference internal" href="#geometry.rms" title="geometry.rms"><code class="xref py py-func docutils literal notranslate"><span class="pre">rms()</span></code></a></li>
<li><a class="reference internal" href="#geometry.smooth_xyz" title="geometry.smooth_xyz"><code class="xref py py-func docutils literal notranslate"><span class="pre">smooth_xyz()</span></code></a></li>
<li><a class="reference internal" href="#geometry.translate_vector_1A" title="geometry.translate_vector_1A"><code class="xref py py-func docutils literal notranslate"><span class="pre">translate_vector_1A()</span></code></a></li>
<li><a class="reference internal" href="#geometry.translate_vector_2B" title="geometry.translate_vector_2B"><code class="xref py py-func docutils literal notranslate"><span class="pre">translate_vector_2B()</span></code></a></li>
<li><a class="reference internal" href="#geometry.translate_vector_3C" title="geometry.translate_vector_3C"><code class="xref py py-func docutils literal notranslate"><span class="pre">translate_vector_3C()</span></code></a></li>
<li><a class="reference internal" href="#geometry.unwrap_molecules" title="geometry.unwrap_molecules"><code class="xref py py-func docutils literal notranslate"><span class="pre">unwrap_molecules()</span></code></a></li>
<li><a class="reference internal" href="#geometry.unwrap_xyz" title="geometry.unwrap_xyz"><code class="xref py py-func docutils literal notranslate"><span class="pre">unwrap_xyz()</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="function">
<dt id="geometry.align_centroid">
<code class="descclassname">geometry.</code><code class="descname">align_centroid</code><span class="sig-paren">(</span><em>atoms</em>, <em>recenter=True</em>, <em>skip_H=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#align_centroid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.align_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a Minimum Volume Enclosing Ellipsoid (MVEE) around atomic
species to align the atoms along the x-axis.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of Atom objects.</dd>
<dt>recenter: <em>bool, optional</em></dt>
<dd>Whether to recenter the new coordinates around the origin or not.
Note, this is done via the center of geometry, NOT the center of
mass.</dd>
<dt>skip_H: <em>bool, optional</em></dt>
<dd>Whether to skip hydrogen during recentering (that is, do not take
them into accound when calculating the center of geometry).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>molec.atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Rotated atomic coordinates.</dd>
<dt>A: <em>list, list, float</em></dt>
<dd>Rotated positive definite symmetric matrix of the ellipsoid’s
center form. This contains the ellipsoid’s orientation and
eccentricity.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.align_frames">
<code class="descclassname">geometry.</code><code class="descname">align_frames</code><span class="sig-paren">(</span><em>prev_frames</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#align_frames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.align_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a set of frames depicting some pathway, this function attempts to
order atomic coordinates similarly throughout each frame.</p>
<p>NOTE! THIS IS A VERY SIMPLE METHOD BASED ON INTERATOMIC DISTANCES!  A
better procedure would be that of geometry.reorder_atoms_in_frames()</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>prev_frames: <em>list, list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>List of lists of atoms.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list, list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>List of lists of atoms.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.angle_size">
<code class="descclassname">geometry.</code><code class="descname">angle_size</code><span class="sig-paren">(</span><em>a</em>, <em>center</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#angle_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.angle_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the angle between three atoms.  In this case, determin the angle
a-center-b.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>a: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>First atom in the angle.</dd>
<dt>center: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Center atom of the angle.</dd>
<dt>b: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Last atom in the angle.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>theta: <em>float</em></dt>
<dd>Return the angle in degrees.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.array_to_atom_list">
<code class="descclassname">geometry.</code><code class="descname">array_to_atom_list</code><span class="sig-paren">(</span><em>A</em>, <em>elems</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#array_to_atom_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.array_to_atom_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of atomic coordinates as lists of floats, and a list of
elements, generate a list of atom objects.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>A: <em>list, list, float</em></dt>
<dd>A list of the atomic coordinates</dd>
<dt>elems: <em>list, str</em></dt>
<dd>A list of the elements associated with each index.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frame: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atom objects.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.atom_list_to_array">
<code class="descclassname">geometry.</code><code class="descname">atom_list_to_array</code><span class="sig-paren">(</span><em>A</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#atom_list_to_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.atom_list_to_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of atoms, return a list of coordinates.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>A: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atom objects.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>coords: <em>list, list, float</em></dt>
<dd>A list of the atomic coordinates</dd>
<dt>elems: <em>list, str</em></dt>
<dd>A list of the elements associated with each index.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.center_frames">
<code class="descclassname">geometry.</code><code class="descname">center_frames</code><span class="sig-paren">(</span><em>frames, ids, X_TOL=0.1, XY_TOL=0.1, Z_TOL=0.1, THETA_STEP=0.005, TRANSLATE=[0, 0, 0]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#center_frames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.center_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>LEGACY CODE: Quickly and poorly implemented code.  Only use if
geometry.procrustes/geometry.orthogonal_procrustes is unable to
accomplish what you need.</p>
<p>Recenter a list of lists of atomic coordinates to overlay based on input
criteria.  This is a simpler method than procrustes, but will rarely
minimize the frobenius norm.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list, list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>List of lists of atoms.</dd>
<dt>ids: <em>list, int</em></dt>
<dd><dl class="first last docutils">
<dt>A list of indices for the following:</dt>
<dd><dl class="first last docutils">
<dt>ids[0] - This is an atom that will be positioned at the</dt>
<dd>origin after translating the frame</dd>
<dt>ids[1] - This is an atom that will lie on the positive</dt>
<dd>x-axis after two rotations of the frame</dd>
<dt>ids[2] - This is an atom that will lie on the xy plane in the</dt>
<dd>positive y direction after rotation of the frame</dd>
</dl>
</dd>
</dl>
</dd>
<dt>X_TOL: <em>float, optional</em></dt>
<dd>Tolerance for alignment of ids[1] along the x-axis.</dd>
<dt>XY_TOL: <em>float, optional</em></dt>
<dd>Tolerance for alignment of ids[2] along the positive y-axis.</dd>
<dt>Z_TOL: <em>float, optional</em></dt>
<dd>Tolerance for alignment of ids[2] along the xy plane.</dd>
<dt>THETA_STEP: <em>float, optional</em></dt>
<dd>Steps at which to adjust rotation when finding optimal rotations.
Smaller implies better fit to centering criteria, but slower
calculations.</dd>
<dt>TRANSLATE: <em>list, float</em></dt>
<dd>The desired translation from the origin.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
<p><strong>See also</strong></p>
<blockquote>
<div>For more information, see <a class="reference internal" href="#geometry.orthogonal_procrustes" title="geometry.orthogonal_procrustes"><code class="xref py py-func docutils literal notranslate"><span class="pre">orthogonal_procrustes()</span></code></a>
and <a class="reference internal" href="#geometry.procrustes" title="geometry.procrustes"><code class="xref py py-func docutils literal notranslate"><span class="pre">procrustes()</span></code></a>.</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.check_all_bonds">
<code class="descclassname">geometry.</code><code class="descname">check_all_bonds</code><span class="sig-paren">(</span><em>frames</em>, <em>system</em>, <em>bond_tolerance=5.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#check_all_bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.check_all_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Add molecule index to the atom if it has not already been assigned. Then
recursively pass bonded atoms to the function</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atom_list: <em>list</em>, <a class="reference internal" href="#structures.Molecule" title="structures.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Molecule</span></code></a></dt>
<dd>A list of atoms</dd>
<dt>i_list_index: <em>int</em></dt>
<dd>The index of the atom currently being assigned. Refers to
atom_list index.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.dihedral_angle">
<code class="descclassname">geometry.</code><code class="descname">dihedral_angle</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em>, <em>d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#dihedral_angle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.dihedral_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the Praxeolitic formula to determine the dihedral angle between
4 atoms.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>a: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>First atom in the dihedral.</dd>
<dt>b: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Second atom in the dihedral.</dd>
<dt>c: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Third atom in the dihedral.</dd>
<dt>d: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Fourth atom in the dihedral.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>theta: <em>float</em></dt>
<dd>Return the dihedral angle in radians.</dd>
</dl>
</div></blockquote>
<p><strong>References</strong></p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="http://stackoverflow.com/a/34245697">http://stackoverflow.com/a/34245697</a></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.dist">
<code class="descclassname">geometry.</code><code class="descname">dist</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>system=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the distance between two atomic species.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atom1: <em>:class:`structures.Atom`</em></dt>
<dd>One of the two atoms to find the distance between.</dd>
<dt>atom2: <em>:class:`structures.Atom`</em></dt>
<dd>Second of the two atoms to find the distance between.</dd>
<dt>system: <em>:class:`structures.System`, optional</em></dt>
<dd>The system that the point is contained. Used for periodic
distance calculations</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>d: <em>float</em></dt>
<dd>Distance between the two atoms.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.dist_squared">
<code class="descclassname">geometry.</code><code class="descname">dist_squared</code><span class="sig-paren">(</span><em>atom1</em>, <em>atom2</em>, <em>system=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#dist_squared"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.dist_squared" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the squared distance between two atomic species. Slightly faster than
geometry.dist(a, b) as we do not take the square root.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atom1: <em>:class:`structures.Atom`</em></dt>
<dd>One of the two atoms to find the distance between.</dd>
<dt>atom2: <em>:class:`structures.Atom`</em></dt>
<dd>Second of the two atoms to find the distance between.</dd>
<dt>system: <em>:class:`structures.System`, optional</em></dt>
<dd>The system that the point is contained. Used for periodic distance
calculations</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>sqr_dist: <em>float</em></dt>
<dd>Squared distance between the two atoms.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.get_angles_and_dihedrals">
<code class="descclassname">geometry.</code><code class="descname">get_angles_and_dihedrals</code><span class="sig-paren">(</span><em>atoms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#get_angles_and_dihedrals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.get_angles_and_dihedrals" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of atom structures with bonded information, calculate angles
and dihedrals.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>List of atoms for which angles and dihedrals are to be calculated.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>angles: <em>list,</em> <a class="reference internal" href="#structures.Angle" title="structures.Angle"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Angle</span></code></a></dt>
<dd>Calculated angles.</dd>
<dt>dihedrals: <em>list,</em> <a class="reference internal" href="#structures.Dihedral" title="structures.Dihedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Dihedral</span></code></a></dt>
<dd>Calculated dihedrals.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.get_bonds">
<code class="descclassname">geometry.</code><code class="descname">get_bonds</code><span class="sig-paren">(</span><em>atoms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#get_bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.get_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of atomic positions, determine all bonds based on proximity.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>List of atoms for which bonds are to be calculated.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>bonds: <em>list,</em> <a class="reference internal" href="#structures.Bond" title="structures.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Bond</span></code></a></dt>
<dd>Return the calculated bonds.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.interpolate">
<code class="descclassname">geometry.</code><code class="descname">interpolate</code><span class="sig-paren">(</span><em>frame_1</em>, <em>frame_2</em>, <em>N</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Linearly interpolate N frames between two given frames.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frame_1: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>List of atoms.</dd>
<dt>frame_2: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>List of atoms.</dd>
<dt>N: <em>int</em></dt>
<dd>Number of new frames you want to generate during interpolation.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list, list, float</em></dt>
<dd>List of interpolated frames (non-inclusive of frame_1 nor frame_2).</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.motion_per_frame">
<code class="descclassname">geometry.</code><code class="descname">motion_per_frame</code><span class="sig-paren">(</span><em>frames</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#motion_per_frame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.motion_per_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the root mean squared difference between atomic positions
of adjacent frames.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list, list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>List of lists of atoms.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>motion: <em>list, float</em></dt>
<dd>List of motion between consecutive frames (frame_i vs
frame_(i - 1)).  As len(motion) = len(frames), this means that
motion[0] = 0.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.mvee">
<code class="descclassname">geometry.</code><code class="descname">mvee</code><span class="sig-paren">(</span><em>points</em>, <em>tol=0.001</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#mvee"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.mvee" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a Minimum Volume Enclosing Ellipsoid (MVEE) around atomic species.
The ellipsoid is calculated for the “center form”: (x-c).T * A * (x-c) = 1</p>
<p>For useful values, you can get the radii as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">r_i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">vol</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span>
</pre></div>
</div>
<p>Further, note that V is the rotation matrix giving the orientation of
the ellipsoid.</p>
<p>NOTE! You must have a minimum of 4 atoms for this to work.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>points:  <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of Atom objects.</dd>
<dt>tol: <em>float, optional</em></dt>
<dd>Tolerance for ellipsoid generation.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>A: <em>list, list, float</em></dt>
<dd>Positive definite symmetric matrix of the ellipsoid’s center form.
This contains the ellipsoid’s orientation and eccentricity.</dd>
<dt>c: <em>list, float</em></dt>
<dd>Center of the ellipsoid.</dd>
</dl>
</div></blockquote>
<p><strong>References</strong></p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://www.mathworks.com/matlabcentral/fileexchange/9542-minimum-volume-enclosing-ellipsoid?requestedDomain=www.mathworks.com">https://www.mathworks.com/matlabcentral/fileexchange/9542-minimum-volume-enclosing-ellipsoid?requestedDomain=www.mathworks.com</a></li>
<li><a class="reference external" href="http://stackoverflow.com/questions/14016898/port-matlab-bounding-ellipsoid-code-to-python/14025140#14025140">http://stackoverflow.com/questions/14016898/port-matlab-bounding-ellipsoid-code-to-python/14025140#14025140</a></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.orthogonal_procrustes">
<code class="descclassname">geometry.</code><code class="descname">orthogonal_procrustes</code><span class="sig-paren">(</span><em>A</em>, <em>ref_matrix</em>, <em>reflection=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#orthogonal_procrustes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.orthogonal_procrustes" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the orthogonal procrustes method, we find the unitary matrix R with
det(R) &gt; 0 such that ||A*R - ref_matrix||^2 is minimized.  This varies
from that within scipy by the addition of the reflection term, allowing
and disallowing inversion.  NOTE - This means that the rotation matrix is
used for right side multiplication!</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>A: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms for which R will minimize the frobenius
norm ||A*R - ref_matrix||^2.</dd>
<dt>ref_matrix: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms for which <em>A</em> is being rotated towards.</dd>
<dt>reflection: <em>bool, optional</em></dt>
<dd>Whether inversion is allowed (True) or not (False).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>R: <em>list, list, float</em></dt>
<dd>Right multiplication rotation matrix to best overlay A onto the
reference matrix.</dd>
<dt>scale: <em>float</em></dt>
<dd>Scalar between the matrices.</dd>
</dl>
</div></blockquote>
<p><strong>Derivation</strong></p>
<blockquote>
<div><p>Goal: minimize ||A*R - ref||^2, switch to trace</p>
<p>trace((A*R-ref).T*(A*R-ref)), now we distribute</p>
<p>trace(R’*A’*A*R) + trace(ref.T*ref) - trace((A*R).T*ref) -
trace(ref.T*(A*R)), trace doesn’t care about order, so re-order</p>
<p>trace(R*R.T*A.T*A) + trace(ref.T*ref) - trace(R.T*A.T*ref) -
trace(ref.T*A*R), simplify</p>
<p>trace(A.T*A) + trace(ref.T*ref) - 2*trace(ref.T*A*R)</p>
<p>Thus, to minimize we want to maximize trace(ref.T * A * R)</p>
<p>u*w*v.T = (ref.T*A).T</p>
<p>ref.T * A = w * u.T * v</p>
<p>trace(ref.T * A * R) = trace (w * u.T * v * R)</p>
<p>differences minimized when trace(ref.T * A * R) is maximized, thus
when trace(u.T * v * R) is maximized</p>
<p>This occurs when u.T * v * R = I (as u, v and R are all unitary
matrices so max is 1)</p>
<p>R is a rotation matrix so R.T = R^-1</p>
<p>u.T * v * I = R^-1 = R.T</p>
<p>R = u * v.T</p>
<p>Thus, R = u.dot(vt)</p>
</div></blockquote>
<p><strong>References</strong></p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://github.com/scipy/scipy/blob/v0.16.0/scipy/linalg/">https://github.com/scipy/scipy/blob/v0.16.0/scipy/linalg/</a>
_procrustes.py#L14</li>
<li><a class="reference external" href="http://compgroups.net/comp.soft-sys.matlab/procrustes-analysis">http://compgroups.net/comp.soft-sys.matlab/procrustes-analysis</a>
-without-reflection/896635</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.procrustes">
<code class="descclassname">geometry.</code><code class="descname">procrustes</code><span class="sig-paren">(</span><em>frames</em>, <em>count_atoms=None</em>, <em>append_in_loop=True</em>, <em>reflection=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#procrustes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.procrustes" title="Permalink to this definition">¶</a></dt>
<dd><p>Propogate rotation along a list of lists of atoms to smooth out
transitions between consecutive frames. This is done by rigid rotation
and translation (no scaling and no inversions).  Rotation starts
at frames[0].</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list, list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>List of lists of atoms.</dd>
<dt>count_atoms: <em>list, int, optional</em></dt>
<dd>A list of indices for which translation and rotations will be
calculated from.</dd>
<dt>append_in_loop: <em>bool, optional</em></dt>
<dd>If rotation matrices for every atom (True) is desired vs rotation
matrices for every frame (False). Every rotation matrix for atoms
within the same frame is the same. Thus, when this is True,
multiplicates will appear.</dd>
<dt>reflection: <em>bool, optional</em></dt>
<dd>Whether inversion is allowed (True) or not (False).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>full_rotation: <em>list, list, float</em></dt>
<dd>List of every rotation matrix applied.  NOTE - These matrices are
applied via right side multiplication.</dd>
</dl>
</div></blockquote>
<p><strong>See also</strong></p>
<blockquote>
<div>For more information, see <a class="reference internal" href="#geometry.orthogonal_procrustes" title="geometry.orthogonal_procrustes"><code class="xref py py-func docutils literal notranslate"><span class="pre">orthogonal_procrustes()</span></code></a>.</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.rand_rotation">
<code class="descclassname">geometry.</code><code class="descname">rand_rotation</code><span class="sig-paren">(</span><em>limit_angle=None</em>, <em>lower_bound=0.1</em>, <em>MAXITER=1000000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#rand_rotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.rand_rotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random rotation matrix.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>limit_angle: <em>float, optional</em></dt>
<dd>Whether to confine your random rotation (in radians).</dd>
<dt>lower_bound: <em>float, optional</em></dt>
<dd>A lower bound for limit_angle, at which the identity is
simply returned.  This is necessary as the procedure to
generate the limit_angle method is incredibly slow at
small angles.</dd>
<dt>MAXITER: <em>int, optional</em></dt>
<dd>A maximum iteration for when we try to calculate a rotation
matrix with some limit_angle specified.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list, list, float</em></dt>
<dd>A random rotation matrix.</dd>
</dl>
</div></blockquote>
<p><strong>References</strong></p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="http://tog.acm.org/resources/GraphicsGems/">http://tog.acm.org/resources/GraphicsGems/</a>, Ed III</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.reduce_list">
<code class="descclassname">geometry.</code><code class="descname">reduce_list</code><span class="sig-paren">(</span><em>givenList</em>, <em>idfun=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#reduce_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.reduce_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove duplicates of a list, whilst maintaining order.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>givenList: <em>list</em></dt>
<dd>List of anything for which __eq__ has been defined.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>cleaned_list: <em>list</em></dt>
<dd>List with duplicates removed.</dd>
</dl>
</div></blockquote>
<p><strong>References</strong></p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://www.peterbe.com/plog/uniqifiers-benchmark">https://www.peterbe.com/plog/uniqifiers-benchmark</a></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.reorder_atoms_in_frames">
<code class="descclassname">geometry.</code><code class="descname">reorder_atoms_in_frames</code><span class="sig-paren">(</span><em>frames</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#reorder_atoms_in_frames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.reorder_atoms_in_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>A function to ensure that consecutive frames of an xyz file are in the
same order.  This is done by minimizing the frobenious norm between
consecutive frames with the application of a perterbation matrix P.</p>
<blockquote>
<div>minimize ||PR_{i+1} - R_{i}||^2.</div></blockquote>
<p>This problem boils down to maximizing Tr[P R_{i + 1} R_{i}^T].  We solve
this with Munkres algorithm using the scipy.optimize.linear_sum_assignment
function.</p>
<p>NOTE! This only works when we have the problem in which atom order only is
mixed up.  If we also have rotations, then the problem actually becomes:</p>
<blockquote>
<div>minimize ||PAR_{i+1} - R_{i}||^2</div></blockquote>
<p>Which is, unfortunately, harder as we now have two unknown
matrices (P and A)!</p>
<p>Requires scipy 0.17.0 or above.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Input frames to be sorted.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>Rframes: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A reordered list.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.rms">
<code class="descclassname">geometry.</code><code class="descname">rms</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#rms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.rms" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Root-Mean-Squared value of an array.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>array: <em>list, float</em></dt>
<dd>An array of floats to find the RMS of.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>rms: <em>float</em></dt>
<dd>The Root-Mean-Squared value.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.rotate_frames">
<code class="descclassname">geometry.</code><code class="descname">rotate_frames</code><span class="sig-paren">(</span><em>frame, theta_0=0, theta_n=360, dt=1, axis=[0, 0, 1], cog=True, origin=(0, 0, 0), last=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#rotate_frames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.rotate_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of atoms, generate a sequential list of rotated atomic
instances.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frame: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of Atoms.</dd>
<dt>theta_0: <em>float, optional</em></dt>
<dd>Starting rotation.</dd>
<dt>theta_n: <em>float, optional</em></dt>
<dd>Ending rotation.</dd>
<dt>dt: <em>float, optional</em></dt>
<dd>Change in rotation.</dd>
<dt>axis: <em>list, float, optional</em></dt>
<dd>Which axis to rotate around.</dd>
<dt>cog: <em>bool, optional</em></dt>
<dd>Whether to rotate around the center of geometry (True) or
not (False).</dd>
<dt>origin: <em>tuple, float</em></dt>
<dd>The origin for which we will rotate around.</dd>
<dt>last: <em>bool, optional</em></dt>
<dd>Whether to only return the final rotation (True) or not (False).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list, list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a> <em>or list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Returned rotations of everything (if last is True), or just the
final rotation (if last is False).</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.rotate_xyz">
<code class="descclassname">geometry.</code><code class="descname">rotate_xyz</code><span class="sig-paren">(</span><em>alpha</em>, <em>beta</em>, <em>gamma</em>, <em>units='deg'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#rotate_xyz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.rotate_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>POTENTIALLY DEPRECATED CODE! WILL FAIL ON USE!</p>
<p>Construct general rotation matrix using yaw, pitch, and roll
(alpha, beta, gamma). Performs extrinsic rotation whose Euler angles
are alpha, beta, and gamma about axes z, y, and x.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>alpha: <em>float</em></dt>
<dd>The ‘yaw’ angle.</dd>
<dt>beta: <em>float</em></dt>
<dd>The ‘pitch’ angle.</dd>
<dt>gamma: <em>float</em></dt>
<dd>The ‘roll’ angle.</dd>
<dt>units: <em>str, optional</em></dt>
<dd>The units of the given angles.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>rotatation_matrix: <em>list, list, float</em></dt>
<dd>The rotation matrix.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.rotation_matrix">
<code class="descclassname">geometry.</code><code class="descname">rotation_matrix</code><span class="sig-paren">(</span><em>axis</em>, <em>theta</em>, <em>units='deg'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#rotation_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.rotation_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain a left multiplication rotation matrix, given the axis and angle you
wish to rotate by. By default it assumes units of degrees.  If theta is in
radians, set units to rad.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>axis: <em>list, float</em></dt>
<dd>The axis in which to rotate around.</dd>
<dt>theta: <em>float</em></dt>
<dd>The angle of rotation.</dd>
<dt>units: <em>str, optional</em></dt>
<dd>The units of theta (deg or rad).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>rotatation_matrix: <em>list, list, float</em></dt>
<dd>The left multiplication rotation matrix.</dd>
</dl>
</div></blockquote>
<p><strong>References</strong></p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="http://stackoverflow.com/questions/6802577/python-rotation-of-3d-vector/25709323#25709323">http://stackoverflow.com/questions/6802577/python-rotation-of-3d-vector/25709323#25709323</a></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.smooth_xyz">
<code class="descclassname">geometry.</code><code class="descname">smooth_xyz</code><span class="sig-paren">(</span><em>name</em>, <em>R_MAX=0.5</em>, <em>F_MAX=25</em>, <em>N_FRAMES=None</em>, <em>PROCRUSTES=True</em>, <em>outName=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#smooth_xyz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.smooth_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth out an xyz file by linearly interpolating frames to minimize the
maximum motion between adjacent frames.  Further, this can use procrustes
to best overlap adjacent frames.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>list, list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of lists of atoms.</dd>
<dt>R_MAX: <em>float, optional</em></dt>
<dd>The maximum motion allowed between consecutive frames.</dd>
<dt>F_MAX: <em>int, optional</em></dt>
<dd>The maximum number of frames allowed before failing the smooth
function.</dd>
<dt>N_FRAMES: <em>int, optional</em></dt>
<dd>If this is specified, forgo the R_MAX and F_MAX and just interpolate
out into N_FRAMES.  Note, if more than N_FRAMES exists, this also
cuts back into exactly N_FRAMES.</dd>
<dt>PROCRUSTES: <em>bool, optional</em></dt>
<dd>Whether procrustes is to be used during smoothing (True), or
not (False).</dd>
<dt>outName: <em>str, optional</em></dt>
<dd>An output file name for the smoothed frames (without the .xyz
extension).</dd>
<dt>verbose: <em>bool, optional</em></dt>
<dd>Whether additional stdout is desired (True), or not (False).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list, list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Returns a list of smoothed frames</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.translate_vector_1A">
<code class="descclassname">geometry.</code><code class="descname">translate_vector_1A</code><span class="sig-paren">(</span><em>pos</em>, <em>multiple</em>, <em>system</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#translate_vector_1A"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.translate_vector_1A" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate x,y,z coordinates across boundary vector 1/A, as many times as
‘multiple’</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>pos: <em>list, float</em></dt>
<dd>XYZ point.</dd>
<dt>multiple: <em>float</em></dt>
<dd>Scalar value to translate by. multiple = 1 means translate one
full vector.</dd>
<dt>system: <a class="reference internal" href="#structures.System" title="structures.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.System</span></code></a></dt>
<dd>The system that the point is contained. The 1/A vector is pulled
from the system.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>[x_a, y_a, z_a]: <em>list, float</em></dt>
<dd>New XYZ point.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.translate_vector_2B">
<code class="descclassname">geometry.</code><code class="descname">translate_vector_2B</code><span class="sig-paren">(</span><em>pos</em>, <em>multiple</em>, <em>system</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#translate_vector_2B"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.translate_vector_2B" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate x,y,z coordinates across boundary vector 2/B, as many times
as ‘multiple’</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>pos: <em>list, float</em></dt>
<dd>XYZ point.</dd>
<dt>multiple: <em>float</em></dt>
<dd>Scalar value to translate by. multiple = 1 means translate one
full vector.</dd>
<dt>system: <a class="reference internal" href="#structures.System" title="structures.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.System</span></code></a></dt>
<dd>The system that the point is contained. The 1/A vector is pulled
from the system.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>[x_b, y_b, z_b]: <em>list, float</em></dt>
<dd>New XYZ point.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.translate_vector_3C">
<code class="descclassname">geometry.</code><code class="descname">translate_vector_3C</code><span class="sig-paren">(</span><em>pos</em>, <em>multiple</em>, <em>system</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#translate_vector_3C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.translate_vector_3C" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate x,y,z coordinates across boundary vector 3/C, as many times as
‘multiple’</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>pos: <em>list, float</em></dt>
<dd>XYZ point.</dd>
<dt>multiple: <em>float</em></dt>
<dd>Scalar value to translate by. multiple = 1 means translate one
full vector.</dd>
<dt>system: <a class="reference internal" href="#structures.System" title="structures.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.System</span></code></a></dt>
<dd>The system that the point is contained. The 1/A vector is pulled
from the system.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>[x_c, y_c, z_c]: <em>list, float</em></dt>
<dd>New XYZ point.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.unwrap_molecules">
<code class="descclassname">geometry.</code><code class="descname">unwrap_molecules</code><span class="sig-paren">(</span><em>frames</em>, <em>system</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#unwrap_molecules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.unwrap_molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>Unwraps the atoms in a periodic system so that no bonds are across a
periodic box. Requires either (1) the atoms in the frames to have bond
information, or (2) the atoms in system to have bond information. In
case (2), the atoms in system serve as a template for every frame and
must contain every atom.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list, list, :class:`structures.Atom`</em></dt>
<dd>List of lists of atoms.</dd>
<dt>system: <em>:class:`structures.System`</em></dt>
<dd>The system that the point is contained. Used for periodic
distance calculations</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list, list, :class:`structures.Atom`</em></dt>
<dd>Updated list of lists of atoms.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="geometry.unwrap_xyz">
<code class="descclassname">geometry.</code><code class="descname">unwrap_xyz</code><span class="sig-paren">(</span><em>frames</em>, <em>system</em>, <em>motion_tolerance=3.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geometry.html#unwrap_xyz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geometry.unwrap_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Unwraps the atoms in a periodic system so that atoms are never reflected
across periodic boundary conditions. Does this by using the previous time
step as the reference and undoing any periodic reflections in the
lammpstrj</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list, list, :class:`structures.Atom`</em></dt>
<dd>List of lists of atoms.</dd>
<dt>system: <em>:class:`structures.System`</em></dt>
<dd>The system that the point is contained. Used for periodic distance
calculations</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list, list, :class:`structures.Atom`</em></dt>
<dd>Updated list of lists of atoms.</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="jdftx">
<h2>jdftx<a class="headerlink" href="#jdftx" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-jobs">
<span id="jobs"></span><h2>jobs<a class="headerlink" href="#module-jobs" title="Permalink to this headline">¶</a></h2>
<p>The Job module contains the Job class that wraps simulations for queue
submission.  Further, it contains functionality to aid in simulation
submission to queueing systems.</p>
<ul class="simple">
<li><a class="reference internal" href="#jobs.Job" title="jobs.Job"><code class="xref py py-class docutils literal notranslate"><span class="pre">Job</span></code></a></li>
<li><a class="reference internal" href="#jobs.get_all_jobs" title="jobs.get_all_jobs"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_all_jobs()</span></code></a></li>
<li><a class="reference internal" href="#jobs.get_running_jobs" title="jobs.get_running_jobs"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_running_jobs()</span></code></a></li>
<li><a class="reference internal" href="#jobs.get_pending_jobs" title="jobs.get_pending_jobs"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_pending_jobs()</span></code></a></li>
<li><a class="reference internal" href="#jobs.submit_job" title="jobs.submit_job"><code class="xref py py-func docutils literal notranslate"><span class="pre">submit_job()</span></code></a></li>
<li><a class="reference internal" href="#jobs.pysub" title="jobs.pysub"><code class="xref py py-func docutils literal notranslate"><span class="pre">pysub()</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="class">
<dt id="jobs.Job">
<em class="property">class </em><code class="descclassname">jobs.</code><code class="descname">Job</code><span class="sig-paren">(</span><em>name</em>, <em>process_handle=None</em>, <em>job_id=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jobs.html#Job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jobs.Job" title="Permalink to this definition">¶</a></dt>
<dd><p>Job class to wrap simulations for queue submission.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>Name of the simulation on the queue.</dd>
<dt>process_handle: <em>process_handle, optional</em></dt>
<dd>The process handle, returned by subprocess.Popen.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>This <a class="reference internal" href="#jobs.Job" title="jobs.Job"><code class="xref py py-class docutils literal notranslate"><span class="pre">Job</span></code></a> object.</div></blockquote>
<dl class="method">
<dt id="jobs.Job.is_finished">
<code class="descname">is_finished</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jobs.html#Job.is_finished"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jobs.Job.is_finished" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if simulation has finished or not.</p>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>is_on_queue: <em>bool</em></dt>
<dd>Whether the simulation is still running (True), or not (False).</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="jobs.Job.wait">
<code class="descname">wait</code><span class="sig-paren">(</span><em>tsleep=60</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jobs.html#Job.wait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jobs.Job.wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Hang until simulation has finished.</p>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="jobs.get_all_jobs">
<code class="descclassname">jobs.</code><code class="descname">get_all_jobs</code><span class="sig-paren">(</span><em>queueing_system='None'</em>, <em>detail=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jobs.html#get_all_jobs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jobs.get_all_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of all jobs currently on your queue.  The <em>detail</em>
variable can be used to specify how much information you want returned.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>queueing_system: <em>str, optional</em></dt>
<dd>Which queueing system you are using (NBS or PBS).</dd>
<dt>detail: <em>int, optional</em></dt>
<dd>The amount of information you want returned.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>all_jobs: <em>list</em></dt>
<dd><p class="first">Depending on <em>detail</em>, you get the following:</p>
<blockquote class="last">
<div><ul class="simple">
<li><dl class="first docutils">
<dt><em>details</em> =0: <em>list, str</em></dt>
<dd>List of all jobs on the queue.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>details</em> =1: <em>list, tuple, str</em></dt>
<dd><dl class="first last docutils">
<dt>List of all jobs on the queue as:</dt>
<dd>(job name, time run, job status)</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>details</em> =2: <em>list, tuple, str</em></dt>
<dd><dl class="first last docutils">
<dt>List of all jobs on the queue as:</dt>
<dd><dl class="first last docutils">
<dt>(job name,</dt>
<dd>time run,
job status,
queue,
number of processors)</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="jobs.get_pending_jobs">
<code class="descclassname">jobs.</code><code class="descname">get_pending_jobs</code><span class="sig-paren">(</span><em>queueing_system='None'</em>, <em>detail=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jobs.html#get_pending_jobs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jobs.get_pending_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of all jobs currently pending on your queue.
The <em>detail</em> variable can be used to specify how much information
you want returned.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>queueing_system: <em>str, optional</em></dt>
<dd>Which queueing system you are using (NBS or PBS).</dd>
<dt>detail: <em>int, optional</em></dt>
<dd>The amount of information you want returned.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>all_jobs: <em>list</em></dt>
<dd><p class="first">Depending on <em>detail</em>, you get the following:</p>
<blockquote class="last">
<div><ul class="simple">
<li><dl class="first docutils">
<dt><em>details</em> =0: <em>list, str</em></dt>
<dd>List of all pending jobs on the queue.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>details</em> =1: <em>list, tuple, str</em></dt>
<dd><dl class="first last docutils">
<dt>List of all pending jobs on the queue as:</dt>
<dd>(job name, time run, job status)</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>details</em> =2: <em>list, tuple, str</em></dt>
<dd><dl class="first last docutils">
<dt>List of all pending jobs on the queue as:</dt>
<dd><dl class="first last docutils">
<dt>(job name,</dt>
<dd>time run,
job status,
queue,
number of processors)</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="jobs.get_running_jobs">
<code class="descclassname">jobs.</code><code class="descname">get_running_jobs</code><span class="sig-paren">(</span><em>queueing_system='None'</em>, <em>detail=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jobs.html#get_running_jobs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jobs.get_running_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of all jobs currently running on your queue.  The <em>detail</em>
variable can be used to specify how much information you want returned.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>queueing_system: <em>str, optional</em></dt>
<dd>Which queueing system you are using (NBS or PBS).</dd>
<dt>detail: <em>int, optional</em></dt>
<dd>The amount of information you want returned.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>all_jobs: <em>list</em></dt>
<dd><p class="first">Depending on <em>detail</em>, you get the following:</p>
<blockquote class="last">
<div><ul class="simple">
<li><dl class="first docutils">
<dt><em>details</em> =0: <em>list, str</em></dt>
<dd>List of all running jobs on the queue.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>details</em> =1: <em>list, tuple, str</em></dt>
<dd><dl class="first last docutils">
<dt>List of all running jobs on the queue as:</dt>
<dd>(job name, time run, job status)</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>details</em> =2: <em>list, tuple, str</em></dt>
<dd><dl class="first last docutils">
<dt>List of all running jobs on the queue as:</dt>
<dd><dl class="first last docutils">
<dt>(job name,</dt>
<dd>time run,
job status,
queue,
number of processors)</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="jobs.pysub">
<code class="descclassname">jobs.</code><code class="descname">pysub</code><span class="sig-paren">(</span><em>job_name</em>, <em>nprocs=1</em>, <em>ntasks=1</em>, <em>nodes=1</em>, <em>adjust_nodes=True</em>, <em>omp=None</em>, <em>queue='None'</em>, <em>walltime='00:30:00'</em>, <em>xhost=None</em>, <em>path='/mnt/c/Users/hherb/Documents/subsystem/squid/docs'</em>, <em>priority=None</em>, <em>args=None</em>, <em>remove_sub_script=True</em>, <em>unique_name=False</em>, <em>redundancy=False</em>, <em>py3=False</em>, <em>use_mpi=False</em>, <em>modules=None</em>, <em>slurm_allocation=None</em>, <em>queueing_system='None'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jobs.html#pysub"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jobs.pysub" title="Permalink to this definition">¶</a></dt>
<dd><p>Submission of python scripts to run on your queue.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>job_name: <em>str</em></dt>
<dd>Name of the python script (with or without the .py extension).</dd>
<dt>nprocs: <em>int, optional</em></dt>
<dd>Number of processors to run your script on.</dd>
<dt>ntasks: <em>int, optional</em></dt>
<dd>(For SLURM) The number of tasks this job will run, each task uses
procs number of cores.</dd>
<dt>nodes: <em>int, optional</em></dt>
<dd>(For SLURM) The number of nodes this job requires.  If requesting
ntasks * procs &lt; 24 * nodes, a warning is printed, as on MARCC
each node has only 24 cores.</dd>
<dt>adjust_nodes: <em>bool, optional</em></dt>
<dd>Whether to automatically calculate how many nodes is necessary
when the user underspecifies nodes.</dd>
<dt>use_mpi: <em>bool, optional</em></dt>
<dd>Whether to run python via mpirun or not.</dd>
<dt>omp: <em>int, None</em></dt>
<dd>The number OMP_NUM_THREADS should be manually assigned to.</dd>
<dt>queue: <em>str, optional</em></dt>
<dd>Which queue you want your script to run on (specific to
your queueing system).</dd>
<dt>priority: <em>int, optional</em></dt>
<dd>Priority of the simulation (queueing system dependent).  Priority
ranges (in NBS) from a low of 1 (start running whenever) to a
high of 255 (start running ASAP).</dd>
<dt>xhost: <em>list, str or str</em></dt>
<dd>Which processors you want your script to run on (specific to
your queueing system).</dd>
<dt>path: <em>str, optional</em></dt>
<dd>What directory your python script resides in. Note, this does NOT
have a trailing /.</dd>
<dt>args: <em>list, str, optional</em></dt>
<dd>A list of arguments to pass to the python script on the queue.</dd>
<dt>modules: <em>list, str, optional</em></dt>
<dd>A list of modules to load prior to running this python script.
Requires an installed version of lmod.</dd>
<dt>remove_sub_script: <em>bool, optional</em></dt>
<dd>Whether to remove the script used to submit the job (True), or
leave it (False).</dd>
<dt>unique_name: <em>bool, optional</em></dt>
<dd>Whether the simulation should have a unique name.  By default, no.</dd>
<dt>redundancy: <em>bool, optional</em></dt>
<dd>With redundancy on, if the job is submitted and unique_name is on, then
if another job of the same name is running, a pointer to that job will
instead be returned.</dd>
<dt>py3: <em>bool, optional</em></dt>
<dd>Whether to run with python3 or python2 (2 is default). NOTE! This will
ONLY work if you have defined python3_path in your sysconst file.</dd>
<dt>slurm_allocation: <em>str, optional</em></dt>
<dd>Whether to use a slurm allocation for this job or not.  If so, specify the name.</dd>
<dt>queueing_system: <em>str, optional</em></dt>
<dd>Which queueing system you are using (NBS or PBS).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="jobs.submit_job">
<code class="descclassname">jobs.</code><code class="descname">submit_job</code><span class="sig-paren">(</span><em>name</em>, <em>job_to_submit</em>, <em>procs=1</em>, <em>ntasks=1</em>, <em>nodes=1</em>, <em>adjust_nodes=True</em>, <em>queue='None'</em>, <em>mem=1000</em>, <em>priority=None</em>, <em>walltime='00:30:00'</em>, <em>xhosts=None</em>, <em>additional_env_vars=''</em>, <em>sandbox=None</em>, <em>use_NBS_sandbox=False</em>, <em>sub_flag=''</em>, <em>email=None</em>, <em>preface=None</em>, <em>redundancy=False</em>, <em>unique_name=True</em>, <em>slurm_allocation=None</em>, <em>queueing_system='None'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jobs.html#submit_job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jobs.submit_job" title="Permalink to this definition">¶</a></dt>
<dd><p>Code to submit a simulation to the specified queue and queueing system.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>Name of the job to be submitted to the queue.  In the case of NBS,
it must be without the suffix.  Ex. ‘job’ works but ‘job.nbs’ fails.</dd>
<dt>job_to_submit: <em>str</em></dt>
<dd>String holding code you wish to submit.</dd>
<dt>procs: <em>int, optional</em></dt>
<dd>Number of processors requested.</dd>
<dt>ntasks: <em>int, optional</em></dt>
<dd>(For SLURM) The number of tasks this job will run, each task uses
procs number of cores.</dd>
<dt>nodes: <em>int, optional</em></dt>
<dd>(For SLURM) The number of nodes this job requires.  If requesting
ntasks * procs &lt; 24 * nodes, a warning is printed, as on MARCC
each node has only 24 cores.</dd>
<dt>adjust_nodes: <em>bool, optional</em></dt>
<dd>Whether to automatically calculate how many nodes is necessary
when the user underspecifies nodes.</dd>
<dt>queue: <em>str, optional</em></dt>
<dd>Queue you are submitting to (queueing system dependent).</dd>
<dt>mem: <em>float, optional</em></dt>
<dd>Amount of memory you’re requesting.</dd>
<dt>priority: <em>int, optional</em></dt>
<dd>Priority of the simulation (queueing system dependent).  Priority
ranges (in NBS) from a low of 1 (start running whenever) to a
high of 255 (start running ASAP).</dd>
<dt>xhosts: <em>list, str or str, optional</em></dt>
<dd>Which processors you want to run the job on.</dd>
<dt>additional_env_vars: <em>str, optional</em></dt>
<dd>Additional environment variables to be appended to the job.</dd>
<dt>sandbox: <em>list, list, str, optional</em></dt>
<dd>A list of two lists. The first holds a list of files to be
sent to the sandbox and the latter a list of files to be returned
from the sandbox.</dd>
<dt>use_NBS_sandbox: <em>bool, optional</em></dt>
<dd>Whether to use the NBS sandboxing headers (True), or manually copy
files (False).</dd>
<dt>sub_flag: <em>str, optional</em></dt>
<dd>Additional flags to be used during job submission.</dd>
<dt>redundancy: <em>bool, optional</em></dt>
<dd>With redundancy on, if the job is submitted and unique_name is on, then
if another job of the same name is running, a pointer to that job will
instead be returned.</dd>
<dt>unique_name: <em>bool, optional</em></dt>
<dd>Whether the simulation should have a unique name.  By default, no.</dd>
<dt>slurm_allocation: <em>str, optional</em></dt>
<dd>Whether to use a slurm allocation for this job or not.  If so, specify the name.</dd>
<dt>queueing_system: <em>str, optional</em></dt>
<dd>Which queueing system you are using (NBS, PBS, or SLURM).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-joust">
<span id="joust"></span><h2>joust<a class="headerlink" href="#module-joust" title="Permalink to this headline">¶</a></h2>
<p>Job Organizer for User Simulation Tasks (JOUST).</p>
<ul class="simple">
<li><a class="reference internal" href="#joust.Joust" title="joust.Joust"><code class="xref py py-class docutils literal notranslate"><span class="pre">Joust</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="class">
<dt id="joust.Joust">
<em class="property">class </em><code class="descclassname">joust.</code><code class="descname">Joust</code><span class="sig-paren">(</span><em>name</em>, <em>global_system=None</em>, <em>queue=None</em>, <em>procs=1</em>, <em>mem=1000</em>, <em>priority=100</em>, <em>xhosts=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/joust.html#Joust"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#joust.Joust" title="Permalink to this definition">¶</a></dt>
<dd><p>The Job Organizer for User Simulation Tasks (JOUST) is the Squid
workflow manager, used for automating the process of simulating
consecutive jobs.</p>
<p>It works by allowing the user to add_task() and del_task() from a list of
tasks to run.  When ready, start() can be called to begin simulating.</p>
<p>Note, you can run tasks in parallel simply by having them in a list. That
is, instead of:</p>
<blockquote>
<div>task_order = [“t1”, “t2”, “t3”, “t4”]</div></blockquote>
<p>you can run “t1” and “t2” in parallel by doing the following:</p>
<blockquote>
<div>task_order = [[“t1”, “t2”], “t3”, “t4”]</div></blockquote>
<p>Similarly, every task can be run in parallel as follows:</p>
<blockquote>
<div>task_order = [[“t1”, “t2”, “t3”, “t4”]]</div></blockquote>
<dl class="method">
<dt id="joust.Joust.add_task">
<code class="descname">add_task</code><span class="sig-paren">(</span><em>task_name</em>, <em>task</em>, <em>append_to_run_list=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/joust.html#Joust.add_task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#joust.Joust.add_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Append a task to be run. This is an order dependent process and thus,
tasks added first will run first.  Note, not all tasks added need be
run. Any task that may be called from another, but only when a
specific conditional is met, should also be added here.
In those cases, use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">append_to_run_list</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
</div>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>task_name: <em>str</em></dt>
<dd>Name of the task to be run.</dd>
<dt>task:</dt>
<dd>Task object.</dd>
<dt>append_to_run_list: <em>bool, optional</em></dt>
<dd>Whether this will add the task to the run list, or not.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="joust.Joust.del_task">
<code class="descname">del_task</code><span class="sig-paren">(</span><em>task_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/joust.html#Joust.del_task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#joust.Joust.del_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a task from the task list.  This will delete the task, as well
as any instances in which it would have been called by JOUST.  NOTE!
This does NOT remove the task from other tasks however.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>task_name: <em>str</em></dt>
<dd>Name of the task to be removed.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="joust.Joust.start">
<code class="descname">start</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/joust.html#Joust.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#joust.Joust.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Start the workflow manager.</p>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lammps_job">
<span id="lammps-job"></span><h2>lammps_job<a class="headerlink" href="#module-lammps_job" title="Permalink to this headline">¶</a></h2>
<p>The lammps_job module contains .</p>
<ul class="simple">
<li><a class="reference internal" href="#lammps_job.read" title="lammps_job.read"><code class="xref py py-func docutils literal notranslate"><span class="pre">read()</span></code></a></li>
<li><a class="reference internal" href="#lammps_job.read_dump" title="lammps_job.read_dump"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_dump()</span></code></a></li>
<li><a class="reference internal" href="#lammps_job.job" title="lammps_job.job"><code class="xref py py-func docutils literal notranslate"><span class="pre">job()</span></code></a></li>
<li><a class="reference internal" href="#lammps_job.read_TIP4P_types" title="lammps_job.read_TIP4P_types"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_TIP4P_types()</span></code></a></li>
<li><a class="reference internal" href="#lammps_job.PotEngSurfaceJob" title="lammps_job.PotEngSurfaceJob"><code class="xref py py-func docutils literal notranslate"><span class="pre">PotEngSurfaceJob()</span></code></a></li>
<li><code class="xref py py-func docutils literal notranslate"><span class="pre">PotEngSurfaceJob_v2()</span></code></li>
<li><a class="reference internal" href="#lammps_job.OptJob" title="lammps_job.OptJob"><code class="xref py py-func docutils literal notranslate"><span class="pre">OptJob()</span></code></a></li>
<li><a class="reference internal" href="#lammps_job.thermo_2_text" title="lammps_job.thermo_2_text"><code class="xref py py-func docutils literal notranslate"><span class="pre">thermo_2_text()</span></code></a></li>
<li><a class="reference internal" href="#lammps_job.read_thermo" title="lammps_job.read_thermo"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_thermo()</span></code></a></li>
<li><a class="reference internal" href="#lammps_job.lmp_task" title="lammps_job.lmp_task"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmp_task</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="function">
<dt id="lammps_job.OptJob">
<code class="descclassname">lammps_job.</code><code class="descname">OptJob</code><span class="sig-paren">(</span><em>run_name, input_script, system, domain, spanMolecule, resolution=0.1, queue=None, procs=1, email='', pair_coeffs_included=True, hybrid_pair=False, orientations=10, split=1, floor=[0.0, 0.0, 0.0]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lammps_job.html#OptJob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lammps_job.OptJob" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a series of lammps jobs in a space defined by domain and resolution,
at each position performing a rand_rotation of the spanMolecule. Runs the
simulation at that position orienations many times. Each simulation line
will be split over split many jobs.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>run_name: <em>str</em></dt>
<dd>Name of the simulation to be run.</dd>
<dt>input_script: <em>str</em></dt>
<dd>Input script for LAMMPs simulation.</dd>
<dt>system: <a class="reference internal" href="#structures.System" title="structures.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.System</span></code></a></dt>
<dd>System object for our simulation.</dd>
<dt>domain: <em>list, float</em></dt>
<dd>A list of 3 elements referring to the XYZ domain in which
the molecule spanMolecule will raster across.  Ex. [0.0, 1.0, 1.0]
will span over a 1x1 angstrom box in the positive y and z
directions from spanMolecule’s original position.</dd>
<dt>spanMolecule: <em>str</em></dt>
<dd>The path to a cml file representing a molecule to be rastered
across the surface.</dd>
<dt>resolution: <em>float, optional</em></dt>
<dd>The change in position to be taken during rastering.</dd>
<dt>queue: <em>str, optional</em></dt>
<dd>What queue to run the simulation on (queueing system dependent).</dd>
<dt>procs: <em>int, optional</em></dt>
<dd>How many processors to run the simulation on.</dd>
<dt>email: <em>str, optional</em></dt>
<dd>An email address for sending job information to.</dd>
<dt>pair_coeffs_included: <em>bool, optional</em></dt>
<dd>Whether we have included the pair coefficients to be written to
our lammps data file.</dd>
<dt>hybrid_pair: <em>bool, optional</em></dt>
<dd>Whether to detect different treatments of pairing interactions
amongst different atom types(True), or not (False).</dd>
<dt>orientations: <em>int, optional</em></dt>
<dd>The number of random orientations to be run at every position.</dd>
<dt>split: <em>int, optional</em></dt>
<dd>The number of optimizations to append to a single lammps
simulation.  This is primarily used when batching jobs for
the queue.</dd>
<dt>floor: <em>list, float, optional</em></dt>
<dd>A position to set spanMolecule to prior to rastering.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="lammps_job.PotEngSurfaceJob">
<code class="descclassname">lammps_job.</code><code class="descname">PotEngSurfaceJob</code><span class="sig-paren">(</span><em>run_name, input_script, system, domain, spanMolecule, resolution=0.1, queue='None', procs=1, email='', pair_coeffs_included=True, hybrid_pair=False, split=0, floor=[0.0, 0.0, 0.0]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lammps_job.html#PotEngSurfaceJob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lammps_job.PotEngSurfaceJob" title="Permalink to this definition">¶</a></dt>
<dd><p>TO BE ADDED AGAIN</p>
</dd></dl>

<dl class="function">
<dt id="lammps_job.job">
<code class="descclassname">lammps_job.</code><code class="descname">job</code><span class="sig-paren">(</span><em>run_name</em>, <em>input_script</em>, <em>system=None</em>, <em>queue='None'</em>, <em>procs=1</em>, <em>ntasks=1</em>, <em>nodes=1</em>, <em>adjust_nodes=True</em>, <em>email=None</em>, <em>write_data_file=True</em>, <em>pair_coeffs_included=True</em>, <em>hybrid_pair=False</em>, <em>hybrid_angle=False</em>, <em>TIP4P=False</em>, <em>no_echo=False</em>, <em>redundancy=False</em>, <em>params=None</em>, <em>lmp_path='/mnt/c/Users/hherb/Documents/subsystem/squid/lammps/16Mar18/src/lmp_wsl'</em>, <em>slurm_allocation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lammps_job.html#job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lammps_job.job" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper to submitting a LAMMPs simulation.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>run_name: <em>str</em></dt>
<dd>Name of the simulation to be run.</dd>
<dt>input_script: <em>str</em></dt>
<dd>Input script for LAMMPs simulation.</dd>
<dt>system: <a class="reference internal" href="#structures.System" title="structures.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.System</span></code></a></dt>
<dd>System object for our simulation.</dd>
<dt>queue: <em>str, optional</em></dt>
<dd>What queue to run the simulation on (queueing system dependent).</dd>
<dt>procs: <em>int, optional</em></dt>
<dd>How many processors to run the simulation on.  Note, the actual
number of cores mpirun will use is procs * ntasks.</dd>
<dt>ntasks: <em>int, optional</em></dt>
<dd>(For SLURM) The number of tasks this job will run, each task uses
procs number of cores.  Note, the actual number of cores mpirun
will use is procs * ntasks.</dd>
<dt>nodes: <em>int, optional</em></dt>
<dd>(For SLURM) The number of nodes this job requires.  If requesting
ntasks * procs &lt; 24 * nodes, a warning is printed, as on MARCC
each node has only 24 cores.</dd>
<dt>adjust_nodes: <em>bool, optional</em></dt>
<dd>Whether to automatically calculate how many nodes is necessary
when the user underspecifies nodes.</dd>
<dt>email: <em>str, optional</em></dt>
<dd>An email address for sending job information to.</dd>
<dt>pair_coeffs_included: <em>bool, optional</em></dt>
<dd>Whether we have included the pair coefficients to be written
to our lammps data file.</dd>
<dt>hybrid_pair: <em>bool, optional</em></dt>
<dd>Whether to detect different treatments of pairing interactions
amongst different atom types(True), or not (False).</dd>
<dt>hybrid_angle: <em>bool, optional</em></dt>
<dd>Whether to detect different treatments of angles amongst different
atom types (True), or not (False).</dd>
<dt>TIP4P: <em>bool, optional</em></dt>
<dd>Whether to identify TIP4P settings within the lammps data file and
update the input file (True), or not (False).</dd>
<dt>no_echo: <em>bool, optional</em></dt>
<dd>Whether to pipe the terminal output to a file instead of printing.</dd>
<dt>redundancy: <em>bool, optional</em></dt>
<dd>With redundancy on, if the job is submitted and unique_name is on, then
if another job of the same name is running, a pointer to that job will
instead be returned.</dd>
<dt>lmp_path: <em>str, optional</em></dt>
<dd>The path to the lammps executable. Note, by default this is the
one defined during installation, saved in sysconst.lmp_path.</dd>
<dt>slurm_allocation: <em>str, optional</em></dt>
<dd>Whether to use a slurm allocation for this job or not.  If so, specify the name.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>job: <a class="reference internal" href="#jobs.Job" title="jobs.Job"><code class="xref py py-class docutils literal notranslate"><span class="pre">jobs.Job</span></code></a></dt>
<dd>If running locally, return the process handle, else return the
job container.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="class">
<dt id="lammps_job.lmp_task">
<em class="property">class </em><code class="descclassname">lammps_job.</code><code class="descname">lmp_task</code><span class="sig-paren">(</span><em>task_name</em>, <em>system=None</em>, <em>queue=None</em>, <em>procs=1</em>, <em>mem=1000</em>, <em>priority=None</em>, <em>xhosts=None</em>, <em>callback=None</em>, <em>no_echo=True</em>, <em>persist_system=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lammps_job.html#lmp_task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lammps_job.lmp_task" title="Permalink to this definition">¶</a></dt>
<dd><p>The LAMMPs task object for JOUST.  This allows for the automation of some
workflows.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>task_name: <em>str</em></dt>
<dd>The name of this task.</dd>
<dt>system: <a class="reference internal" href="#structures.System" title="structures.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.System</span></code></a></dt>
<dd>A system object to be used for this simulation.</dd>
<dt>queue: <em>str, optional</em></dt>
<dd>Queue you are submitting to (queueing system dependent).</dd>
<dt>procs: <em>int, optional</em></dt>
<dd>Number of processors requested.</dd>
<dt>mem: <em>float, optional</em></dt>
<dd>Amount of memory you’re requesting.</dd>
<dt>priority: <em>int, optional</em></dt>
<dd>Priority of the simulation (queueing system dependent).  Priority
ranges (in NBS) from a low of 1 (start running whenever) to a
high of 255 (start running ASAP).</dd>
<dt>xhosts: <em>list, str or str, optional</em></dt>
<dd>Which processors you want to run the job on.</dd>
<dt>callback: <em>func, optional</em></dt>
<dd>A function to be run at the end of the task (only if conditional
is not met).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>task: <em>task</em></dt>
<dd>This task object.</dd>
</dl>
</div></blockquote>
<dl class="method">
<dt id="lammps_job.lmp_task.read_results">
<code class="descname">read_results</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lammps_job.html#lmp_task.read_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lammps_job.lmp_task.read_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the output of the simulation that was just run.</p>
<p>** Returns**</p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="lammps_job.lmp_task.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lammps_job.html#lmp_task.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lammps_job.lmp_task.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Start the LAMMPs simulation specified by this task.</p>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>sim_handle: <a class="reference internal" href="#jobs.Job" title="jobs.Job"><code class="xref py py-class docutils literal notranslate"><span class="pre">jobs.Job</span></code></a></dt>
<dd>A Job container for the simulation that was submitted.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="lammps_job.lmp_task.set_parameters">
<code class="descname">set_parameters</code><span class="sig-paren">(</span><em>input_script</em>, <em>email=None</em>, <em>pair_coeffs_included=True</em>, <em>hybrid_pair=False</em>, <em>hybrid_angle=False</em>, <em>trj_file=''</em>, <em>xyz_file=''</em>, <em>read_atoms=True</em>, <em>read_timesteps=True</em>, <em>read_num_atoms=True</em>, <em>read_box_bounds=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lammps_job.html#lmp_task.set_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lammps_job.lmp_task.set_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Set parameters for the LAMMPs task.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>input_script: <em>str</em></dt>
<dd>Input script for LAMMPs simulation.</dd>
<dt>email: <em>str, optional</em></dt>
<dd>An email address for sending job information to.</dd>
<dt>pair_coeffs_included: <em>bool, optional</em></dt>
<dd>Whether we have included the pair coefficients to be written
to our lammps data file.</dd>
<dt>hybrid_pair: <em>bool, optional</em></dt>
<dd>Whether to detect different treatments of pairing interactions
amongs different atom types(True), or not (False).</dd>
<dt>hybrid_angle: <em>bool, optional</em></dt>
<dd>Whether to detect different treatments of angles amongst
different atom types (True), or not (False).</dd>
<dt>trj_file: <em>str, optional</em></dt>
<dd>Pass the path to a lammps trajectory file.  Relative paths
are assumed to be in a
subfolder “lammps/RUN_NAME/RUN_NAME.lammpstrj”.</dd>
<dt>read_atoms: <em>bool, optional</em></dt>
<dd>Whether to read in the atom information.</dd>
<dt>read_timesteps: <em>bool, optional</em></dt>
<dd>Whether to read in the timesteps (True), or not (False).</dd>
<dt>read_num_atoms: <em>bool, optional</em></dt>
<dd>Whether to read in the number of atoms (True), or not (False).</dd>
<dt>read_box_bounds: <em>bool, optional</em></dt>
<dd>Whether to read in the system box boundaries (True), or
not (False).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="lammps_job.read">
<code class="descclassname">lammps_job.</code><code class="descname">read</code><span class="sig-paren">(</span><em>run_name</em>, <em>trj_file=''</em>, <em>xyz_file=''</em>, <em>read_atoms=True</em>, <em>read_timesteps=True</em>, <em>read_num_atoms=True</em>, <em>read_box_bounds=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lammps_job.html#read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lammps_job.read" title="Permalink to this definition">¶</a></dt>
<dd><p>General read in of thermo information from a lammps log file,
as well as (optionally) a lammps trajectory file (.lammpstrj).</p>
<p>NOTE! This is important. If you plan to use this function, you
MUST have “Step” in your LAMMPs Thermo output.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>run_name: <em>str</em></dt>
<dd>Lammps .log file to be parsed.  Note, this is WITHOUT
the extension (ex. test_lmp instead of test_lmp.log).</dd>
<dt>trj_file: <em>str, optional</em></dt>
<dd>Pass the path to a lammps trajectory file.  Relative paths are
assumed to be in a subfolder”lammps/RUN_NAME/RUN_NAME.lammpstrj”.</dd>
<dt>xyz_file: <em>str, optional</em></dt>
<dd>Pass the path to a lammps xyz output.  Relative paths are
assumed to be in a subfolder “lammps/RUN_NAME/RUN_NAME.xyz”.</dd>
<dt>read_atoms: <em>bool, optional</em></dt>
<dd>Whether to read in the atom information.</dd>
<dt>read_timesteps: <em>bool, optional</em></dt>
<dd>Whether to read in the timesteps (True), or not (False).</dd>
<dt>read_num_atoms: <em>bool, optional</em></dt>
<dd>Whether to read in the number of atoms (True), or not (False).</dd>
<dt>read_box_bounds: <em>bool, optional</em></dt>
<dd>Whether to read in the system box boundaries (True), or
not (False).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>lg:</dt>
<dd>Lammps log file, parsed.</dd>
<dt>data_trj:</dt>
<dd>Trajectory file, if it exists.</dd>
<dt>data_xyz:</dt>
<dd>XYZ file, if it exists.</dd>
</dl>
<p>NOTE! THE OUTPUT SHOULD BE:</p>
<dl class="docutils">
<dt>data: <a class="reference internal" href="#results.sim_out" title="results.sim_out"><code class="xref py py-class docutils literal notranslate"><span class="pre">results.sim_out</span></code></a></dt>
<dd>Generic LAMMPs output object containing all parsed results.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="lammps_job.read_TIP4P_types">
<code class="descclassname">lammps_job.</code><code class="descname">read_TIP4P_types</code><span class="sig-paren">(</span><em>data_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lammps_job.html#read_TIP4P_types"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lammps_job.read_TIP4P_types" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to find the TIP4P water atoms, bond and angle types in the lammps
data file. Returns an integer for each of the types. This method looks
for particular sequences, which may not be unique under certain
circumstances so it should be used with caution.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>data_file: <em>str</em></dt>
<dd>Lammps data file name.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>otype: <em>int</em></dt>
<dd>The lammps atom type for TIP4P oxygen.</dd>
<dt>htype: <em>int</em></dt>
<dd>The lammps atom type for TIP4P hydrogen.</dd>
<dt>btype: <em>int</em></dt>
<dd>The lammps atom type for TIP4P bond.</dd>
<dt>atype: <em>int</em></dt>
<dd>The lammps atom type for TIP4P angle.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="lammps_job.read_dump">
<code class="descclassname">lammps_job.</code><code class="descname">read_dump</code><span class="sig-paren">(</span><em>fptr, ext='.dump', coordinates=['x', 'y', 'z'], extras=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lammps_job.html#read_dump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lammps_job.read_dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read in a generic dump file.  Currently it (1) requires
element, x, y, z in the dump.  You can also use xu, yu, and zu if
the unwraped flag is set to True.</p>
<p>Due to individual preference, the extension was separated.  Thus,
if you dump to .xyz, have ext=”.xyz”, etc.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>fptr: <em>str</em></dt>
<dd>Name of the dump file with NO extension (ex. ‘run’ instead
of ‘run.dump’).  This can also be a relative path.  If no relative
path is given, and the file cannot be found, it will default
check in lammps/fptr/fptr+ext.</dd>
<dt>ext: <em>str, optional</em></dt>
<dd>The extension for the dump file.  Note, this is default “.dump”
but can be anything (ensure you have the “.”).</dd>
<dt>coordinates: <em>list, str, optional</em></dt>
<dd>A list of strings describing how the coordinates are
specified (x vs xs vs xu vs xsu)</dd>
<dt>extras: <em>list, str, optional</em></dt>
<dd>An additional list of things you want to read in from the dump
file.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list, list</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of lists, each holding atom structures.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="lammps_job.read_thermo">
<code class="descclassname">lammps_job.</code><code class="descname">read_thermo</code><span class="sig-paren">(</span><em>run_name</em>, <em>*properties</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lammps_job.html#read_thermo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lammps_job.read_thermo" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in thermo output from a lammps log file.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>run_name: <em>str</em></dt>
<dd>Lammps .log file to be parsed.  Note, this is WITHOUT the
extension (ex. test_lmp instead of test_lmp.log).</dd>
<dt>properties: <em>str</em></dt>
<dd>A sequence of lammps thermo keywords to be parsed, only used
when all is not required.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>lj: <a class="reference internal" href="#module-lammps_log" title="lammps_log"><code class="xref py py-class docutils literal notranslate"><span class="pre">lammps_log</span></code></a></div></blockquote>
</dd></dl>

<dl class="function">
<dt id="lammps_job.thermo_2_text">
<code class="descclassname">lammps_job.</code><code class="descname">thermo_2_text</code><span class="sig-paren">(</span><em>run_name</em>, <em>*properties</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lammps_job.html#thermo_2_text"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lammps_job.thermo_2_text" title="Permalink to this definition">¶</a></dt>
<dd><p>This will convert a lammps .log file to a parsed .txt file, isolating
the thermo output.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>run_name: <em>str</em></dt>
<dd>Lammps .log file to be parsed.  Note, this is WITHOUT the
extension (ex. test_lmp instead of test_lmp.log).</dd>
<dt>properties: <em>str</em></dt>
<dd>A sequence of lammps thermo keywords to minimize output .txt file.</dd>
</dl>
</div></blockquote>
<p><strong>Example</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">thermo_2_text</span><span class="p">(</span><span class="s2">&quot;test_run&quot;</span><span class="p">,</span> <span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;KE&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-lammps_log">
<span id="lammps-log"></span><h2>lammps_log<a class="headerlink" href="#module-lammps_log" title="Permalink to this headline">¶</a></h2>
<p>The lammps_log code is code from the pizza.py toolkit (www.cs.sandia.gov/~sjplimp/pizza.html) developed
by Steve Plimpton (<a class="reference external" href="mailto:sjplimp&#37;&#52;&#48;sandia&#46;gov">sjplimp<span>&#64;</span>sandia<span>&#46;</span>gov</a>) with some additional warning interspersed through the thermo
output.</p>
<ul class="simple">
<li><a class="reference internal" href="#module-lammps_log" title="lammps_log"><code class="xref py py-class docutils literal notranslate"><span class="pre">lammps_log</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="class">
<dt id="lammps_log.lammps_log">
<em class="property">class </em><code class="descclassname">lammps_log.</code><code class="descname">lammps_log</code><span class="sig-paren">(</span><em>*list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lammps_log.html#lammps_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lammps_log.lammps_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Class object to assist in parsing lammps outputs.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>list: <em>str</em></dt>
<dd>Path to the lammps log file that is to be parsed. Note, several files
can be included in this string as long as they are separated by spaces.</dd>
<dt>read_all: <em>int, optional</em></dt>
<dd>If this is set to 0, don’t read in the whole file upon initialization.
This lets you use the <a class="reference internal" href="#lammps_log.lammps_log.next" title="lammps_log.lammps_log.next"><code class="xref py py-func docutils literal notranslate"><span class="pre">next()</span></code></a> functionality.</dd>
</dl>
</div></blockquote>
<p><strong>Contains</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>nvec: <em>int</em></dt>
<dd>Number of vectors.</dd>
<dt>nlen: <em>int</em></dt>
<dd>Length of each vector.</dd>
<dt>names: <em>list, str</em></dt>
<dd>List of vector names.</dd>
<dt>ptr: <em>dict</em></dt>
<dd>Dictionary corresponding the thermo keys to which column of the output they
reside in. ptr[thermo_key] = which column this data is in</dd>
<dt>data: <em>list, list, float</em></dt>
<dd>Raw data from file, organized into 2d array.</dd>
<dt>style: <em>int</em></dt>
<dd>What style the LAMMPs log file is in. 1 = multi, 2 = one, 3 = gran</dd>
<dt>firststr: <em>str</em></dt>
<dd>String that begins a thermo section in log file.</dd>
<dt>increment: <em>int</em></dt>
<dd>1 if log file being read incrementally</dd>
<dt>eof: <em>int</em></dt>
<dd>ptr into incremental file for where to start next read</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>This <a class="reference internal" href="#module-lammps_log" title="lammps_log"><code class="xref py py-class docutils literal notranslate"><span class="pre">lammps_log</span></code></a> object.</div></blockquote>
<dl class="method">
<dt id="lammps_log.lammps_log.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>*keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lammps_log.html#lammps_log.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lammps_log.lammps_log.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Read specific values from thermo output.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>keys: <em>str</em></dt>
<dd>Which thermo outputs you want by ID.  Not, this is as many
requests as you want.  ex. l.get(“Time”, “KE”, …)</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>vecs: <em>list</em></dt>
<dd>Desired outputs.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="lammps_log.lammps_log.next">
<code class="descname">next</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lammps_log.html#lammps_log.next"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lammps_log.lammps_log.next" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the next line of thermo information from the file. Note, this is used
when two arguments are passed during initialization.</p>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>timestep: <em>int</em></dt>
<dd>The timestep of the parsed thermo output.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="lammps_log.lammps_log.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>*keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lammps_log.html#lammps_log.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lammps_log.lammps_log.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write parsed vectors to a file.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>filename: <em>str</em></dt>
<dd>The name of the file you want to dump all your outputs to.</dd>
<dt>keys: <em>str, optional</em></dt>
<dd>Which specific vectors you want output to the file.
ex. &gt;&gt;&gt; l.write(“file.txt”,”Time”, “KE”, …)</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-linux_helper">
<span id="linux-helper"></span><h2>linux_helper<a class="headerlink" href="#module-linux_helper" title="Permalink to this headline">¶</a></h2>
<p>The Linux Helper module contains functionality to aid linux users to automate some tasks.</p>
<ul class="simple">
<li><a class="reference internal" href="#linux_helper.clean_up_folder" title="linux_helper.clean_up_folder"><code class="xref py py-func docutils literal notranslate"><span class="pre">clean_up_folder()</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="function">
<dt id="linux_helper.clean_up_folder">
<code class="descclassname">linux_helper.</code><code class="descname">clean_up_folder</code><span class="sig-paren">(</span><em>path</em>, <em>files_to_remove=[]</em>, <em>remove_empty_folders=False</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/linux_helper.html#clean_up_folder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#linux_helper.clean_up_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Automate the removal of files from a linux system.  Given a parent directory, this will
recursively remove specified files.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>path: <em>str</em></dt>
<dd>Absolute path to the parent directory to be cleaned.</dd>
<dt>files_to_remove: <em>list, str, optional</em></dt>
<dd>List of files to be removed.  Wildcards can be used, thus [“<em>.txt”,”</em>.log”] would
delete every file with the .txt and .log extension.</dd>
<dt>remove_empty_folders: <em>bool, optional</em></dt>
<dd>Whether to remove empty folders (True), or not (False).</dd>
<dt>verbose: <em>bool, optional</em></dt>
<dd>Whether to output commands used (True), or not (False).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-neb">
<span id="neb"></span><h2>neb<a class="headerlink" href="#module-neb" title="Permalink to this headline">¶</a></h2>
<p>The NEB module simplifies the submission of Nudged Elastic Band simulations.</p>
<ul class="simple">
<li><a class="reference internal" href="#neb.g09_start_job" title="neb.g09_start_job"><code class="xref py py-func docutils literal notranslate"><span class="pre">g09_start_job()</span></code></a></li>
<li><a class="reference internal" href="#neb.g09_results" title="neb.g09_results"><code class="xref py py-func docutils literal notranslate"><span class="pre">g09_results()</span></code></a></li>
<li><a class="reference internal" href="#neb.orca_start_job" title="neb.orca_start_job"><code class="xref py py-func docutils literal notranslate"><span class="pre">orca_start_job()</span></code></a></li>
<li><a class="reference internal" href="#neb.orca_results" title="neb.orca_results"><code class="xref py py-func docutils literal notranslate"><span class="pre">orca_results()</span></code></a></li>
<li><a class="reference internal" href="#neb.NEB" title="neb.NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">NEB</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="class">
<dt id="neb.NEB">
<em class="property">class </em><code class="descclassname">neb.</code><code class="descname">NEB</code><span class="sig-paren">(</span><em>name</em>, <em>states</em>, <em>theory</em>, <em>extra_section=''</em>, <em>initial_guess=None</em>, <em>spring_atoms=None</em>, <em>procs=1</em>, <em>queue=None</em>, <em>mem=2000</em>, <em>priority=None</em>, <em>disp=0</em>, <em>k=0.00367453</em>, <em>charge=0</em>, <em>multiplicity=1</em>, <em>fit_rigid=True</em>, <em>DFT='orca'</em>, <em>opt='LBFGS'</em>, <em>start_job=None</em>, <em>get_results=None</em>, <em>new_opt_params={}</em>, <em>callback=None</em>, <em>ci_neb=False</em>, <em>ci_N=5</em>, <em>no_energy=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neb.html#NEB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neb.NEB" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for determining the minimum energy pathway of a reaction using
DFT. Note, this method was written for atomic orbital DFT codes; however,
is potentially generalizable to other programs.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>The name of the NEB simulation to be run.</dd>
<dt>states: <em>list, list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of frames, each frame being a list of atom structures.
These frames represent your reaction coordinate.</dd>
<dt>theory: <em>str</em></dt>
<dd>The route line for your DFT simulation.</dd>
<dt>extra_section: <em>str, optional</em></dt>
<dd>Additional parameters for your DFT simulation.</dd>
<dt>initial_guess: <em>list, str, optional</em></dt>
<dd>TODO - List of strings specifying a previously run NEB simulation,
allowing restart capabilities.</dd>
<dt>spring_atoms: <em>list, int, optional</em></dt>
<dd>Specify which atoms will be represented by virutal springs in the
NEB calculations. Default includes all.</dd>
<dt>procs: <em>int, optional</em></dt>
<dd>The number of processors for your simulation.</dd>
<dt>queue: <em>str, optional</em></dt>
<dd>Which queue you wish your simulation to run on (queueing system
dependent). When None, NEB is run locally.</dd>
<dt>mem: <em>float, optional</em></dt>
<dd>Specify memory constraints (specific to your X_start_job method).</dd>
<dt>priority: <em>int, optional</em></dt>
<dd>Whether to submit a DFT simulation with some given priority or not.</dd>
<dt>disp: <em>int, optional</em></dt>
<dd>Specify for additional stdout information.</dd>
<dt>charge: <em>int</em></dt>
<dd>Charge of the system.</dd>
<dt>multiplicity: <em>int</em></dt>
<dd>Multiplicity of the system.</dd>
<dt>k: <em>float, optional</em></dt>
<dd>The spring constant for your NEB simulation.</dd>
<dt>fit_rigid: <em>bool, optional</em></dt>
<dd>Whether you want to use procrustes to minimize motion between
adjacent frames (thus minimizing error due to excessive virtal
spring forces).</dd>
<dt>DFT: <em>str, optional</em></dt>
<dd>Specify if you wish to use the default X_start_job and X_results
functions where X is either g09 or orca.</dd>
<dt>opt: <em>str, optional</em></dt>
<dd>Select which optimization method you wish to use from the
following: BFGS, LBFGS, SD, FIRE, QM, CG, scipy_X. Note, if using
scipy_X, change X to be a valid scipy minimize method.</dd>
<dt>start_job: <em>func, optional</em></dt>
<dd>A function specifying how to submit your NEB single point
calculations.  Needed if DFT is neither orca nor g09.</dd>
<dt>get_results: <em>func, optional</em></dt>
<dd>A function specifying how to read your NEB single point
calculations.  Needed if DFT is neither orca nor g09.  Note, this
function returns two things: list of energies, list of atoms.
Further, the forces are contained within each atom object.  It also
requires that the forces on the state object be updated within said
function (for more info see example codes).  Finally, if using
no_energy=True, then return None (or an empty list) for the energies.</dd>
<dt>new_opt_params: <em>dict, optional</em></dt>
<dd>Pass any additional parameters to the optimization algorithm.</dd>
<dt>callback: <em>func, optional</em></dt>
<dd>A function to be run after each each to calculate().</dd>
<dt>ci_neb: <em>bool, optional</em></dt>
<dd>Whether to use the climbing image variation of NEB.</dd>
<dt>ci_N: <em>int, optional</em></dt>
<dd>How many iterations to wait in climbing image NEB before selecting
which image to be used.</dd>
<dt>no_energy: <em>bool, optional</em></dt>
<dd>A flag to turn on an experimental method, in which our selection
of the tangent is based on only the force, and not the energy.
Note, the code still expects the get_results function to return
two things, so just have it return (None, atoms + forces).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>This <a class="reference internal" href="#neb.NEB" title="neb.NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">NEB</span></code></a> object.</div></blockquote>
<p><strong>References</strong></p>
<blockquote>
<div><ul class="simple">
<li>Henkelman, G.; Jonsson, H. The Journal of Chemical Physics 2000,
113, 9978-9985.</li>
<li>Jonsson, H.; Mills, G.; Jacobson, K. W. In Classical and Quantum
Dynamics in Condensed Phase Simulations;</li>
<li>Berne, B. J., Ciccotti, G., Coker, D. F., Eds.; World Scientific,
1998; Chapter 16, pp 385-404.</li>
<li>Armijo, L. Pacific Journal of Mathematics 1966, 16.</li>
<li>Sheppard, D.; Terrell, R.; Henkelman, G. The Journal of Chemical
Physics 2008, 128.</li>
<li>Henkelman, G.; Uberuaga, B. P.; Jonsson, H. Journal of Chemical
Physics 2000, 113.</li>
<li>Atomic Simulation Environment - <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/">https://wiki.fysik.dtu.dk/ase/</a></li>
</ul>
</div></blockquote>
<dl class="method">
<dt id="neb.NEB.align_coordinates">
<code class="descname">align_coordinates</code><span class="sig-paren">(</span><em>r</em>, <em>B=None</em>, <em>H=None</em>, <em>return_matrix=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neb.html#NEB.align_coordinates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neb.NEB.align_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a rotation matrix A that will remove rigid rotation from the
new coordinates r.  Further, if another vector needs rotating by the
same matrix A, it should be passed in B and will be rotated.  If
a matrix also needs rotating, it can be passed as H and also be
rotated.</p>
<p><em>Parameters</em></p>
<blockquote>
<div><dl class="docutils">
<dt>r: <em>list, float</em></dt>
<dd>1D array of atomic coordinates to be rotated by procrustes
matrix A.</dd>
<dt>B: <em>list, list, float, optional</em></dt>
<dd>A list of vectors that may also be rotated by the same matrix
as <em>r</em>.</dd>
<dt>H: <em>list, list, float, optional</em></dt>
<dd><dl class="first last docutils">
<dt>A matrix that should also be rotated via:</dt>
<dd>H = R * H * R.T</dd>
</dl>
</dd>
<dt>return_matrix: <em>bool, optional</em></dt>
<dd>Whether to also return the rotation matrix used or not.</dd>
</dl>
</div></blockquote>
<p><em>Returns</em></p>
<blockquote>
<div><dl class="docutils">
<dt>rotations: <em>dict</em></dt>
<dd>A dictionary holding ‘A’, the rotation matrix, ‘r’, the
rotated new coordinates, ‘B’, a list of all other vectors that
were rotated, and ‘H’, a rotated matrix.</dd>
</dl>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="neb.g09_results">
<code class="descclassname">neb.</code><code class="descname">g09_results</code><span class="sig-paren">(</span><em>NEB</em>, <em>step_to_use</em>, <em>i</em>, <em>state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neb.html#g09_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neb.g09_results" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for reading in the output of Gaussian09 single point calculations
for NEB calculations. This will both (a) assign forces to the atoms stored
in state and (b) return the energy and atoms.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>NEB: <a class="reference internal" href="#neb.NEB" title="neb.NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">NEB</span></code></a></dt>
<dd>An NEB container holding the main NEB simulation</dd>
<dt>step_to_use: <em>int</em></dt>
<dd>Which iteration in the NEB sequence the output to be read in is on.</dd>
<dt>i: <em>int</em></dt>
<dd>The index corresponding to which image on the frame is to be
simulated.</dd>
<dt>state: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms describing the image on the frame associated with
index <em>i</em>.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>new_energy: <em>float</em></dt>
<dd>The energy of the system in Hartree (Ha).</dd>
<dt>new_atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms with the forces attached in units of Hartree per
Angstrom (Ha/Ang).</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="neb.g09_start_job">
<code class="descclassname">neb.</code><code class="descname">g09_start_job</code><span class="sig-paren">(</span><em>NEB</em>, <em>i</em>, <em>state</em>, <em>charge</em>, <em>multiplicity</em>, <em>procs</em>, <em>queue</em>, <em>initial_guess</em>, <em>extra_section</em>, <em>mem</em>, <em>priority</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neb.html#g09_start_job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neb.g09_start_job" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for submitting a single point calculation using Gaussian09 for
NEB calculations.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>NEB: <a class="reference internal" href="#neb.NEB" title="neb.NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">NEB</span></code></a></dt>
<dd>An NEB container holding the main NEB simulation</dd>
<dt>i: <em>int</em></dt>
<dd>The index corresponding to which image on the frame is to be
simulated.</dd>
<dt>state: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms describing the image on the frame associated
with index <em>i</em>.</dd>
<dt>charge: <em>int</em></dt>
<dd>Charge of the system.</dd>
<dt>multiplicity: <em>int</em></dt>
<dd>Multiplicity of the system.</dd>
<dt>procs: <em>int</em></dt>
<dd>The number of processors to use during calculations.</dd>
<dt>queue: <em>str</em></dt>
<dd>Which queue to submit the simulation to (this is queueing system
dependent).</dd>
<dt>initial_guess: <em>str</em></dt>
<dd>The name of a previous simulation for which we can read in a
hessian.</dd>
<dt>extra_section: <em>str</em></dt>
<dd>Extra settings for this DFT method.</dd>
<dt>mem: <em>int</em></dt>
<dd>How many Mega Words (MW) you wish to have as dynamic memory.</dd>
<dt>priority: <em>int</em></dt>
<dd>Whether to submit the job with a given priority (NBS). Not setup for
this function yet.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>g09_job: <a class="reference internal" href="#jobs.Job" title="jobs.Job"><code class="xref py py-class docutils literal notranslate"><span class="pre">jobs.Job</span></code></a></dt>
<dd>A job container holding the g09 simulation.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="neb.orca_results">
<code class="descclassname">neb.</code><code class="descname">orca_results</code><span class="sig-paren">(</span><em>NEB</em>, <em>step_to_use</em>, <em>i</em>, <em>state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neb.html#orca_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neb.orca_results" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for reading in the output of Orca single point calculations for
NEB calculations. This will both (a) assign forces to the atoms stored
in state and (b) return the energy and atoms.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>NEB: <a class="reference internal" href="#neb.NEB" title="neb.NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">NEB</span></code></a></dt>
<dd>An NEB container holding the main NEB simulation</dd>
<dt>step_to_use: <em>int</em></dt>
<dd>Which iteration in the NEB sequence the output to be read in is on.</dd>
<dt>i: <em>int</em></dt>
<dd>The index corresponding to which image on the frame is to be
simulated.</dd>
<dt>state: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms describing the image on the frame associated with
index <em>i</em>.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>new_energy: <em>float</em></dt>
<dd>The energy of the system in Hartree (Ha).</dd>
<dt>new_atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms with the forces attached in units of Hartree per
Angstrom (Ha/Ang).</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="neb.orca_start_job">
<code class="descclassname">neb.</code><code class="descname">orca_start_job</code><span class="sig-paren">(</span><em>NEB</em>, <em>i</em>, <em>state</em>, <em>charge</em>, <em>multiplicity</em>, <em>procs</em>, <em>queue</em>, <em>initial_guess</em>, <em>extra_section</em>, <em>mem</em>, <em>priority</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neb.html#orca_start_job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neb.orca_start_job" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for submitting a single point calculation using Orca for NEB
calculations.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>NEB: <a class="reference internal" href="#neb.NEB" title="neb.NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">NEB</span></code></a></dt>
<dd>An NEB container holding the main NEB simulation</dd>
<dt>i: <em>int</em></dt>
<dd>The index corresponding to which image on the frame is to be
simulated.</dd>
<dt>state: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms describing the image on the frame associated with
index <em>i</em>.</dd>
<dt>charge: <em>int</em></dt>
<dd>Charge of the system.</dd>
<dt>multiplicity: <em>int</em></dt>
<dd>Multiplicity of the system.</dd>
<dt>procs: <em>int</em></dt>
<dd>The number of processors to use during calculations.</dd>
<dt>queue: <em>str</em></dt>
<dd>Which queue to submit the simulation to (this is queueing system
dependent).</dd>
<dt>initial_guess: <em>str</em></dt>
<dd>The name of a previous simulation for which we can read in a
hessian.</dd>
<dt>extra_section: <em>str</em></dt>
<dd>Extra settings for this DFT method.</dd>
<dt>mem: <em>int</em></dt>
<dd>How many MegaBytes (MB) of memory you have available per core.</dd>
<dt>priority: <em>int</em></dt>
<dd>Whether to submit to NBS with a given priority</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>orca_job: <a class="reference internal" href="#jobs.Job" title="jobs.Job"><code class="xref py py-class docutils literal notranslate"><span class="pre">jobs.Job</span></code></a></dt>
<dd>A job container holding the orca simulation.</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="optimizers">
<h2>optimizers<a class="headerlink" href="#optimizers" title="Permalink to this headline">¶</a></h2>
<p>The optimizers module contains various functions aiding in optimization.
Several of these approaches are founded on methods within scipy with
minor alterations made.</p>
<ul class="simple">
<li><a class="reference internal" href="#module-steepest_descent" title="steepest_descent"><code class="xref py py-func docutils literal notranslate"><span class="pre">steepest_descent()</span></code></a></li>
<li><a class="reference internal" href="#module-bfgs" title="bfgs"><code class="xref py py-func docutils literal notranslate"><span class="pre">bfgs()</span></code></a></li>
<li><a class="reference internal" href="#module-lbfgs" title="lbfgs"><code class="xref py py-func docutils literal notranslate"><span class="pre">lbfgs()</span></code></a></li>
<li><a class="reference internal" href="#module-quick_min" title="quick_min"><code class="xref py py-func docutils literal notranslate"><span class="pre">quick_min()</span></code></a></li>
<li><a class="reference internal" href="#module-fire" title="fire"><code class="xref py py-func docutils literal notranslate"><span class="pre">fire()</span></code></a></li>
<li><a class="reference internal" href="#module-conjugate_gradient" title="conjugate_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">conjugate_gradient()</span></code></a></li>
</ul>
<hr class="docutils" />
<span class="target" id="module-steepest_descent"></span><dl class="function">
<dt id="steepest_descent.steepest_descent">
<code class="descclassname">steepest_descent.</code><code class="descname">steepest_descent</code><span class="sig-paren">(</span><em>params</em>, <em>gradient</em>, <em>NEB_obj=None</em>, <em>new_opt_params={}</em>, <em>extra_args_gradient=None</em>, <em>extra_args_target=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/steepest_descent.html#steepest_descent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#steepest_descent.steepest_descent" title="Permalink to this definition">¶</a></dt>
<dd><p>A steepest descent optimizer, overloaded for NEB use.</p>
<p><em>Parameters</em></p>
<blockquote>
<div><dl class="docutils">
<dt>params: <em>list, float</em></dt>
<dd>A list of parameters to be optimized.</dd>
<dt>gradient: <em>func</em></dt>
<dd>A function that, given params, returns the gradient.</dd>
<dt>NEB_obj: <a class="reference internal" href="#neb.NEB" title="neb.NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">neb.NEB</span></code></a></dt>
<dd>An NEB object to use.</dd>
<dt>new_opt_params: <em>dict</em></dt>
<dd><p class="first">A dictionary holding any changes to the optimization algorithm’s
parameters.  This includes the following -</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>step_size: <em>float</em></dt>
<dd>Step size to take.</dd>
<dt>step_size_adjustment: <em>float</em></dt>
<dd>A factor to adjust step_size when a bad step is made.</dd>
<dt>max_step: <em>float</em></dt>
<dd>A maximum allowable step length. If 0, any step is ok.</dd>
<dt>target_function: <em>func</em></dt>
<dd>A function that will help decide if backtracking is needed
or not.  This function will be used to verify BFGS is
minimizing.  If nothing is passed, but NEB_obj is not None,
the NEB_obj.get_error function will be called.</dd>
<dt>armijo_line_search_factor: <em>float</em></dt>
<dd>A factor for the armijo line search.</dd>
<dt>linesearch: <em>str</em></dt>
<dd>Whether to use the <em>armijo</em> or <em>backtrack</em> linesearch
method.  If None is passed, a static step_size is used.</dd>
<dt>reset_when_in_trouble: <em>bool</em></dt>
<dd>Whether to reset the Hessian to Identity when bad steps
have been taken.</dd>
<dt>reset_step_size: <em>int</em></dt>
<dd>How many iterations of ‘good’ steps to take before
resetting step_size to its initial value.</dd>
<dt>accelerate: <em>bool</em></dt>
<dd>Whether to accelerate via increasing step_size by
1/step_size_adjustment when no bad steps are taken after
<em>reset_step_size</em> iterations.</dd>
<dt>maxiter: <em>int</em></dt>
<dd>Maximum number of iterations for the optimizer to run.
If None, then the code runs indefinitely.</dd>
<dt>g_rms: <em>float</em></dt>
<dd>The RMS value for which to optimize the gradient to.</dd>
<dt>g_max: <em>float</em></dt>
<dd>The maximum gradient value to be allowed.</dd>
<dt>fit_rigid: <em>bool</em></dt>
<dd>Remove erroneous rotation and translations during NEB.</dd>
<dt>dimensions: <em>int</em></dt>
<dd>The number of dimensions for the optimizer to run in.
By default this is 3 (for NEB atomic coordinates.)</dd>
<dt>callback: <em>func, optional</em></dt>
<dd>A function to be run after each optimization loop.</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
<p><em>Returns</em></p>
<blockquote>
<div><dl class="docutils">
<dt>params: <em>list, float</em></dt>
<dd>A list of the optimized parameters.</dd>
<dt>code: <em>int</em></dt>
<dd>An integer describing how the algorithm converged.  This can be
identified in the constants file.</dd>
<dt>iters: <em>int</em></dt>
<dd>The number of iterations the optimizer ran for.</dd>
</dl>
</div></blockquote>
</dd></dl>

<span class="target" id="module-bfgs"></span><dl class="function">
<dt id="bfgs.bfgs">
<code class="descclassname">bfgs.</code><code class="descname">bfgs</code><span class="sig-paren">(</span><em>params</em>, <em>gradient</em>, <em>NEB_obj=None</em>, <em>new_opt_params={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bfgs.html#bfgs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bfgs.bfgs" title="Permalink to this definition">¶</a></dt>
<dd><p>A Broyden-Fletcher-Goldfarb-Shanno optimizer, overloaded for NEB use.</p>
<p><em>Parameters</em></p>
<blockquote>
<div><dl class="docutils">
<dt>params: <em>list, float</em></dt>
<dd>A list of parameters to be optimized.</dd>
<dt>gradient: <em>func</em></dt>
<dd>A function that, given params, returns the gradient.</dd>
<dt>NEB_obj: <a class="reference internal" href="#neb.NEB" title="neb.NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">neb.NEB</span></code></a></dt>
<dd>An NEB object to use.</dd>
<dt>new_opt_params: <em>dict</em></dt>
<dd><p class="first">A dictionary holding any changes to the optimization algorithm’s
parameters.  This includes the following -</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>step_size: <em>float</em></dt>
<dd>Step size to take.</dd>
<dt>step_size_adjustment: <em>float</em></dt>
<dd>A factor to adjust step_size when a bad step is made.</dd>
<dt>max_step: <em>float</em></dt>
<dd>A maximum allowable step length. If 0, any step is ok.</dd>
<dt>target_function: <em>func</em></dt>
<dd>A function that will help decide if backtracking is needed
or not.  This function will be used to verify BFGS is
minimizing.  If nothing is passed, but NEB_obj is not None,
the NEB_obj.get_error function will be called.</dd>
<dt>armijo_line_search_factor: <em>float</em></dt>
<dd>A factor for the armijo line search.</dd>
<dt>linesearch: <em>str</em></dt>
<dd>Whether to use the <em>armijo</em> or <em>backtrack</em> linesearch
method.  If None is passed, a static step_size is used.</dd>
<dt>reset_when_in_trouble: <em>bool</em></dt>
<dd>Whether to reset the Hessian to Identity when bad steps
have been taken.</dd>
<dt>reset_step_size: <em>int</em></dt>
<dd>How many iterations of ‘good’ steps to take before
resetting step_size to its initial value.</dd>
<dt>N_reset_hess: <em>int</em></dt>
<dd>A hard reset to the hessian to be applied every N
iterations.</dd>
<dt>start_hess: <em>int, float, or matrix</em></dt>
<dd>A starting matrix to use instead of the identity.  If an
integer or float is passed, then the starting hessian is
a scaled identity matrix.</dd>
<dt>use_numopt_start: <em>bool</em></dt>
<dd>Whether to use the starting hessian guess laid out by
Nocedal and Wright in the Numerical Operations textbook,
page 178.  H0 = (&lt;y|s&gt;) / (&lt;y|y&gt;) * I.  If chosen,
start_hess is set to the identity matrix.</dd>
<dt>accelerate: <em>bool</em></dt>
<dd>Whether to accelerate via increasing step_size by
1/step_size_adjustment when no bad steps are taken after
<em>reset_step_size</em> iterations.</dd>
<dt>maxiter: <em>int</em></dt>
<dd>Maximum number of iterations for the optimizer to run.
If None, then the code runs indefinitely.</dd>
<dt>g_rms: <em>float</em></dt>
<dd>The RMS value for which to optimize the gradient to.</dd>
<dt>g_max: <em>float</em></dt>
<dd>The maximum gradient value to be allowed.</dd>
<dt>fit_rigid: <em>bool</em></dt>
<dd>Remove erroneous rotation and translations during NEB.</dd>
<dt>dimensions: <em>int</em></dt>
<dd>The number of dimensions for the optimizer to run in.
By default this is 3 (for NEB atomic coordinates.)</dd>
<dt>callback: <em>func, optional</em></dt>
<dd>A function to be run after each optimization loop.</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
<p><em>Returns</em></p>
<blockquote>
<div><dl class="docutils">
<dt>params: <em>list, float</em></dt>
<dd>A list of the optimized parameters.</dd>
<dt>code: <em>int</em></dt>
<dd>An integer describing how the algorithm converged.  This can be
identified in the constants file.</dd>
<dt>iters: <em>int</em></dt>
<dd>The number of iterations the optimizer ran for.</dd>
</dl>
</div></blockquote>
</dd></dl>

<span class="target" id="module-lbfgs"></span><dl class="function">
<dt id="lbfgs.lbfgs">
<code class="descclassname">lbfgs.</code><code class="descname">lbfgs</code><span class="sig-paren">(</span><em>params</em>, <em>gradient</em>, <em>NEB_obj=None</em>, <em>new_opt_params={}</em>, <em>extra_args_gradient=None</em>, <em>extra_args_target=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lbfgs.html#lbfgs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lbfgs.lbfgs" title="Permalink to this definition">¶</a></dt>
<dd><p>A Limited Memory Broyden-Fletcher-Goldfarb-Shanno optimizer, overloaded
for NEB use.</p>
<p><em>Parameters</em></p>
<blockquote>
<div><dl class="docutils">
<dt>params: <em>list, float</em></dt>
<dd>A list of parameters to be optimized.</dd>
<dt>gradient: <em>func</em></dt>
<dd>A function that, given params, returns the gradient.</dd>
<dt>NEB_obj: <a class="reference internal" href="#neb.NEB" title="neb.NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">neb.NEB</span></code></a></dt>
<dd>An NEB object to use.</dd>
<dt>new_opt_params: <em>dict</em></dt>
<dd><p class="first">A dictionary holding any changes to the optimization algorithm’s
parameters.  This includes the following -</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>step_size: <em>float</em></dt>
<dd>Step size to take.</dd>
<dt>step_size_adjustment: <em>float</em></dt>
<dd>A factor to adjust step_size when a bad step is made.</dd>
<dt>max_step: <em>float</em></dt>
<dd>A maximum allowable step length. If 0, any step is ok.</dd>
<dt>max_steps_remembered: <em>int</em></dt>
<dd>The maximum number of previous iterations to save.</dd>
<dt>target_function: <em>func</em></dt>
<dd>A function that will help decide if backtracking is needed
or not.  This function will be used to verify LBFGS is
minimizing.  If nothing is passed, but NEB_obj is not None,
the NEB_obj.get_error function will be called.</dd>
<dt>armijo_line_search_factor: <em>float</em></dt>
<dd>A factor for the armijo line search.</dd>
<dt>linesearch: <em>str</em></dt>
<dd>Whether to use the <em>armijo</em> or <em>backtrack</em> linesearch
method.  If None is passed, a static step_size is used.</dd>
<dt>reset_when_in_trouble: <em>bool</em></dt>
<dd>Whether to reset the stored parameters and gradients when a
bad step has been taken.</dd>
<dt>reset_step_size: <em>int</em></dt>
<dd>How many iterations of ‘good’ steps to take before
resetting step_size to its initial value.</dd>
<dt>N_reset_hess: <em>int</em></dt>
<dd>A hard reset to the hessian to be applied every N
iterations.</dd>
<dt>start_hess: <em>int, float, or matrix</em></dt>
<dd>A starting integer or float to scale the starting hessian.</dd>
<dt>use_numopt_start: <em>bool</em></dt>
<dd>Whether to use the starting hessian guess laid out by
Nocedal and Wright in the Numerical Operations textbook,
page 178.  H0 = (&lt;y|s&gt;) / (&lt;y|y&gt;) * I.  If chosen,
start_hess is set to the identity matrix.</dd>
<dt>accelerate: <em>bool</em></dt>
<dd>Whether to accelerate via increasing step_size by
1/step_size_adjustment when no bad steps are taken after
<em>reset_step_size</em> iterations.</dd>
<dt>maxiter: <em>int</em></dt>
<dd>Maximum number of iterations for the optimizer to run.
If None, then the code runs indefinitely.</dd>
<dt>g_rms: <em>float</em></dt>
<dd>The RMS value for which to optimize the gradient to.</dd>
<dt>g_max: <em>float</em></dt>
<dd>The maximum gradient value to be allowed.</dd>
<dt>fit_rigid: <em>bool</em></dt>
<dd>Remove erroneous rotation and translations during NEB.</dd>
<dt>dimensions: <em>int</em></dt>
<dd>The number of dimensions for the optimizer to run in.
By default this is 3 (for NEB atomic coordinates.)</dd>
<dt>callback: <em>func, optional</em></dt>
<dd>A function to be run after each optimization loop.</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
<p><em>Returns</em></p>
<blockquote>
<div><dl class="docutils">
<dt>params: <em>list, float</em></dt>
<dd>A list of the optimized parameters.</dd>
<dt>code: <em>int</em></dt>
<dd>An integer describing how the algorithm converged.  This can be
identified in the constants file.</dd>
<dt>iters: <em>int</em></dt>
<dd>The number of iterations the optimizer ran for.</dd>
</dl>
</div></blockquote>
</dd></dl>

<span class="target" id="module-quick_min"></span><dl class="function">
<dt id="quick_min.quick_min">
<code class="descclassname">quick_min.</code><code class="descname">quick_min</code><span class="sig-paren">(</span><em>params</em>, <em>gradient</em>, <em>NEB_obj=None</em>, <em>new_opt_params={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quick_min.html#quick_min"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quick_min.quick_min" title="Permalink to this definition">¶</a></dt>
<dd><p>A quick min optimizer, overloaded for NEB use.
Note, this will ONLY work for use within the NEB code.</p>
<p><em>Parameters</em></p>
<blockquote>
<div><dl class="docutils">
<dt>params: <em>list, float</em></dt>
<dd>A list of parameters to be optimized.</dd>
<dt>gradient: <em>func</em></dt>
<dd>A function that, given params, returns the gradient.</dd>
<dt>NEB_obj: <a class="reference internal" href="#neb.NEB" title="neb.NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">neb.NEB</span></code></a></dt>
<dd>An NEB object to use.</dd>
<dt>new_opt_params: <em>dict</em></dt>
<dd><p class="first">A dictionary holding any changes to the optimization algorithm’s
parameters.  This includes the following -</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>dt: <em>float</em></dt>
<dd>Time step size to take.</dd>
<dt>max_step: <em>float</em></dt>
<dd>The maximum step size to take.</dd>
<dt>viscosity: <em>float</em></dt>
<dd>The viscosity within a verlet step (used if euler is
False).</dd>
<dt>euler: <em>bool</em></dt>
<dd>Whether to make an euler step or not.</dd>
<dt>maxiter: <em>int</em></dt>
<dd>Maximum number of iterations for the optimizer to run.
If None, then the code runs indefinitely.</dd>
<dt>g_rms: <em>float</em></dt>
<dd>The RMS value for which to optimize the gradient to.</dd>
<dt>g_max: <em>float</em></dt>
<dd>The maximum gradient value to be allowed.</dd>
<dt>fit_rigid: <em>bool</em></dt>
<dd>Remove erroneous rotation and translations during NEB.</dd>
<dt>verbose: <em>bool</em></dt>
<dd>Whether to have additional output.</dd>
<dt>callback: <em>func, optional</em></dt>
<dd>A function to be run after each optimization loop.</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
<p><em>Returns</em></p>
<blockquote>
<div><dl class="docutils">
<dt>params: <em>list, float</em></dt>
<dd>A list of the optimized parameters.</dd>
<dt>code: <em>int</em></dt>
<dd>An integer describing how the algorithm converged.  This can be
identified in the constants file.</dd>
<dt>iters: <em>int</em></dt>
<dd>The number of iterations the optimizer ran for.</dd>
</dl>
</div></blockquote>
</dd></dl>

<span class="target" id="module-fire"></span><dl class="function">
<dt id="fire.fire">
<code class="descclassname">fire.</code><code class="descname">fire</code><span class="sig-paren">(</span><em>params</em>, <em>gradient</em>, <em>NEB_obj=None</em>, <em>new_opt_params={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fire.html#fire"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fire.fire" title="Permalink to this definition">¶</a></dt>
<dd><p>A FIRE optimizer, overloaded for NEB use.</p>
<p><em>Parameters</em></p>
<blockquote>
<div><dl class="docutils">
<dt>params: <em>list, float</em></dt>
<dd>A list of parameters to be optimized.</dd>
<dt>gradient: <em>func</em></dt>
<dd>A function that, given params, returns the gradient.</dd>
<dt>NEB_obj: <a class="reference internal" href="#neb.NEB" title="neb.NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">neb.NEB</span></code></a></dt>
<dd>An NEB object to use.</dd>
<dt>new_opt_params: <em>dict</em></dt>
<dd><p class="first">A dictionary holding any changes to the optimization algorithm’s
parameters.  This includes the following -</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>dt: <em>float</em></dt>
<dd>Time step size to take.</dd>
<dt>dtmax: <em>float, optional</em></dt>
<dd>The maximum dt allowed.</dd>
<dt>max_step: <em>float</em></dt>
<dd>The maximum step size to take.</dd>
<dt>Nmin: <em>int, optional</em></dt>
<dd>The minimum number of steps before acceleration occurs.</dd>
<dt>finc: <em>float, optional</em></dt>
<dd>The factor by which dt increases.</dd>
<dt>fdec: <em>float, optional</em></dt>
<dd>The factor by which dt decreases.</dd>
<dt>astart: <em>float, optional</em></dt>
<dd>The starting acceleration.</dd>
<dt>fa: <em>float, optional</em></dt>
<dd>The factor by which the acceleration is scaled.</dd>
<dt>viscosity: <em>float</em></dt>
<dd>The viscosity within a verlet step (used if euler is
False).</dd>
<dt>euler: <em>bool</em></dt>
<dd>Whether to make an euler step or not.</dd>
<dt>maxiter: <em>int</em></dt>
<dd>Maximum number of iterations for the optimizer to run.
If None, then the code runs indefinitely.</dd>
<dt>g_rms: <em>float</em></dt>
<dd>The RMS value for which to optimize the gradient to.</dd>
<dt>g_max: <em>float</em></dt>
<dd>The maximum gradient value to be allowed.</dd>
<dt>fit_rigid: <em>bool</em></dt>
<dd>Remove erroneous rotation and translations during NEB.</dd>
<dt>callback: <em>func, optional</em></dt>
<dd>A function to be run after each optimization loop.</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
<p><em>Returns</em></p>
<blockquote>
<div><dl class="docutils">
<dt>params: <em>list, float</em></dt>
<dd>A list of the optimized parameters.</dd>
<dt>code: <em>int</em></dt>
<dd>An integer describing how the algorithm converged.  This can be
identified in the constants file.</dd>
<dt>iters: <em>int</em></dt>
<dd>The number of iterations the optimizer ran for.</dd>
</dl>
</div></blockquote>
</dd></dl>

<span class="target" id="module-conjugate_gradient"></span><dl class="function">
<dt id="conjugate_gradient.conjugate_gradient">
<code class="descclassname">conjugate_gradient.</code><code class="descname">conjugate_gradient</code><span class="sig-paren">(</span><em>params</em>, <em>gradient</em>, <em>NEB_obj=None</em>, <em>new_opt_params={}</em>, <em>extra_args_gradient=None</em>, <em>extra_args_target=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/conjugate_gradient.html#conjugate_gradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#conjugate_gradient.conjugate_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>A conjugate gradient optimizer, overloaded for NEB use.</p>
<p><em>Parameters</em></p>
<blockquote>
<div><dl class="docutils">
<dt>params: <em>list, float</em></dt>
<dd>A list of parameters to be optimized.</dd>
<dt>gradient: <em>func</em></dt>
<dd>A function that, given params and an abstract list of extra
arguments, returns the gradient.</dd>
<dt>NEB_obj: <a class="reference internal" href="#neb.NEB" title="neb.NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">neb.NEB</span></code></a></dt>
<dd>An NEB object to use.</dd>
<dt>new_opt_params: <em>dict</em></dt>
<dd><p class="first">A dictionary holding any changes to the optimization algorithm’s
parameters.  This includes the following -</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>step_size: <em>float</em></dt>
<dd>Step size to take.</dd>
<dt>step_size_adjustment: <em>float</em></dt>
<dd>A factor to adjust step_size when a bad step is made.</dd>
<dt>method: <em>str</em></dt>
<dd>Whether to use the Fletcher-Reeves (FR) method of
calculating beta, or the Polak-Ribiere (PR) method.</dd>
<dt>max_step: <em>float</em></dt>
<dd>A maximum allowable step length. If 0, any step is ok.</dd>
<dt>target_function: <em>func</em></dt>
<dd>A function that will help decide if backtracking is needed
or not.  This function will be used to verify BFGS is
minimizing.  If nothing is passed, but NEB_obj is not None,
the NEB_obj.get_error function will be called.</dd>
<dt>armijo_line_search_factor: <em>float</em></dt>
<dd>A factor for the armijo line search.</dd>
<dt>linesearch: <em>str</em></dt>
<dd>Whether to use the <em>armijo</em> or <em>backtrack</em> linesearch
method.  If None is passed, a static step_size is used.</dd>
<dt>reset_step_size: <em>int</em></dt>
<dd>How many iterations of ‘good’ steps to take before
resetting step_size to its initial value.</dd>
<dt>accelerate: <em>bool</em></dt>
<dd>Whether to accelerate via increasing step_size by
1/step_size_adjustment when no bad steps are taken after
<em>reset_step_size</em> iterations.</dd>
<dt>maxiter: <em>int</em></dt>
<dd>Maximum number of iterations for the optimizer to run.
If None, then the code runs indefinitely.</dd>
<dt>g_rms: <em>float</em></dt>
<dd>The RMS value for which to optimize the gradient to.</dd>
<dt>g_max: <em>float</em></dt>
<dd>The maximum gradient value to be allowed.</dd>
<dt>fit_rigid: <em>bool</em></dt>
<dd>Remove erroneous rotation and translations during NEB.</dd>
<dt>dimensions: <em>int</em></dt>
<dd>The number of dimensions for the optimizer to run in.
By default this is 3 (for NEB atomic coordinates.)</dd>
<dt>callback: <em>func, optional</em></dt>
<dd>A function to be run after each optimization loop.</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
<p><em>Returns</em></p>
<blockquote>
<div><dl class="docutils">
<dt>params: <em>list, float</em></dt>
<dd>A list of the optimized parameters.</dd>
<dt>code: <em>int</em></dt>
<dd>An integer describing how the algorithm converged.  This can be
identified in the constants file.</dd>
<dt>iters: <em>int</em></dt>
<dd>The number of iterations the optimizer ran for.</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-orca">
<span id="orca"></span><h2>orca<a class="headerlink" href="#module-orca" title="Permalink to this headline">¶</a></h2>
<p>The Orca module contains python functions for interfacing with the Orca DFT
software package.</p>
<ul class="simple">
<li><a class="reference internal" href="#orca.engrad_read" title="orca.engrad_read"><code class="xref py py-func docutils literal notranslate"><span class="pre">engrad_read()</span></code></a></li>
<li><a class="reference internal" href="#orca.gbw_to_cube" title="orca.gbw_to_cube"><code class="xref py py-func docutils literal notranslate"><span class="pre">gbw_to_cube()</span></code></a></li>
<li><a class="reference internal" href="#orca.job" title="orca.job"><code class="xref py py-func docutils literal notranslate"><span class="pre">job()</span></code></a></li>
<li><a class="reference internal" href="#orca.mo_analysis" title="orca.mo_analysis"><code class="xref py py-func docutils literal notranslate"><span class="pre">mo_analysis()</span></code></a></li>
<li><a class="reference internal" href="#orca.orca_task" title="orca.orca_task"><code class="xref py py-class docutils literal notranslate"><span class="pre">orca_task</span></code></a></li>
<li><a class="reference internal" href="#orca.pot_analysis" title="orca.pot_analysis"><code class="xref py py-func docutils literal notranslate"><span class="pre">pot_analysis()</span></code></a></li>
<li><a class="reference internal" href="#orca.read" title="orca.read"><code class="xref py py-func docutils literal notranslate"><span class="pre">read()</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="function">
<dt id="orca.engrad_read">
<code class="descclassname">orca.</code><code class="descname">engrad_read</code><span class="sig-paren">(</span><em>input_file</em>, <em>force='Ha/Bohr'</em>, <em>pos='Bohr'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/orca.html#engrad_read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#orca.engrad_read" title="Permalink to this definition">¶</a></dt>
<dd><p>General read in of all possible data from an Orca engrad file
(.orca.engrad).</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>input_file: <em>str</em></dt>
<dd>Orca .orca.engrad file to be parsed.</dd>
<dt>force: <em>str, optional</em></dt>
<dd>Units you want force to be returned in.</dd>
<dt>pos: <em>str, optional</em></dt>
<dd>Units you want position to be returned in.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of the final atomic state, with forces appended
to each atom.</dd>
<dt>energy: <em>float</em></dt>
<dd>The total energy of this simulation.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="orca.gbw_to_cube">
<code class="descclassname">orca.</code><code class="descname">gbw_to_cube</code><span class="sig-paren">(</span><em>name</em>, <em>mo</em>, <em>spin=0</em>, <em>grid=40</em>, <em>local=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/orca.html#gbw_to_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#orca.gbw_to_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Pipe in flags to orca_plot to generate a cube file for the given
molecular orbital.  Note, this is assumed to be running from the parent
directory (ie, gbw is in the orca/BASENAME/BASENAME.orca.gbw).</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>The base name of the gbw file.  Thus, ‘water’ instead of
‘water.orca.gbw’.</dd>
<dt>mo: <em>int</em></dt>
<dd>Which molecular orbital to generate the cube file for. Note,
this is 0 indexed.</dd>
<dt>spin: <em>int, optional</em></dt>
<dd>Whether to plot the alpha or beta (0 or 1) operator.</dd>
<dt>grid: <em>int, optional</em></dt>
<dd>The grid resolution, default being 40.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>mo_name: <em>str</em></dt>
<dd>The name of the output MO file.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="orca.job">
<code class="descclassname">orca.</code><code class="descname">job</code><span class="sig-paren">(</span><em>run_name</em>, <em>route</em>, <em>atoms=[]</em>, <em>extra_section=''</em>, <em>grad=False</em>, <em>queue=None</em>, <em>walltime='00:30:00'</em>, <em>sandbox=False</em>, <em>procs=1</em>, <em>ntasks=1</em>, <em>nodes=1</em>, <em>adjust_nodes=True</em>, <em>charge=None</em>, <em>multiplicity=None</em>, <em>charge_and_multiplicity='0 1'</em>, <em>redundancy=False</em>, <em>use_NBS_sandbox=False</em>, <em>unique_name=True</em>, <em>previous=None</em>, <em>mem=2000</em>, <em>priority=None</em>, <em>xhost=None</em>, <em>orca4=True</em>, <em>slurm_allocation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/orca.html#job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#orca.job" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper to submitting an Orca simulation.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>run_name: <em>str</em></dt>
<dd>Name of the simulation to be run.</dd>
<dt>route: <em>str</em></dt>
<dd>The DFT route line, containing the function, basis set, etc.
Note, if route=None and previous != None, the route from
the previous simulation will be used instead.</dd>
<dt>atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a> <em>,optional</em></dt>
<dd>A list of atoms for the simulation.  If this is an empty list, but
previous is used, then the last set of atomic coordinates from
the previous simulation will be used.</dd>
<dt>extra_section: <em>str, optional</em></dt>
<dd>Additional DFT simulation parameters.  If None and previous is
not None, then previous extra section is used.</dd>
<dt>grad: <em>bool, optional</em></dt>
<dd>Whether to force RunTyp Gradient.</dd>
<dt>queue: <em>str, optional</em></dt>
<dd>What queue to run the simulation on (queueing system dependent).</dd>
<dt>sandbox: <em>bool, optional</em></dt>
<dd>Whether to run the job in a sandbox or not.</dd>
<dt>use_NBS_sandbox: <em>bool, optional</em></dt>
<dd>Whether to use the NBS sandboxing headers (True), or manually copy
files (False).</dd>
<dt>procs: <em>int, optional</em></dt>
<dd>How many processors to run the simulation on.  Note, the actual
number requested by orca will be procs * ntasks.</dd>
<dt>ntasks: <em>int, optional</em></dt>
<dd>(For SLURM) The number of tasks this job will run, each task uses
procs number of cores.  Note, the actual number requested by orca
will be procs * ntasks.</dd>
<dt>nodes: <em>int, optional</em></dt>
<dd>(For SLURM) The number of nodes this job requires.  If requesting
ntasks * procs &lt; 24 * nodes, a warning is printed, as on MARCC
each node has only 24 cores.</dd>
<dt>adjust_nodes: <em>bool, optional</em></dt>
<dd>Whether to automatically calculate how many nodes is necessary
when the user underspecifies nodes.</dd>
<dt>charge: <em>float, optional</em></dt>
<dd>Charge of the system.  If this is used, then
charge_and_multiplicity is ignored. If multiplicity is used,
but charge is not, then default charge of 0 is chosen.</dd>
<dt>multiplicity: <em>int, optional</em></dt>
<dd>Multiplicity of the system.  If this is used, then
charge_and_multiplicity is ignored. If charge is used, but
multiplicity is not, then default multiplicity of 1 is chosen.</dd>
<dt>charge_and_multiplicity: <em>str, optional</em></dt>
<dd>Charge and multiplicity of the system.  If neither charge nor
multiplicity are specified, then both are grabbed from this
string.</dd>
<dt>redundancy: <em>bool, optional</em></dt>
<dd>With redundancy on, if the job is submitted and unique_name is on, then
if another job of the same name is running, a pointer to that job will
instead be returned.</dd>
<dt>unique_name: <em>bool, optional</em></dt>
<dd>Whether to force the requirement of a unique name or not.  NOTE! If
you submit simulations from the same folder, ensure that this is True
lest you have a redundancy problem! To overcome said issue, you can
set redundancy to True as well (but only if the simulation is truly
redundant).</dd>
<dt>previous: <em>str, optional</em></dt>
<dd>Name of a previous simulation for which to try reading in
information using the MORead method.</dd>
<dt>mem: <em>float, optional</em></dt>
<dd>Amount of memory per processor that is available (in MB).</dd>
<dt>priority: <em>int, optional</em></dt>
<dd>Priority of the simulation (queueing system dependent).  Priority
ranges (in NBS) from a low of 1 (start running whenever) to a
high of 255 (start running ASAP).</dd>
<dt>xhost: <em>list, str or str, optional</em></dt>
<dd>Which processor to run the simulation on(queueing system
dependent).</dd>
<dt>orca4: <em>bool, optional</em></dt>
<dd>Whether to use orca 4 (True) or orca 3 (False).</dd>
<dt>slurm_allocation: <em>str, optional</em></dt>
<dd>Whether to use a slurm allocation for this job or not.  If so, specify the name.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>job: <a class="reference internal" href="#jobs.Job" title="jobs.Job"><code class="xref py py-class docutils literal notranslate"><span class="pre">jobs.Job</span></code></a></dt>
<dd>Teturn the job container.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="orca.mo_analysis">
<code class="descclassname">orca.</code><code class="descname">mo_analysis</code><span class="sig-paren">(</span><em>name</em>, <em>orbital=None</em>, <em>HOMO=True</em>, <em>LUMO=True</em>, <em>wireframe=True</em>, <em>hide=True</em>, <em>iso=0.04</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/orca.html#mo_analysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#orca.mo_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Post process an orca job using orca_plot and vmd to display molecular
orbitals and the potential surface.  NOTE! By default Orca does not take
into account degenerate energy states when populating.  To do so, ensure
the following is in your extra_section:</p>
<blockquote>
<div>‘%scf FracOcc true end’.</div></blockquote>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>Orca file name.  Only use the name, such as ‘water’ instead
of ‘water.gbw’.  Note, do not pass a path as it is assumed you
are in the parent directory of the job to analyze.  If not, use
the path variable.</dd>
<dt>orbital: <em>list, int, optional</em> or <em>int, optional</em></dt>
<dd>The orbital(s) to analyze (0, 1, 2, 3, …). By default HOMO and
LUMO will be analyzed, thus this only is useful if you wish to
see other orbitals.</dd>
<dt>HOMO: <em>bool, optional</em></dt>
<dd>If you want to see the HOMO level.</dd>
<dt>LUMO: <em>bool, optional</em></dt>
<dd>If you want to see the LUMO level.</dd>
<dt>wireframe: <em>bool, optional</em></dt>
<dd>If you want to view wireframe instead of default surface.</dd>
<dt>hide: <em>bool, optional</em></dt>
<dd>Whether to have the representations all off by or not when
opening.</dd>
<dt>iso: <em>float, optional</em></dt>
<dd>Isosurface magnitude.  Set to 0.04 by default, but 0.01 may be
better.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="class">
<dt id="orca.orca_task">
<em class="property">class </em><code class="descclassname">orca.</code><code class="descname">orca_task</code><span class="sig-paren">(</span><em>task_name</em>, <em>system=None</em>, <em>queue=None</em>, <em>procs=1</em>, <em>mem=1000</em>, <em>priority=None</em>, <em>xhosts=None</em>, <em>callback=None</em>, <em>no_echo=True</em>, <em>persist_system=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/orca.html#orca_task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#orca.orca_task" title="Permalink to this definition">¶</a></dt>
<dd><p>The orca task object for JOUST.  This allows for the automation of some
workflows.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>task_name: <em>str</em></dt>
<dd>The name of this task.</dd>
<dt>system: <a class="reference internal" href="#structures.System" title="structures.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.System</span></code></a></dt>
<dd>A system object to be used for this simulation.</dd>
<dt>queue: <em>str, optional</em></dt>
<dd>Queue you are submitting to (queueing system dependent).</dd>
<dt>procs: <em>int, optional</em></dt>
<dd>Number of processors requested.</dd>
<dt>mem: <em>float, optional</em></dt>
<dd>Amount of memory you’re requesting.</dd>
<dt>priority: <em>int, optional</em></dt>
<dd>Priority of the simulation (queueing system dependent).  Priority
ranges (in NBS) from a low of 1 (start running whenever) to a
high of 255 (start running ASAP).</dd>
<dt>xhosts: <em>list, str or str, optional</em></dt>
<dd>Which processors you want to run the job on.</dd>
<dt>callback: <em>func, optional</em></dt>
<dd>A function to be run at the end of the task (only if conditional
is not met).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>task: <em>task</em></dt>
<dd>This task object.</dd>
</dl>
</div></blockquote>
<dl class="method">
<dt id="orca.orca_task.read_results">
<code class="descname">read_results</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/orca.html#orca_task.read_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#orca.orca_task.read_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the output of the simulation that was just run.</p>
<p>** Returns**</p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="orca.orca_task.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/orca.html#orca_task.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#orca.orca_task.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Start the Orca simulation specified by this task.</p>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>sim_handle: <a class="reference internal" href="#jobs.Job" title="jobs.Job"><code class="xref py py-class docutils literal notranslate"><span class="pre">jobs.Job</span></code></a></dt>
<dd>A Job container for the simulation that was submitted.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="orca.orca_task.set_parameters">
<code class="descname">set_parameters</code><span class="sig-paren">(</span><em>route='! HF-3c'</em>, <em>extra_section=''</em>, <em>grad=False</em>, <em>charge=None</em>, <em>multiplicity=None</em>, <em>charge_and_multiplicity='0 1'</em>, <em>previous=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/orca.html#orca_task.set_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#orca.orca_task.set_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Set parameters for the Orca task.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>route: <em>route</em></dt>
<dd>The DFT route line, containing the function, basis set, etc.</dd>
<dt>extra_section: <em>str, optional</em></dt>
<dd>Additional DFT simulation parameters.</dd>
<dt>grad: <em>bool, optional</em></dt>
<dd>Whether to force RunTyp Gradient.</dd>
<dt>charge: <em>float, optional</em></dt>
<dd>Charge of the system.</dd>
<dt>multiplicity: <em>int, optional</em></dt>
<dd>Multiplicity of the system.</dd>
<dt>charge_and_multiplicity: <em>str, optional</em></dt>
<dd>Charge and multiplicity of the system.</dd>
<dt>previous: <em>str, optional</em></dt>
<dd>Name of a previous simulation for which to try reading in
information using the MORead method.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="orca.pot_analysis">
<code class="descclassname">orca.</code><code class="descname">pot_analysis</code><span class="sig-paren">(</span><em>name</em>, <em>wireframe=True</em>, <em>npoints=80</em>, <em>orca4=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/orca.html#pot_analysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#orca.pot_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Post process an orca job using orca_plot and vmd to display the electrostatic
potential mapped onto the electron density surface.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>Orca file name.  Only use the name, such as ‘water’ instead
of ‘water.gbw’.  Note, do not pass a path as it is assumed you
are in the parent directory of the job to analyze.</dd>
<dt>wireframe: <em>bool, optional</em></dt>
<dd>If you want to view wireframe instead of default surface.</dd>
<dt>npoints: <em>int, optional</em></dt>
<dd>The grid size for the potential surface.</dd>
<dt>orca4: <em>bool, optional</em></dt>
<dd>Whether to run this for orca4 outputs or not.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="orca.read">
<code class="descclassname">orca.</code><code class="descname">read</code><span class="sig-paren">(</span><em>input_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/orca.html#read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#orca.read" title="Permalink to this definition">¶</a></dt>
<dd><p>General read in of all possible data from an Orca output file (.out).
It should be mentioned that atomic positions are 0 indexed.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>input_file: <em>str</em></dt>
<dd>Orca .out file to be parsed.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>data: <a class="reference internal" href="#results.DFT_out" title="results.DFT_out"><code class="xref py py-class docutils literal notranslate"><span class="pre">results.DFT_out</span></code></a></dt>
<dd>Generic DFT output object containing all parsed results.</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-print_helper">
<span id="print-helper"></span><h2>print_helper<a class="headerlink" href="#module-print_helper" title="Permalink to this headline">¶</a></h2>
<p>The Linux Helper module contains functionality to aid linux users to automate some tasks.</p>
<ul class="simple">
<li><a class="reference internal" href="#print_helper.color_set" title="print_helper.color_set"><code class="xref py py-func docutils literal notranslate"><span class="pre">color_set()</span></code></a></li>
<li><a class="reference internal" href="#print_helper.colour_set" title="print_helper.colour_set"><code class="xref py py-func docutils literal notranslate"><span class="pre">colour_set()</span></code></a></li>
<li><a class="reference internal" href="#print_helper.printProgressBar" title="print_helper.printProgressBar"><code class="xref py py-func docutils literal notranslate"><span class="pre">printProgressBar()</span></code></a></li>
<li><a class="reference internal" href="#print_helper.strip_color" title="print_helper.strip_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">strip_color()</span></code></a></li>
<li><a class="reference internal" href="#print_helper.strip_colour" title="print_helper.strip_colour"><code class="xref py py-func docutils literal notranslate"><span class="pre">strip_colour()</span></code></a></li>
<li><a class="reference internal" href="#print_helper.spaced_print" title="print_helper.spaced_print"><code class="xref py py-func docutils literal notranslate"><span class="pre">spaced_print()</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="function">
<dt id="print_helper.color_set">
<code class="descclassname">print_helper.</code><code class="descname">color_set</code><span class="sig-paren">(</span><em>s</em>, <em>c</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/print_helper.html#color_set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#print_helper.color_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Colourize a string for linux terminal output.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>s: <em>str</em></dt>
<dd>String to be formatted.</dd>
<dt>c: <em>str</em></dt>
<dd>Colour or format for the string, found in constants.COLOUR.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>s: <em>str</em></dt>
<dd>Coloured or formatted string.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="print_helper.colour_set">
<code class="descclassname">print_helper.</code><code class="descname">colour_set</code><span class="sig-paren">(</span><em>s</em>, <em>c</em><span class="sig-paren">)</span><a class="headerlink" href="#print_helper.colour_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Colourize a string for linux terminal output.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>s: <em>str</em></dt>
<dd>String to be formatted.</dd>
<dt>c: <em>str</em></dt>
<dd>Colour or format for the string, found in constants.COLOUR.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>s: <em>str</em></dt>
<dd>Coloured or formatted string.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="print_helper.printProgressBar">
<code class="descclassname">print_helper.</code><code class="descname">printProgressBar</code><span class="sig-paren">(</span><em>iteration</em>, <em>total</em>, <em>prefix=''</em>, <em>suffix=''</em>, <em>decimals=1</em>, <em>length=20</em>, <em>fill='+'</em>, <em>buf=None</em>, <em>pad=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/print_helper.html#printProgressBar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#print_helper.printProgressBar" title="Permalink to this definition">¶</a></dt>
<dd><p>NOTE! THIS IS COPIED FROM STACK OVERFLOW (with minor changes), USER Greenstick
Link: <a class="reference external" href="https://stackoverflow.com/a/34325723">https://stackoverflow.com/a/34325723</a></p>
<p>Call in a loop to create terminal progress bar.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>iteration: <em>int</em></dt>
<dd>Current iteration.</dd>
<dt>total: <em>int</em></dt>
<dd>Total number of iterations.</dd>
<dt>prefix: <em>str, optional</em></dt>
<dd>Prefix for the loading bar.</dd>
<dt>suffix: <em>str, optional</em></dt>
<dd>Suffix for the loading bar.</dd>
<dt>decimals: <em>int, optional</em></dt>
<dd>Positive number of decimals in percent complete</dd>
<dt>length: <em>int, optional</em></dt>
<dd>Character length of the loading bar.</dd>
<dt>fill: <em>str, optional</em></dt>
<dd>Bar fill character.</dd>
<dt>pad: <em>bool, optional</em></dt>
<dd>Whether to pad the right side with spaces until terminal width.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="print_helper.spaced_print">
<code class="descclassname">print_helper.</code><code class="descname">spaced_print</code><span class="sig-paren">(</span><em>sOut, delim=['\t', ' '], buf=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/print_helper.html#spaced_print"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#print_helper.spaced_print" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of strings, or a string with new lines, this will reformat the string with spaces
to split columns.  Note, this only works if there are no headers to the input string/list of strings.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>sOut: <em>str</em> or <em>list, str</em></dt>
<dd>String/list of strings to be formatted.</dd>
<dt>delim: <em>list, str</em></dt>
<dd>List of delimiters in the input strings.</dd>
<dt>buf: <em>int</em></dt>
<dd>The number of spaces to have between columns.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>spaced_s: <em>str</em></dt>
<dd>Appropriately spaced output string.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="print_helper.strip_color">
<code class="descclassname">print_helper.</code><code class="descname">strip_color</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/print_helper.html#strip_color"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#print_helper.strip_color" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove colour and/or string formatting due to linux escape sequences.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>s: <em>str</em></dt>
<dd>String to strip formatting from.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>s: <em>str</em></dt>
<dd>Unformatted string.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="print_helper.strip_colour">
<code class="descclassname">print_helper.</code><code class="descname">strip_colour</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#print_helper.strip_colour" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove colour and/or string formatting due to linux escape sequences.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>s: <em>str</em></dt>
<dd>String to strip formatting from.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>s: <em>str</em></dt>
<dd>Unformatted string.</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-rate_calc">
<span id="rate-calc"></span><h2>rate_calc<a class="headerlink" href="#module-rate_calc" title="Permalink to this headline">¶</a></h2>
<p>The Rate Calculation module takes themochemistry information from an Orca 
single point calculation and calculates the exponential pre-factor of the 
Arrhenius equation at a specified temperature. The algorithm uses Transition
State Theory (TST) as the basis for mathematically defining the reaction
kinetics.</p>
<ul class="simple">
<li><a class="reference internal" href="#rate_calc.translation" title="rate_calc.translation"><code class="xref py py-func docutils literal notranslate"><span class="pre">translation()</span></code></a></li>
<li><a class="reference internal" href="#rate_calc.vibration" title="rate_calc.vibration"><code class="xref py py-func docutils literal notranslate"><span class="pre">vibration()</span></code></a></li>
<li><a class="reference internal" href="#rate_calc.rotation" title="rate_calc.rotation"><code class="xref py py-func docutils literal notranslate"><span class="pre">rotation()</span></code></a></li>
<li><a class="reference internal" href="#rate_calc.activation_energy" title="rate_calc.activation_energy"><code class="xref py py-func docutils literal notranslate"><span class="pre">activation_energy()</span></code></a></li>
<li><a class="reference internal" href="#rate_calc.get_rate" title="rate_calc.get_rate"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_rate()</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="function">
<dt id="rate_calc.activation_energy">
<code class="descclassname">rate_calc.</code><code class="descname">activation_energy</code><span class="sig-paren">(</span><em>molecule</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rate_calc.html#activation_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rate_calc.activation_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts the final energy of a reactant from an Orca output file.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>molecule: <em>str</em></dt>
<dd>A string for the name of the simulation containing the optimized reactant.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>E_tmp: <em>float</em></dt>
<dd>The energy of the optimized reactant.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="rate_calc.get_rate">
<code class="descclassname">rate_calc.</code><code class="descname">get_rate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/rate_calc.html#get_rate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rate_calc.get_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the pre-exponential factor of the Arrenhius equation for a reaction, using Transition State Theory (TST)</p>
</dd></dl>

<dl class="function">
<dt id="rate_calc.rotation">
<code class="descclassname">rate_calc.</code><code class="descname">rotation</code><span class="sig-paren">(</span><em>molecule</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rate_calc.html#rotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rate_calc.rotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the rotational partition function for a reactant.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>molecule: <em>str</em></dt>
<dd>A string for the name of the simulation containing the optimized reactant.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>qrot: <em>float</em></dt>
<dd>The partition function for rotation of a reactant.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="rate_calc.translation">
<code class="descclassname">rate_calc.</code><code class="descname">translation</code><span class="sig-paren">(</span><em>molecule</em>, <em>T</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rate_calc.html#translation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rate_calc.translation" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the translational partition function for a reactant.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>molecule: <em>str</em></dt>
<dd>A string for the name of the simulation containing the optimized reactant.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>qtrans: <em>float</em></dt>
<dd>The partition function for translation of a reactant.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="rate_calc.vibration">
<code class="descclassname">rate_calc.</code><code class="descname">vibration</code><span class="sig-paren">(</span><em>molecule</em>, <em>T</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rate_calc.html#vibration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rate_calc.vibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the vibrational partition function for a reactant.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>molecule: <em>str</em></dt>
<dd>A string for the name of the simulation containing the optimized reactant.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>qvib: <em>float</em></dt>
<dd>The partition function for vibration of a reactant.</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-results">
<span id="results"></span><h2>results<a class="headerlink" href="#module-results" title="Permalink to this headline">¶</a></h2>
<p>The results module contains data structures to hold simulation output.</p>
<ul class="simple">
<li><a class="reference internal" href="#results.DFT_out" title="results.DFT_out"><code class="xref py py-class docutils literal notranslate"><span class="pre">DFT_out</span></code></a></li>
<li><a class="reference internal" href="#results.sim_out" title="results.sim_out"><code class="xref py py-class docutils literal notranslate"><span class="pre">sim_out</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="class">
<dt id="results.DFT_out">
<em class="property">class </em><code class="descclassname">results.</code><code class="descname">DFT_out</code><span class="sig-paren">(</span><em>name</em>, <em>dft='orca'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/results.html#DFT_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#results.DFT_out" title="Permalink to this definition">¶</a></dt>
<dd><p>A generic class to hold dft data.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>Given name for this simulation object.</dd>
<dt>dft: <em>str, optional</em></dt>
<dd>Identifier for which dft code this data is from.</dd>
</dl>
</div></blockquote>
<p><strong>Contains</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>route: <em>str</em></dt>
<dd>The ‘route’ line describing the functional, basis set, and other
dft configurations.</dd>
<dt>extra_section: <em>str</em></dt>
<dd>The ‘extra section’ in the simulation.</dd>
<dt>charge_and_multiplicity: <em>str</em></dt>
<dd>The charge and multiplicity, in that order, of the system.</dd>
<dt>frames: <em>list, list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list lists of atoms describing each iteration in the dft
simulation.</dd>
<dt>atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Atomic information of the last iteration in the dft simulation.</dd>
<dt>gradients: <em>list, list, float</em></dt>
<dd>Gradient of the potential, stored for each atom in <em>atoms</em> and
<em>frames[-1]</em>.</dd>
<dt>energy: <em>float</em></dt>
<dd>The total energy of the last iteration.</dd>
<dt>charges_MULLIKEN: <em>list, float</em></dt>
<dd>Mulliken charges for each atom in <em>atoms</em> and <em>frames[-1]</em>.</dd>
<dt>charges_LOEWDIN: <em>list, float</em></dt>
<dd>Loewdin charges for each atom in <em>atoms</em> and <em>frames[-1]</em>.</dd>
<dt>charges_CHELPG: <em>list, float</em></dt>
<dd>Chelpg charges for each atom in <em>atoms</em> and <em>frames[-1]</em>.</dd>
<dt>charges: <em>list, float</em></dt>
<dd>Charges for each atom in <em>atoms</em> and <em>frames[-1]</em>.  Typically a
copy of Mulliken charges.</dd>
<dt>MBO: <em>list, list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a> <em>, float</em></dt>
<dd>A list of lists, each list holding (1) a list of atoms in the bond
and (2) the Mayer Bond Order (MBO) of said bond.</dd>
<dt>convergence: <em>list, str</em> VERIFY</dt>
<dd>A list of convergence criteria and matching values.</dd>
<dt>converged: <em>bool</em></dt>
<dd>Whether the simulation converged (True), or not (False).</dd>
<dt>time: <em>float</em></dt>
<dd>Total time in seconds that the simulation ran for.</dd>
<dt>bandgap: <em>float</em></dt>
<dd>Bandgap of the final configuration.</dd>
<dt>bandgaps: <em>float</em></dt>
<dd>Bandgap of each configuration.</dd>
<dt>orbitals: <em>list, tuple, float, float</em></dt>
<dd>A list of tuples, each holding the information of the occupation
and energy (Ha) of a molecular orbital.  NOTE! This does not take
into account degenerate energy states, so ensure that whatever DFT
software you’re using has already done so.</dd>
<dt>finished: <em>bool</em></dt>
<dd>Whether the simulation completed normally (True), or not (False).</dd>
<dt>warnings: <em>list, str</em></dt>
<dd>Warnings output by the simulation.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="class">
<dt id="results.sim_out">
<em class="property">class </em><code class="descclassname">results.</code><code class="descname">sim_out</code><span class="sig-paren">(</span><em>name</em>, <em>program='lammps'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/results.html#sim_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#results.sim_out" title="Permalink to this definition">¶</a></dt>
<dd><p>A generic class to hold simulation data, particularly lammps trajectory
files.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>Given name for this simulation object.</dd>
<dt>program: <em>str, optional</em></dt>
<dd>Identifier for which program this data is from.</dd>
</dl>
</div></blockquote>
<p><strong>Contains</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>list, list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list lists of atoms describing each iteration in the simulation.</dd>
<dt>atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Atomic information of the last iteration in the simulation.</dd>
<dt>timesteps: <em>list, int</em></dt>
<dd>Recorded timesteps within the output.</dd>
<dt>final_timestep: <em>int</em></dt>
<dd>Final timestep of the output.</dd>
<dt>atom_counts: <em>list, int</em></dt>
<dd>List of how many atoms for each timestep.</dd>
<dt>atom_count: <em>int</em></dt>
<dd>List of how many atoms in the final timestep.</dd>
<dt>box_bounds_list: <em>list,</em> <a class="reference internal" href="#structures.Struct" title="structures.Struct"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Struct</span></code></a></dt>
<dd>List of box bounds for each timestep.</dd>
<dt>box_bounds: <a class="reference internal" href="#structures.Struct" title="structures.Struct"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Struct</span></code></a></dt>
<dd>List of box bounds for the final timestep.</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-spline_neb">
<span id="spline-neb"></span><h2>spline_neb<a class="headerlink" href="#module-spline_neb" title="Permalink to this headline">¶</a></h2>
<p>The spline_NEB module simplifies the submission of Nudged Elastic Band based, curve smoothing simulations.</p>
<ul class="simple">
<li><a class="reference internal" href="#spline_neb.g09_start_job" title="spline_neb.g09_start_job"><code class="xref py py-func docutils literal notranslate"><span class="pre">g09_start_job()</span></code></a></li>
<li><a class="reference internal" href="#spline_neb.g09_results" title="spline_neb.g09_results"><code class="xref py py-func docutils literal notranslate"><span class="pre">g09_results()</span></code></a></li>
<li><a class="reference internal" href="#spline_neb.orca_start_job" title="spline_neb.orca_start_job"><code class="xref py py-func docutils literal notranslate"><span class="pre">orca_start_job()</span></code></a></li>
<li><a class="reference internal" href="#spline_neb.orca_results" title="spline_neb.orca_results"><code class="xref py py-func docutils literal notranslate"><span class="pre">orca_results()</span></code></a></li>
<li><a class="reference internal" href="#spline_neb.spline_NEB" title="spline_neb.spline_NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">spline_NEB</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="function">
<dt id="spline_neb.g09_results">
<code class="descclassname">spline_neb.</code><code class="descname">g09_results</code><span class="sig-paren">(</span><em>spline_NEB</em>, <em>step_to_use</em>, <em>i</em>, <em>state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spline_neb.html#g09_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spline_neb.g09_results" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for reading in the output of Gaussian09 single point calculations
for spline_NEB calculations. This will both (a) assign forces to the atoms stored
in state and (b) return the energy and atoms.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>spline_NEB: <a class="reference internal" href="#spline_neb.spline_NEB" title="spline_neb.spline_NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">spline_NEB</span></code></a></dt>
<dd>A spline_NEB container holding the main spline_NEB simulation</dd>
<dt>step_to_use: <em>int</em></dt>
<dd>Which iteration in the spline_NEB sequence the output to be read in is on.</dd>
<dt>i: <em>int</em></dt>
<dd>The index corresponding to which image on the frame is to be
simulated.</dd>
<dt>state: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms describing the image on the frame associated with
index <em>i</em>.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>new_energy: <em>float</em></dt>
<dd>The energy of the system in Hartree (Ha).</dd>
<dt>new_atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms with the forces attached in units of Hartree per
Angstrom (Ha/Ang).</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="spline_neb.g09_start_job">
<code class="descclassname">spline_neb.</code><code class="descname">g09_start_job</code><span class="sig-paren">(</span><em>spline_NEB</em>, <em>i</em>, <em>state</em>, <em>charge</em>, <em>procs</em>, <em>queue</em>, <em>initial_guess</em>, <em>extra_section</em>, <em>mem</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spline_neb.html#g09_start_job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spline_neb.g09_start_job" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for submitting a single point calculation using Gaussian09 for
spline_NEB calculations.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>spline_NEB: <a class="reference internal" href="#spline_neb.spline_NEB" title="spline_neb.spline_NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">spline_NEB</span></code></a></dt>
<dd>A spline_NEB container holding the main spline_NEB simulation</dd>
<dt>i: <em>int</em></dt>
<dd>The index corresponding to which image on the frame is to be
simulated.</dd>
<dt>state: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms describing the image on the frame associated
with index <em>i</em>.</dd>
<dt>charge: <em>int</em></dt>
<dd>Charge of the system.</dd>
<dt>procs: <em>int</em></dt>
<dd>The number of processors to use during calculations.</dd>
<dt>queue: <em>str</em></dt>
<dd>Which queue to submit the simulation to (this is queueing system
dependent).</dd>
<dt>initial_guess: <em>str</em></dt>
<dd>The name of a previous simulation for which we can read in a
hessian.</dd>
<dt>extra_section: <em>str</em></dt>
<dd>Extra settings for this DFT method.</dd>
<dt>mem: <em>int</em></dt>
<dd>How many Mega Words (MW) you wish to have as dynamic memory.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>g09_job: <a class="reference internal" href="#jobs.Job" title="jobs.Job"><code class="xref py py-class docutils literal notranslate"><span class="pre">jobs.Job</span></code></a></dt>
<dd>A job container holding the g09 simulation.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="spline_neb.orca_results">
<code class="descclassname">spline_neb.</code><code class="descname">orca_results</code><span class="sig-paren">(</span><em>spline_NEB</em>, <em>step_to_use</em>, <em>i</em>, <em>state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spline_neb.html#orca_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spline_neb.orca_results" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for reading in the output of Orca single point calculations for
spline_NEB calculations. This will both (a) assign forces to the atoms stored
in state and (b) return the energy and atoms.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>spline_NEB: <a class="reference internal" href="#spline_neb.spline_NEB" title="spline_neb.spline_NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">spline_NEB</span></code></a></dt>
<dd>A spline_NEB container holding the main spline_NEB simulation</dd>
<dt>step_to_use: <em>int</em></dt>
<dd>Which iteration in the spline_NEB sequence the output to be read in is on.</dd>
<dt>i: <em>int</em></dt>
<dd>The index corresponding to which image on the frame is to be
simulated.</dd>
<dt>state: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms describing the image on the frame associated with
index <em>i</em>.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>new_energy: <em>float</em></dt>
<dd>The energy of the system in Hartree (Ha).</dd>
<dt>new_atoms: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms with the forces attached in units of Hartree per
Angstrom (Ha/Ang).</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="spline_neb.orca_start_job">
<code class="descclassname">spline_neb.</code><code class="descname">orca_start_job</code><span class="sig-paren">(</span><em>spline_NEB</em>, <em>i</em>, <em>state</em>, <em>charge</em>, <em>procs</em>, <em>queue</em>, <em>initial_guess</em>, <em>extra_section</em>, <em>mem</em>, <em>priority</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spline_neb.html#orca_start_job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spline_neb.orca_start_job" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for submitting a single point calculation using Orca for spline_NEB
calculations.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>spline_NEB: <a class="reference internal" href="#spline_neb.spline_NEB" title="spline_neb.spline_NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">spline_NEB</span></code></a></dt>
<dd>A spline_NEB container holding the main spline_NEB simulation</dd>
<dt>i: <em>int</em></dt>
<dd>The index corresponding to which image on the frame is to be
simulated.</dd>
<dt>state: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of atoms describing the image on the frame associated with
index <em>i</em>.</dd>
<dt>charge: <em>int</em></dt>
<dd>Charge of the system.</dd>
<dt>procs: <em>int</em></dt>
<dd>The number of processors to use during calculations.</dd>
<dt>queue: <em>str</em></dt>
<dd>Which queue to submit the simulation to (this is queueing system
dependent).</dd>
<dt>initial_guess: <em>str</em></dt>
<dd>The name of a previous simulation for which we can read in a
hessian.</dd>
<dt>extra_section: <em>str</em></dt>
<dd>Extra settings for this DFT method.</dd>
<dt>mem: <em>int</em></dt>
<dd>How many MegaBytes (MB) of memory you have available per core.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>orca_job: <a class="reference internal" href="#jobs.Job" title="jobs.Job"><code class="xref py py-class docutils literal notranslate"><span class="pre">jobs.Job</span></code></a></dt>
<dd>A job container holding the orca simulation.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="class">
<dt id="spline_neb.spline_NEB">
<em class="property">class </em><code class="descclassname">spline_neb.</code><code class="descname">spline_NEB</code><span class="sig-paren">(</span><em>name</em>, <em>states</em>, <em>theory</em>, <em>extra_section=''</em>, <em>charge=0</em>, <em>initial_guess=None</em>, <em>spring_atoms=None</em>, <em>procs=1</em>, <em>queue=None</em>, <em>mem=2000</em>, <em>priority=None</em>, <em>disp=0</em>, <em>k_max=0.1837</em>, <em>gamma=0.2</em>, <em>fit_rigid=True</em>, <em>DFT='orca'</em>, <em>opt='LBFGS'</em>, <em>start_job=None</em>, <em>get_results=None</em>, <em>new_opt_params={}</em>, <em>callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spline_neb.html#spline_NEB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spline_neb.spline_NEB" title="Permalink to this definition">¶</a></dt>
<dd><p>A post-processing method for taking a converged minimum energy pathway of a reaction using
DFT and smoothing the curve to a more Gaussian-like shape. Note, this method was written for atomic orbital DFT codes; however,
is potentially generalizable to other programs.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str</em></dt>
<dd>The name of the spline_NEB simulation to be run.</dd>
<dt>states: <em>list, list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of frames, each frame being a list of atom structures.
These frames represent your reaction coordinate.</dd>
<dt>theory: <em>str</em></dt>
<dd>The route line for your DFT simulation.</dd>
<dt>extra_section: <em>str, optional</em></dt>
<dd>Additional parameters for your DFT simulation.</dd>
<dt>charge: <em>int</em></dt>
<dd>Charge of the system.</dd>
<dt>initial_guess: <em>list, str, optional</em></dt>
<dd>TODO - List of strings specifying a previously run NEB simulation,
allowing restart capabilities.</dd>
<dt>spring_atoms: <em>list, int, optional</em></dt>
<dd>Specify which atoms will be represented by virutal springs in the
spline_NEB calculations. Default includes all.</dd>
<dt>procs: <em>int, optional</em></dt>
<dd>The number of processors for your simulation.</dd>
<dt>queue: <em>str, optional</em></dt>
<dd>Which queue you wish your simulation to run on (queueing system
dependent). When None, spline_NEB is run locally.</dd>
<dt>mem: <em>float, optional</em></dt>
<dd>Specify memory constraints (specific to your X_start_job method).</dd>
<dt>disp: <em>int, optional</em></dt>
<dd>Specify for additional stdout information.</dd>
<dt>k_max: <em>float, optional</em></dt>
<dd>The maximum spring constant for your spline_NEB simulation.</dd>
<dt>gamma: <em>float, optional</em></dt>
<dd>The percent of the magnitude of k_max at either end of the reaction coordinate</dd>
<dt>fit_rigid: <em>bool, optional</em></dt>
<dd>Whether you want to use procrustes to minimize motion between
adjacent frames (thus minimizing error due to excessive virtal
spring forces).</dd>
<dt>DFT: <em>str, optional</em></dt>
<dd>Specify if you wish to use the default X_start_job and X_results
functions where X is either g09 or orca.</dd>
<dt>opt: <em>str, optional</em></dt>
<dd>Select which optimization method you wish to use from the
following: BFGS, LBFGS, SD, FIRE, QM, CG, scipy_X. Note, if using
scipy_X, change X to be a valid scipy minimize method.</dd>
<dt>start_job: <em>func, optional</em></dt>
<dd>A function specifying how to submit your NEB single point
calculations.  Needed if DFT is neither orca nor g09.</dd>
<dt>get_results: <em>func, optional</em></dt>
<dd>A function specifying how to read your NEB single point
calculations.  Needed if DFT is neither orca nor g09.</dd>
<dt>new_opt_params: <em>dict, optional</em></dt>
<dd>Pass any additional parameters to the optimization algorithm.</dd>
<dt>callback: <em>func, optional</em></dt>
<dd>A function to be run after each each to calculate().</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>This <a class="reference internal" href="#spline_neb.spline_NEB" title="spline_neb.spline_NEB"><code class="xref py py-class docutils literal notranslate"><span class="pre">spline_NEB</span></code></a> object.</div></blockquote>
<p><strong>References</strong></p>
<blockquote>
<div><ul class="simple">
<li>Henkelman, G.; Jonsson, H. The Journal of Chemical Physics 2000,
113, 9978-9985.</li>
<li>Jonsson, H.; Mills, G.; Jacobson, K. W. In Classical and Quantum
Dynamics in Condensed Phase Simulations;</li>
<li>Berne, B. J., Ciccotti, G., Coker, D. F., Eds.; World Scientific,
1998; Chapter 16, pp 385-404.</li>
<li>Armijo, L. Pacific Journal of Mathematics 1966, 16.</li>
<li>Sheppard, D.; Terrell, R.; Henkelman, G. The Journal of Chemical
Physics 2008, 128.</li>
<li>Henkelman, G.; Uberuaga, B. P.; Jonsson, H. Journal of Chemical
Physics 2000, 113.</li>
<li>Atomic Simulation Environment - <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/">https://wiki.fysik.dtu.dk/ase/</a></li>
<li>Kolsbjerg, E. L.; Groves, M. N.; Hammer, B. The Journal of 
Chemical Physics 2016, 145.</li>
</ul>
</div></blockquote>
<dl class="method">
<dt id="spline_neb.spline_NEB.align_coordinates">
<code class="descname">align_coordinates</code><span class="sig-paren">(</span><em>r</em>, <em>B=None</em>, <em>H=None</em>, <em>return_matrix=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spline_neb.html#spline_NEB.align_coordinates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spline_neb.spline_NEB.align_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a rotation matrix A that will remove rigid rotation from the
new coordinates r.  Further, if another vector needs rotating by the
same matrix A, it should be passed in B and will be rotated.  If
a matrix also needs rotating, it can be passed as H and also be
rotated.</p>
<p><em>Parameters</em></p>
<blockquote>
<div><dl class="docutils">
<dt>r: <em>list, float</em></dt>
<dd>1D array of atomic coordinates to be rotated by procrustes
matrix A.</dd>
<dt>B: <em>list, list, float, optional</em></dt>
<dd>A list of vectors that may also be rotated by the same matrix
as <em>r</em>.</dd>
<dt>H: <em>list, list, float, optional</em></dt>
<dd><dl class="first last docutils">
<dt>A matrix that should also be rotated via:</dt>
<dd>H = R * H * R.T</dd>
</dl>
</dd>
<dt>return_matrix: <em>bool, optional</em></dt>
<dd>Whether to also return the rotation matrix used or not.</dd>
</dl>
</div></blockquote>
<p><em>Returns</em></p>
<blockquote>
<div><dl class="docutils">
<dt>rotations: <em>dict</em></dt>
<dd>A dictionary holding ‘A’, the rotation matrix, ‘r’, the
rotated new coordinates, ‘B’, a list of all other vectors that
were rotated, and ‘H’, a rotated matrix.</dd>
</dl>
</div></blockquote>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-structures">
<span id="structures"></span><h2>structures<a class="headerlink" href="#module-structures" title="Permalink to this headline">¶</a></h2>
<p>The Structures module contains various class objects to describe one’s molecular system. 
Each <em>System</em> object can be comprised of several <em>Molecule</em> objects which are, in turn, 
comprised of <em>Atom</em>, <em>Bond</em>, <em>Angle</em>, <em>Dihedral</em>, and <em>Improper</em> objects.</p>
<ul class="simple">
<li><a class="reference internal" href="#structures.System" title="structures.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a></li>
<li><a class="reference internal" href="#structures.Molecule" title="structures.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></li>
<li><a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a></li>
<li><a class="reference internal" href="#structures.Bond" title="structures.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a></li>
<li><a class="reference internal" href="#structures.Angle" title="structures.Angle"><code class="xref py py-class docutils literal notranslate"><span class="pre">Angle</span></code></a></li>
<li><a class="reference internal" href="#structures.Dihedral" title="structures.Dihedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dihedral</span></code></a></li>
<li><a class="reference internal" href="#structures.Improper" title="structures.Improper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Improper</span></code></a></li>
</ul>
<p>There also exists a dynamic data structure object <em>Struct</em>.</p>
<ul class="simple">
<li><a class="reference internal" href="#structures.Struct" title="structures.Struct"><code class="xref py py-class docutils literal notranslate"><span class="pre">Struct</span></code></a></li>
</ul>
<p>General atom manipulation functions that can adapted by the object classes</p>
<ul class="simple">
<li><code class="xref py py-func docutils literal notranslate"><span class="pre">_remove_atom_index()</span></code></li>
<li><code class="xref py py-func docutils literal notranslate"><span class="pre">_remove_atom_type()</span></code></li>
</ul>
<hr class="docutils" />
<dl class="class">
<dt id="structures.Angle">
<em class="property">class </em><code class="descclassname">structures.</code><code class="descname">Angle</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em>, <em>type=None</em>, <em>theta=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Angle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Angle" title="Permalink to this definition">¶</a></dt>
<dd><p>A structure to hold angle information.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>a: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>First atom in the angle.</dd>
<dt>b: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Second atom in the angle.</dd>
<dt>c: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Third atom in the angle.</dd>
<dt>type: <em>dict, optional</em></dt>
<dd>The forcefield type.</dd>
<dt>theta: <em>float, optional</em></dt>
<dd>The angle.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>angle: <a class="reference internal" href="#structures.Angle" title="structures.Angle"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Angle</span></code></a></dt>
<dd>The Angle class container.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="class">
<dt id="structures.Atom">
<em class="property">class </em><code class="descclassname">structures.</code><code class="descname">Atom</code><span class="sig-paren">(</span><em>element</em>, <em>x</em>, <em>y</em>, <em>z</em>, <em>index=None</em>, <em>type=None</em>, <em>molecule_index=1</em>, <em>bonded=[]</em>, <em>type_index=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Atom" title="Permalink to this definition">¶</a></dt>
<dd><p>A structure to hold atom information.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>element: <em>str</em></dt>
<dd>The atomic element.</dd>
<dt>x: <em>float</em></dt>
<dd>The x coordinate of the atom.</dd>
<dt>y: <em>float</em></dt>
<dd>The y coordinate of the atom.</dd>
<dt>z: <em>float</em></dt>
<dd>The z coordinate of the atom.</dd>
<dt>index: <em>int, optional</em></dt>
<dd>The atomic index within a molecule.</dd>
<dt>type: <em>dict, optional</em></dt>
<dd>The forcefield type.</dd>
<dt>molecule_index: <em>int, optional</em></dt>
<dd>Which molecule the atom is contained in.</dd>
<dt>bonded: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a> <em>, optional</em></dt>
<dd>A list of atoms to which this atom is bonded.</dd>
<dt>type_index: <em>int, optional</em></dt>
<dd>The index of the atomic type within the given forcefield.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atom: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>The Atom class container.</dd>
</dl>
</div></blockquote>
<dl class="method">
<dt id="structures.Atom.flatten">
<code class="descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Atom.flatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Atom.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain simplified position output.</p>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>pos: <em>list, float</em></dt>
<dd>A list holding the x, y, and z position of this atom.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.Atom.set_position">
<code class="descname">set_position</code><span class="sig-paren">(</span><em>pos</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Atom.set_position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Atom.set_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Manually set the atomic positions by passing a tuple/list.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>pos: <em>list, float or tuple, float</em></dt>
<dd>A vector of 3 floats specifying the new x, y, and z coordinate.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.Atom.translate">
<code class="descname">translate</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Atom.translate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Atom.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate the atom by a vector.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>v: <em>list, float</em></dt>
<dd>A vector of 3 floats specifying the x, y, and z offsets to be applied.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="structures.Bond">
<em class="property">class </em><code class="descclassname">structures.</code><code class="descname">Bond</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>type=None</em>, <em>r=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Bond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Bond" title="Permalink to this definition">¶</a></dt>
<dd><p>A structure to hold bond information.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>a: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>First atom in the bond.</dd>
<dt>b: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Second atom in the bond.</dd>
<dt>type: <em>dict, optional</em></dt>
<dd>The forcefield type.</dd>
<dt>r: <em>float, optional</em></dt>
<dd>The bond length.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>bond: <a class="reference internal" href="#structures.Bond" title="structures.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Bond</span></code></a></dt>
<dd>The Bond class container.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="class">
<dt id="structures.Dihedral">
<em class="property">class </em><code class="descclassname">structures.</code><code class="descname">Dihedral</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em>, <em>d</em>, <em>type=None</em>, <em>theta=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Dihedral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Dihedral" title="Permalink to this definition">¶</a></dt>
<dd><p>A structure to hold dihedral information.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>a: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>First atom in the dihedral.</dd>
<dt>b: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Second atom in the dihedral.</dd>
<dt>c: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Third atom in the dihedral.</dd>
<dt>d: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Fourth atom in the dihedral.</dd>
<dt>type: <em>dict, optional</em></dt>
<dd>The forcefield type.</dd>
<dt>theta: <em>float, optional</em></dt>
<dd>The dihedral angle.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>dihedral: <a class="reference internal" href="#structures.Dihedral" title="structures.Dihedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Dihedral</span></code></a></dt>
<dd>The Dihedral class container.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="class">
<dt id="structures.Improper">
<em class="property">class </em><code class="descclassname">structures.</code><code class="descname">Improper</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em>, <em>d</em>, <em>type=None</em>, <em>theta=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Improper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Improper" title="Permalink to this definition">¶</a></dt>
<dd><p>A structure to hold improper information.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>a: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>First atom in the improper.</dd>
<dt>b: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Second atom in the improper.</dd>
<dt>c: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Third atom in the improper.</dd>
<dt>d: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>Fourth atom in the improper.</dd>
<dt>type: <em>dict, optional</em></dt>
<dd>The forcefield type.</dd>
<dt>theta: <em>float, optional</em></dt>
<dd>The improper angle.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>improper: <a class="reference internal" href="#structures.Improper" title="structures.Improper"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Improper</span></code></a></dt>
<dd>The Improper class container.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="class">
<dt id="structures.Molecule">
<em class="property">class </em><code class="descclassname">structures.</code><code class="descname">Molecule</code><span class="sig-paren">(</span><em>atoms_or_filename</em>, <em>bonds=None</em>, <em>angles=None</em>, <em>dihedrals=None</em>, <em>parameter_file='/mnt/c/Users/hherb/Documents/subsystem/squid/forcefield_parameters/oplsaa.prm'</em>, <em>extra_parameters={}</em>, <em>test_charges=False</em>, <em>allow_errors=False</em>, <em>default_angles=None</em>, <em>test_consistency=False</em>, <em>charge=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>A molecule object to store atoms and any/all associated interatomic connections.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atoms_or_filename: <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a> <em>or str</em></dt>
<dd>Either (a) a list of atoms or (b) a string pointing to a cml file containing the atoms.</dd>
<dt>bonds: <em>list,</em> <a class="reference internal" href="#structures.Bond" title="structures.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Bond</span></code></a> <em>, optional</em></dt>
<dd>A list of all bonds within the system.</dd>
<dt>angles: <em>list,</em> <a class="reference internal" href="#structures.Angle" title="structures.Angle"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Angle</span></code></a> <em>, optional</em></dt>
<dd>A list of all angles within the system.</dd>
<dt>dihedrals: <em>list,</em> <a class="reference internal" href="#structures.Dihedral" title="structures.Dihedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Dihedral</span></code></a> <em>, optional</em></dt>
<dd>A list of all dihedrals within the system.</dd>
<dt>parameter_file: <em>str, optional</em></dt>
<dd>A path to your forcefield file. Currently only supports OPLS-AA.</dd>
<dt>extra_parameters: <em>dict, optional</em></dt>
<dd>Additional OPLS parameters to apply to the forcefield.</dd>
<dt>test_charges: <em>bool, optional</em></dt>
<dd>Bypass inconsistencies in molecular charge (False) or throw errors when inconsistencies exist (True).</dd>
<dt>allow_errors: <em>bool, optional</em></dt>
<dd>Permit constructions of ill-conditioned molecules, such as empty bonds (True), or throw errors (False).</dd>
<dt>default_angles: <em>dict, optional</em></dt>
<dd>A default forcefield angle type to be set if angle types are set to None.</dd>
<dt>test_consistency: <em>bool, optional</em></dt>
<dd>Whether to validate the input cml file against OPLS.</dd>
<dt>charge: <em>float, optional</em></dt>
<dd>The total charge of this molecule.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>molecule: <a class="reference internal" href="#structures.Molecule" title="structures.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Molecule</span></code></a></dt>
<dd>The Molecule class container.</dd>
</dl>
</div></blockquote>
<dl class="method">
<dt id="structures.Molecule.flatten">
<code class="descname">flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Molecule.flatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Molecule.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Flatten out all atoms into a 1D array.</p>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atoms: <em>list, float</em></dt>
<dd>A 1D array of atomic positions.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.Molecule.get_center_of_geometry">
<code class="descname">get_center_of_geometry</code><span class="sig-paren">(</span><em>skip_H=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Molecule.get_center_of_geometry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Molecule.get_center_of_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the center of geometry of the molecule.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>skip_H: <em>bool, optional</em></dt>
<dd>Whether to include Hydrogens in the calculation (False), or not (True).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>cog: <em>tuple, float</em></dt>
<dd>A tuple of the x, y, and z coordinate of the center of geometry.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.Molecule.get_center_of_mass">
<code class="descname">get_center_of_mass</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Molecule.get_center_of_mass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Molecule.get_center_of_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the center of mass of the molecule.</p>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>com: <em>list, float</em></dt>
<dd>A list of the x, y, and z coordinate of the center of mass.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.Molecule.merge">
<code class="descname">merge</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Molecule.merge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Molecule.merge" title="Permalink to this definition">¶</a></dt>
<dd><p>This function merges another molecule into this one, offsetting indices as needed.</p>
</dd></dl>

<dl class="method">
<dt id="structures.Molecule.perturbate">
<code class="descname">perturbate</code><span class="sig-paren">(</span><em>dx=0.1</em>, <em>dr=5</em>, <em>center_of_geometry=True</em>, <em>rotate=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Molecule.perturbate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Molecule.perturbate" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly perturbate atomic coordinates, and apply a slight rotation.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>dx: <em>float, optional</em></dt>
<dd>By how much you are willing to perturbate via translation.</dd>
<dt>dr: <em>float, optional</em></dt>
<dd>By how much you are willing to perturbate via rotation in degrees.</dd>
<dt>center_of_geometry: <em>bool, optional</em></dt>
<dd>Whether to do the random rotation by the center of geometry (True) or mass (False).
Note, if types are not set, it will fail in the case of center of mass.</dd>
<dt>rotate: <em>bool, optional</em></dt>
<dd>Whether to randomly rotate the molecule or not.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.Molecule.rand_rotate">
<code class="descname">rand_rotate</code><span class="sig-paren">(</span><em>in_place=True</em>, <em>limit_angle=None</em>, <em>center_of_geometry=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Molecule.rand_rotate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Molecule.rand_rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly rotate a molecule.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>in_place: <em>bool, optional</em></dt>
<dd>Whether to rotate randomly (False), or around the molecule’s center of mass (True).</dd>
<dt>limit_angle: <em>float, optional</em></dt>
<dd>Whether to confine your random rotation (in radians).</dd>
<dt>center_of_geometry: <em>bool, optional</em></dt>
<dd>Whether to rotate around the center of geometry (True) or mass (False).</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.Molecule.remove_atom_index">
<code class="descname">remove_atom_index</code><span class="sig-paren">(</span><em>indices=[]</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Molecule.remove_atom_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Molecule.remove_atom_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes selected indices from system. Does so by compiling new lists for atoms, bonds, angles, and dihedrals. Will be faster than Remove in cases
where you are only keeping a few atoms.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>type_indices: <em>list, int, optional</em></dt>
<dd>A list of OPLS types.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.Molecule.remove_atom_type">
<code class="descname">remove_atom_type</code><span class="sig-paren">(</span><em>type_indices=[]</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Molecule.remove_atom_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Molecule.remove_atom_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes selected OPLS types from system. Does so by compiling new lists for atoms, bonds, angles, and dihedrals. Will be faster than Remove in cases
where you are only keeping a few atoms.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>type_indices: <em>list, int, optional</em></dt>
<dd>A list of OPLS types.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.Molecule.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>m</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Molecule.rotate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Molecule.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate the molecule by the given matrix <em>m</em>.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>m: <em>list, list, float</em></dt>
<dd>A 3x3 matrix describing the rotation to be applied to this molecule.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.Molecule.set_center">
<code class="descname">set_center</code><span class="sig-paren">(</span><em>xyz=[0.0, 0.0, 0.0]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Molecule.set_center"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Molecule.set_center" title="Permalink to this definition">¶</a></dt>
<dd><p>Recenter the molecule to the origin.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>xyz: <em>list, float, optional</em></dt>
<dd>A list of x, y, and z offsets to be applied post centering.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.Molecule.set_positions">
<code class="descname">set_positions</code><span class="sig-paren">(</span><em>positions</em>, <em>new_atom_list=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Molecule.set_positions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Molecule.set_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Manually specify atomic positions of your molecule.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>positions: <em>list, float</em></dt>
<dd>A list, either 2D or 1D, of the atomic positions.  Note, this should
be in the same order that the atoms are stored in.</dd>
<dt>new_atom_list: <em>bool, optional</em></dt>
<dd>Whether to generate an entirely new atom list (True) or re-write atom
positions of those atoms already stored (False). Note, if a new list
is written, connections (bonds, angles, …) are not changed.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.Molecule.set_types">
<code class="descname">set_types</code><span class="sig-paren">(</span><em>P</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Molecule.set_types"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Molecule.set_types" title="Permalink to this definition">¶</a></dt>
<dd><p>This will, using a parameter object, assign a pointer of which type
corresponds with each atom, bond, angle, and dihedral.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>P: <code class="xref py py-class docutils literal notranslate"><span class="pre">squid.ff_params.Parameters</span></code></dt>
<dd>A general parameter object</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.Molecule.translate">
<code class="descname">translate</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Molecule.translate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Molecule.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a translation to this molecule.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>v: <em>list, float</em></dt>
<dd>A list of 3 elements: the x, y, and z translations to be applied.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="structures.Struct">
<em class="property">class </em><code class="descclassname">structures.</code><code class="descname">Struct</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#Struct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.Struct" title="Permalink to this definition">¶</a></dt>
<dd><p>A generalized Structure object for python</p>
</dd></dl>

<dl class="class">
<dt id="structures.System">
<em class="property">class </em><code class="descclassname">structures.</code><code class="descname">System</code><span class="sig-paren">(</span><em>name=None</em>, <em>box_size=(10.0</em>, <em>10.0</em>, <em>10.0)</em>, <em>box_angles=(90.0</em>, <em>90.0</em>, <em>90.0)</em>, <em>periodic=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#System"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.System" title="Permalink to this definition">¶</a></dt>
<dd><p>A system object to store molecules for one’s simulations.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>name: <em>str, optional</em></dt>
<dd>System Name.</dd>
<dt>box_size: <em>tuple, float, optional</em></dt>
<dd>System x, y, and z lengths.</dd>
<dt>box_angles: <em>tuple, float, optional</em></dt>
<dd>System xy, yz, and xz angles.</dd>
<dt>periodic: <em>bool, optional</em></dt>
<dd>Whether to have periodic boundaries on or off.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>system: <a class="reference internal" href="#structures.System" title="structures.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.System</span></code></a></dt>
<dd>The System class container.</dd>
</dl>
</div></blockquote>
<dl class="method">
<dt id="structures.System.Contains">
<code class="descname">Contains</code><span class="sig-paren">(</span><em>molecule</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#System.Contains"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.System.Contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if this system contains a molecule, based on the atoms, bonds, angles and dihedrals.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>molecule: <a class="reference internal" href="#structures.Molecule" title="structures.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Molecule</span></code></a></dt>
<dd>A molecule to be checked if it resides within this system.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>is_contained: <em>bool</em></dt>
<dd>A boolean specifying if the molecule passed to this function is contained
within this System object.  This implies that all atoms, bonds, angles,
and dihedrals within the molecule are present in a molecule within the system.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.System.Remove">
<code class="descname">Remove</code><span class="sig-paren">(</span><em>target</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#System.Remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.System.Remove" title="Permalink to this definition">¶</a></dt>
<dd><p>If target is a molecule, removes all atoms, bonds angles and dihedrals of
the passed molecule from the system. Raises a ValueError if not all aspects
of molecule are found in the system.</p>
<p>If target is an Atom, the atom is removed from the system, and any bonds,
angles, and dihedrals which contain the atom are also removed from the system.
Raises a ValueError if the Atom is not found in the system.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>target: <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a> <em>or</em> <a class="reference internal" href="#structures.Molecule" title="structures.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Molecule</span></code></a></dt>
<dd>A target atom or molecule to be removed from this system. Target is a valid
<a class="reference internal" href="#structures.Molecule" title="structures.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Molecule</span></code></a> instance or a valid <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a> instance.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.System.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>molecule</em>, <em>x=0.0</em>, <em>y=0.0</em>, <em>z=0.0</em>, <em>scale_x=1.0</em>, <em>scale_y=1.0</em>, <em>scale_z=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#System.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.System.add" title="Permalink to this definition">¶</a></dt>
<dd><p>A function to add a molecule to this system.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>molecule: <a class="reference internal" href="#structures.Molecule" title="structures.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Molecule</span></code></a></dt>
<dd>A Molecule structure.</dd>
<dt>x: <em>float, optional</em></dt>
<dd>x offset to atomic positions of the input molecule.</dd>
<dt>y: <em>float, optional</em></dt>
<dd>y offset to atomic positions of the input molecule.</dd>
<dt>z: <em>float, optional</em></dt>
<dd>z offset to atomic positions of the input molecule.</dd>
<dt>scale_x: <em>float, optional</em></dt>
<dd>scalar to offset x coordinates of the input molecule.</dd>
<dt>scale_y: <em>float, optional</em></dt>
<dd>scalar to offset y coordinates of the input molecule.</dd>
<dt>scale_z: <em>float, optional</em></dt>
<dd>scalar to offset z coordinates of the input molecule.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.System.assign_molecule_index">
<code class="descname">assign_molecule_index</code><span class="sig-paren">(</span><em>atom_list</em>, <em>i_list_index</em>, <em>molecule_count</em>, <em>elements=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#System.assign_molecule_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.System.assign_molecule_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Add molecule index to the atom if it has not already been assigned. Then recursively pass bonded atoms to the function</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>atom_list: <em>list</em>, <a class="reference internal" href="#structures.Molecule" title="structures.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Molecule</span></code></a></dt>
<dd>A list of atoms</dd>
<dt>i_list_index: <em>int</em></dt>
<dd>The index of the atom currently being assigned. Refers to atom_list index.</dd>
<dt>molecule_count: <em>int</em></dt>
<dd>The index of the molecule to be assigned.</dd>
<dt>elements: <em>list, list, int, optional</em></dt>
<dd>A list of OPLS types. Will be skipped during this part of the molecule assignment sequence.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.System.assign_molecules">
<code class="descname">assign_molecules</code><span class="sig-paren">(</span><em>elements=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#System.assign_molecules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.System.assign_molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns a unique molecule index for each molecule and sets each atom.molecule_index to the appropriate index. The algorithm runs by recursively searching through every bonded atom and giving the same molecule index as the origin atom. Normally, this means that molecules that are not bonded to each other will have a unique molecule index. Specific elements can be assign a predetermined molecule index by passing a list of element lists.</p>
<p>For example element_groups=[[6,8], [9]] will give all carbon and oxygen atoms a molecule index of 1 and fluorine atoms will have a molecule index of 2.</p>
<p>It is possible to get different molecule indices within the same bonded compound by giving a specific “bridging” element a predetermined molecule index. This prevents the molecular index from spreading to the entire bonded structure.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>elements: <em>list, list, int, optional</em></dt>
<dd>A list of OPLS types.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.System.get_elements">
<code class="descname">get_elements</code><span class="sig-paren">(</span><em>params=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#System.get_elements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.System.get_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>This simplifies using dump_modify by getting a list of the elements in
this system, sorted by their weight.  Note, duplicates will exist if
different atom types exist within this system!</p>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>elements: <em>list, str</em></dt>
<dd>A list of the elements, sorted appropriately for something
like dump_modify.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.System.packmol">
<code class="descname">packmol</code><span class="sig-paren">(</span><em>molecules</em>, <em>molecule_ratio=(1</em>, <em>)</em>, <em>new_method=False</em>, <em>density=1.0</em>, <em>seed=1</em>, <em>persist=True</em>, <em>number=None</em>, <em>additional=''</em>, <em>custom=None</em>, <em>extra_block_at_end=''</em>, <em>extra_block_at_beginning=''</em>, <em>tolerance=2.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#System.packmol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.System.packmol" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of molecules, pack this system appropriately.  Note,
we now will pack around what is already within the system!  This is
done by first generating a packmol block for the system at hand,
followed by a block for the solvent.</p>
<p>A custom script is also allowed; however, if this path is chosen, then
ensure all file paths for packmol exist.  We change directories within
this function to a sys_packmol folder, where all files are expected to
reside.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>molecules: <em>list,</em> <a class="reference internal" href="#structures.Molecule" title="structures.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Molecule</span></code></a></dt>
<dd>Molecules to be added to this system.</dd>
<dt>molecule_ratio: <em>tuple, float, optional</em></dt>
<dd>The ration that each molecule in <em>molecules</em> will be added to
the system.</dd>
<dt>density: <em>float, optional</em></dt>
<dd>The density of the system in g/mL</dd>
<dt>seed: <em>float, optional</em></dt>
<dd>Seed for random generator.</dd>
<dt>persist: <em>bool, optional</em></dt>
<dd>Whether to maintain the generated sys_packmol directory or
not.</dd>
<dt>number: <em>int or list, int, optional</em></dt>
<dd>Overide density and specify the exact number of molecules to
pack. When using a list of molecules, you must specify each
in order within a list.</dd>
<dt>custom: <em>str, optional</em></dt>
<dd>A custom packmol script to run for the given input molecules.
Note, you should ensure all necessary files are within the
sys_packmol folder if using this option.</dd>
<dt>additional: <em>str, optional</em></dt>
<dd>Whether to add additional constraints to the standard packmol
setup.</dd>
<dt>extra_block_at_beginning: <em>str, optional</em></dt>
<dd>An additional block to put prior to the standard block.</dd>
<dt>extra_block_at_end: <em>str, optional</em></dt>
<dd>An additional block to put after the standard block.</dd>
<dt>tolerance: <em>float, optional</em></dt>
<dd>The tolerance around which we allow atomic overlap/proximity.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
<p><strong>References</strong></p>
<blockquote>
<div><ul class="simple">
<li>Packmol - <a class="reference external" href="http://www.ime.unicamp.br/~martinez/packmol/home.shtml">http://www.ime.unicamp.br/~martinez/packmol/home.shtml</a></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.System.remove_atom_index">
<code class="descname">remove_atom_index</code><span class="sig-paren">(</span><em>indices=[]</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#System.remove_atom_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.System.remove_atom_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes selected indices from system. Does so by compiling new lists for atoms, bonds, angles, and dihedrals. Will be faster than Remove in cases
where you are only keeping a few atoms.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>type_indices: <em>list, int, optional</em></dt>
<dd>A list of OPLS types.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.System.remove_atom_type">
<code class="descname">remove_atom_type</code><span class="sig-paren">(</span><em>type_indices=[]</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#System.remove_atom_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.System.remove_atom_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes selected OPLS types from system. Does so by compiling new lists for atoms, bonds, angles, and dihedrals. Will be faster than Remove in cases
where you are only keeping a few atoms.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>type_indices: <em>list, int, optional</em></dt>
<dd>A list of OPLS types.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.System.setTriclinicBox">
<code class="descname">setTriclinicBox</code><span class="sig-paren">(</span><em>periodic</em>, <em>box_size</em>, <em>box_angles</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#System.setTriclinicBox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.System.setTriclinicBox" title="Permalink to this definition">¶</a></dt>
<dd><p>A function to establish a triclinic box boundary condition for this system.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>periodic: <em>bool, optional</em></dt>
<dd>Whether to have periodic boundaries on or off.
Initial guess.</dd>
<dt>box_size: <em>tuple, float, optional</em></dt>
<dd>System x, y, and z lengths.</dd>
<dt>box_angles: <em>tuple, float, optional</em></dt>
<dd>System xy, yz, and xz angles.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="structures.System.set_types">
<code class="descname">set_types</code><span class="sig-paren">(</span><em>params=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/structures.html#System.set_types"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#structures.System.set_types" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the atoms, bonds, angles, and dihedrals in a system object,
generate a list of the unique atom, bond, angle, dihedral types
and assign that to the system object.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>params: <code class="xref py py-class docutils literal notranslate"><span class="pre">squid.ff_params.Parameters</span></code>, optional</dt>
<dd>A parameters object holding all the possible parameters.</dd>
</dl>
</div></blockquote>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-units">
<span id="units"></span><h2>units<a class="headerlink" href="#module-units" title="Permalink to this headline">¶</a></h2>
<p>The units package holds various functions that aid in unit conversion, as well
as periodic table data management.</p>
<ul class="simple">
<li><a class="reference internal" href="#units.convert_energy" title="units.convert_energy"><code class="xref py py-func docutils literal notranslate"><span class="pre">convert_energy()</span></code></a></li>
<li><a class="reference internal" href="#units.convert_pressure" title="units.convert_pressure"><code class="xref py py-func docutils literal notranslate"><span class="pre">convert_pressure()</span></code></a></li>
<li><a class="reference internal" href="#units.convert_dist" title="units.convert_dist"><code class="xref py py-func docutils literal notranslate"><span class="pre">convert_dist()</span></code></a></li>
<li><a class="reference internal" href="#units.elem_i2s" title="units.elem_i2s"><code class="xref py py-func docutils literal notranslate"><span class="pre">elem_i2s()</span></code></a></li>
<li><a class="reference internal" href="#units.elem_s2i" title="units.elem_s2i"><code class="xref py py-func docutils literal notranslate"><span class="pre">elem_s2i()</span></code></a></li>
<li><a class="reference internal" href="#units.elem_weight" title="units.elem_weight"><code class="xref py py-func docutils literal notranslate"><span class="pre">elem_weight()</span></code></a></li>
<li><a class="reference internal" href="#units.elem_sym_from_weight" title="units.elem_sym_from_weight"><code class="xref py py-func docutils literal notranslate"><span class="pre">elem_sym_from_weight()</span></code></a></li>
<li><a class="reference internal" href="#units.convert" title="units.convert"><code class="xref py py-func docutils literal notranslate"><span class="pre">convert()</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="function">
<dt id="units.convert">
<code class="descclassname">units.</code><code class="descname">convert</code><span class="sig-paren">(</span><em>old</em>, <em>new</em>, <em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/units.html#convert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#units.convert" title="Permalink to this definition">¶</a></dt>
<dd><p>A generic converter of fractional units.  This works only for one unit in
the numerator and denomenator (such as Ha/Ang to eV/Bohr).</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>old: <em>str</em></dt>
<dd>Units for which val is in.</dd>
<dt>new: <em>str</em></dt>
<dd>Units to convert to.</dd>
<dt>val: <em>float</em></dt>
<dd>Value to convert.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>new_val: <em>float</em></dt>
<dd>Converted value in units of new.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="units.convert_dist">
<code class="descclassname">units.</code><code class="descname">convert_dist</code><span class="sig-paren">(</span><em>d0</em>, <em>d1</em>, <em>d_val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/units.html#convert_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#units.convert_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert distance units.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>d0: <em>str</em></dt>
<dd>Unit of distance that d_val is in.</dd>
<dt>d1: <em>str</em></dt>
<dd>Unit of distance that you wish to convert to.</dd>
<dt>d_val: <em>float</em></dt>
<dd>Value to be converted.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>distance: <em>float</em></dt>
<dd>Converted d_val to units of d1.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="units.convert_energy">
<code class="descclassname">units.</code><code class="descname">convert_energy</code><span class="sig-paren">(</span><em>e0</em>, <em>e1</em>, <em>e_val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/units.html#convert_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#units.convert_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert energy units.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>e0: <em>str</em></dt>
<dd>Unit of energy that e_val is in.</dd>
<dt>e1: <em>str</em></dt>
<dd>Unit of energy that you wish to convert to.</dd>
<dt>e_val: <em>float</em></dt>
<dd>Value to be converted.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>energy: <em>float</em></dt>
<dd>Converted e_val to units of e1.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="units.convert_pressure">
<code class="descclassname">units.</code><code class="descname">convert_pressure</code><span class="sig-paren">(</span><em>p0</em>, <em>p1</em>, <em>p_val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/units.html#convert_pressure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#units.convert_pressure" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert pressure units.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>p0: <em>str</em></dt>
<dd>Unit of pressure that p_val is in.</dd>
<dt>p1: <em>str</em></dt>
<dd>Unit of pressure that you wish to convert to.</dd>
<dt>p_val: <em>float</em></dt>
<dd>Value to be converted.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>pressure: <em>float</em></dt>
<dd>Converted p_val to units of p1.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="units.elem_i2s">
<code class="descclassname">units.</code><code class="descname">elem_i2s</code><span class="sig-paren">(</span><em>elem_int</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/units.html#elem_i2s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#units.elem_i2s" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the elemental symbol, given its atomic number.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>elem_int: <em>int</em></dt>
<dd>Atomic number of an element.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>elem_sym: <em>str</em></dt>
<dd>Elemental symbol.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="units.elem_s2i">
<code class="descclassname">units.</code><code class="descname">elem_s2i</code><span class="sig-paren">(</span><em>elem_sym</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/units.html#elem_s2i"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#units.elem_s2i" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the atomic number, given its elemental symbol.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>elem_sym: <em>str</em></dt>
<dd>Elemental symbol of an element.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>elem_int: <em>int</em></dt>
<dd>Atomic number.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="units.elem_sym_from_weight">
<code class="descclassname">units.</code><code class="descname">elem_sym_from_weight</code><span class="sig-paren">(</span><em>weight</em>, <em>delta=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/units.html#elem_sym_from_weight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#units.elem_sym_from_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the element that best matches the given weight (in AMU).</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>weight: <em>float</em></dt>
<dd>Weight of an element in AMU.</dd>
<dt>delta: <em>float, optional</em></dt>
<dd>How close you permit the matching to be in AMU.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>elem_sym: <em>str</em></dt>
<dd>The elemental symbol.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="units.elem_weight">
<code class="descclassname">units.</code><code class="descname">elem_weight</code><span class="sig-paren">(</span><em>elem</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/units.html#elem_weight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#units.elem_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the weight of an element, given its symbol or atomic number.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>elem: <em>str or int</em></dt>
<dd>Elemental symbol or atomic number.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>elem_weight: <em>float</em></dt>
<dd>Weight of the element in AMU.</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="utils">
<h2>utils<a class="headerlink" href="#utils" title="Permalink to this headline">¶</a></h2>
<p>The utils module was one of the crucial modules used in the original Squid code.  However,
due to confusion in what functions belonged where, it eventually became cluttered.  Thus, it has
now been deprecated.  You can find the following functions in their new modules:</p>
<p>The following have been placed in the <em>structures</em> module:</p>
<ul class="simple">
<li>Struct</li>
<li>System</li>
<li>Molecule</li>
<li>Atom</li>
<li>Bond</li>
<li>Dihedral</li>
</ul>
<p>The following have been placed in the <em>results</em> module:</p>
<ul class="simple">
<li>DFT_out</li>
<li>sim_out</li>
</ul>
<p>The following have been placed in the <em>geometry</em> module:</p>
<ul class="simple">
<li>angle_size</li>
<li>dihedral_angle</li>
<li>get_bonds</li>
<li>get_angles_and_dihedrals</li>
<li>orthogonal_procrustes</li>
<li>procrustes</li>
<li>interpolate</li>
<li>motion_per_frame</li>
<li>dist_squared</li>
<li>dist</li>
<li>rotation_matrix</li>
<li>rotate_xyz</li>
<li>rotate_frames</li>
<li>rand_rotation</li>
<li>mvee</li>
<li>align_centroid</li>
<li>center_frames</li>
<li>pretty_xyz -&gt; smooth_xyz (note the changed function name)</li>
</ul>
<p>The following have been placed in the <em>frc_opls</em> module:</p>
<ul class="simple">
<li>opls_options</li>
</ul>
<p>The following have been placed in the <em>print_helper</em> module:</p>
<ul class="simple">
<li>color_set</li>
<li>colour_set</li>
<li>strip_color</li>
<li>strip_colour</li>
<li>spaced_print</li>
</ul>
<p>The following have been placed in the <em>linux_helper</em> module:</p>
<ul class="simple">
<li>clean_up_folder</li>
</ul>
<p>The following have been placed in the <em>jobs</em> module:</p>
<ul class="simple">
<li>Job</li>
</ul>
<p>The following have been placed in the <em>debyer</em> module:</p>
<ul class="simple">
<li>get_pdf</li>
</ul>
</div>
<div class="section" id="module-visualization">
<span id="visualization"></span><h2>visualization<a class="headerlink" href="#module-visualization" title="Permalink to this headline">¶</a></h2>
<p>The visualization module automates some visualization procedures for
post processing data.</p>
<p>An example of using this is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">files</span>
<span class="kn">import</span> <span class="nn">visualization</span> <span class="kn">as</span> <span class="nn">vis</span>

<span class="n">vis</span><span class="o">.</span><span class="n">ovito_xyz_to_gif</span><span class="p">(</span><span class="n">files</span><span class="o">.</span><span class="n">read_xyz</span><span class="p">(</span><span class="s2">&quot;CNH_HCN.xyz&quot;</span><span class="p">),</span> <span class="s2">&quot;/fs/home/hch54/tmp&quot;</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="s1">&#39;Tachyon&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><a class="reference internal" href="#visualization.ovito_xyz_to_image" title="visualization.ovito_xyz_to_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">ovito_xyz_to_image()</span></code></a></li>
<li><a class="reference internal" href="#visualization.ovito_xyz_to_gif" title="visualization.ovito_xyz_to_gif"><code class="xref py py-func docutils literal notranslate"><span class="pre">ovito_xyz_to_gif()</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="function">
<dt id="visualization.ovito_xyz_to_gif">
<code class="descclassname">visualization.</code><code class="descname">ovito_xyz_to_gif</code><span class="sig-paren">(</span><em>frames</em>, <em>scratch</em>, <em>fname='image'</em>, <em>camera_pos=(10</em>, <em>0</em>, <em>0)</em>, <em>camera_dir=(-1</em>, <em>0</em>, <em>0)</em>, <em>size=(800</em>, <em>600)</em>, <em>delay=10</em>, <em>display_cell=False</em>, <em>renderer='OpenGLRenderer'</em>, <em>renderer_settings={}</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visualization.html#ovito_xyz_to_gif"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#visualization.ovito_xyz_to_gif" title="Permalink to this definition">¶</a></dt>
<dd><p>This function will, using the ovito python api, generate either a single
image or a gif of the input frames.  Note, a gif is only generated when
more than one frame exists.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>frames: <em>str</em> or <em>list,</em> <a class="reference internal" href="#structures.Atom" title="structures.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">structures.Atom</span></code></a></dt>
<dd>A list of frames you wish to generate an image for, or a path to
an xyz file.</dd>
<dt>scratch: <em>str</em></dt>
<dd>A directory you want to have each image saved to.</dd>
<dt>fname: <em>str, optional</em></dt>
<dd>The prefix for the image names.</dd>
<dt>camera_pos: <em>tuple, float, optional</em></dt>
<dd>A tuple of x, y, and z coordinates for the camera to be positioned.</dd>
<dt>camera_dir: <em>tuple, float, optional</em></dt>
<dd>The direction the camera is facing.</dd>
<dt>size: <em>tuple, int, optional</em></dt>
<dd>Image size (width, height).</dd>
<dt>delay: <em>int, optional</em></dt>
<dd>In the event of a gif, how long it should play for.</dd>
<dt>display_cell: <em>bool, optional</em></dt>
<dd>Whether to display the box around the system or not.</dd>
<dt>renderer: <em>str, optional</em></dt>
<dd>What kind of renderer you wish to use: OpenGL or Tachyon.</dd>
<dt>renderer_settings: <em>dict, optional</em></dt>
<dd>Here you can change specific renderer settings.</dd>
<dt>overwrite: <em>bool, optional</em></dt>
<dd>Whether to delete any files already existing in the scratch dir.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="visualization.ovito_xyz_to_image">
<code class="descclassname">visualization.</code><code class="descname">ovito_xyz_to_image</code><span class="sig-paren">(</span><em>xyz</em>, <em>scratch</em>, <em>fname='image'</em>, <em>camera_pos=(10</em>, <em>0</em>, <em>0)</em>, <em>camera_dir=(-1</em>, <em>0</em>, <em>0)</em>, <em>size=(800</em>, <em>600)</em>, <em>renderer='OpenGLRenderer'</em>, <em>display_cell=False</em>, <em>renderer_settings={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visualization.html#ovito_xyz_to_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#visualization.ovito_xyz_to_image" title="Permalink to this definition">¶</a></dt>
<dd><p>This function will, using the ovito python api, generate a png image of an
xyz file.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>xyz: <em>str</em></dt>
<dd>A path to an xyz file.</dd>
<dt>scratch: <em>str</em></dt>
<dd>A directory you want to have each image saved to.</dd>
<dt>fname: <em>str, optional</em></dt>
<dd>The prefix for the image names.</dd>
<dt>camera_pos: <em>tuple, float, optional</em></dt>
<dd>A tuple of x, y, and z coordinates for the camera to be positioned.</dd>
<dt>camera_dir: <em>tuple, float, optional</em></dt>
<dd>The direction the camera is facing.</dd>
<dt>size: <em>tuple, int, optional</em></dt>
<dd>Image size (width, height).</dd>
<dt>delay: <em>int, optional</em></dt>
<dd>In the event of a gif, how long it should play for.</dd>
<dt>renderer: <em>str, optional</em></dt>
<dd>What kind of renderer you wish to use: OpenGL or Tachyon.</dd>
<dt>display_cell: <em>bool, optional</em></dt>
<dd>Whether to display the box around the system or not.</dd>
<dt>renderer_settings: <em>dict, optional</em></dt>
<dd>Here you can change specific renderer settings.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-vmd">
<span id="vmd"></span><h2>vmd<a class="headerlink" href="#module-vmd" title="Permalink to this headline">¶</a></h2>
<p>The vmd package automates various vmd post-processing tasks.</p>
<ul class="simple">
<li><a class="reference internal" href="#vmd.plot_MO_from_cube" title="vmd.plot_MO_from_cube"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_MO_from_cube()</span></code></a></li>
</ul>
<hr class="docutils" />
<dl class="function">
<dt id="vmd.plot_MO_from_cube">
<code class="descclassname">vmd.</code><code class="descname">plot_MO_from_cube</code><span class="sig-paren">(</span><em>fptrs</em>, <em>wireframe=True</em>, <em>hide=True</em>, <em>iso=0.04</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vmd.html#plot_MO_from_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vmd.plot_MO_from_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>A function to generate a VMD visualization of a molecular orbital from
a cube file.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>fptrs: <em>list, str, or str</em></dt>
<dd>Strings giving the path to the cube file.</dd>
<dt>wireframe: <em>bool, optional</em></dt>
<dd>If you want to view wireframe (True) or not (False) for the
orbitals.</dd>
<dt>hide: <em>bool, optional</em></dt>
<dd>Whether to hide the representations (True) on startup, or
not (False).</dd>
<dt>iso: <em>float, optional</em></dt>
<dd>Isosurface magnitude.  Set to 0.04 by default, but 0.01 may be
better.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="vmd.plot_electrostatic_from_cube">
<code class="descclassname">vmd.</code><code class="descname">plot_electrostatic_from_cube</code><span class="sig-paren">(</span><em>fptr_rho</em>, <em>fptr_pot</em>, <em>wireframe=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vmd.html#plot_electrostatic_from_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vmd.plot_electrostatic_from_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>A function to generate a VMD visualization of a electrostatic potential
mapped onto an electron density isosurface.</p>
<p><strong>Parameters</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>fptr_rho: <em>str</em></dt>
<dd>Path to the electron density cube file.</dd>
<dt>fptr_pot: <em>str</em></dt>
<dd>Path to the electrostatic potential cube file.</dd>
<dt>wireframe: <em>bool, optional</em></dt>
<dd>If you want to view wireframe (True) or not (False) for the
orbitals.</dd>
</dl>
</div></blockquote>
<p><strong>Returns</strong></p>
<blockquote>
<div>None</div></blockquote>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="squid.html">Squid</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Codebase</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-aneb">aneb</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-constants">constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-debyer">debyer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-doe_lhs">doe_lhs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-files">files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-frc_opls">frc_opls</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-g09">g09</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-geometry">geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="#jdftx">jdftx</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-jobs">jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-joust">joust</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lammps_job">lammps_job</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lammps_log">lammps_log</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-linux_helper">linux_helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-neb">neb</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optimizers">optimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-orca">orca</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-print_helper">print_helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-rate_calc">rate_calc</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-results">results</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-spline_neb">spline_neb</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-structures">structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-units">units</a></li>
<li class="toctree-l2"><a class="reference internal" href="#utils">utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-visualization">visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-vmd">vmd</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="squid.html"
                        title="previous chapter">Squid</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="examples.html"
                        title="next chapter">Examples</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/codebase.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             >next</a> |</li>
        <li class="right" >
          <a href="squid.html" title="Squid"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Squid 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Henry Herbol.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.
    </div>
  </body>
</html>